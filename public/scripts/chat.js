/*! For license information please see chat.js.LICENSE.txt */
var chat;chat=(()=>{var __webpack_modules__={9396:(e,t,r)=>{"use strict";r.d(t,{A:()=>g});var n=r(1230),o=r(1543),i=r(7187),s=r(6718),a=r(9290),c=r(9418),u=r(9947),l=r(9789),p=r(5383),d=(r(2444),r(6563)),h=r(1433),f=r(5267),y=r(1266);class g{constructor(e,t,r={}){this.url=e,this.signalingClient=void 0,this.emitter=new i.EventEmitter,this.isRealtimeNotificationsStarted=!1,this.tokenCredential=t,this.clientOptions=Object.assign({},r);const n=`azsdk-js-communication-chat/${s.J}`;r.userAgentOptions||(r.userAgentOptions={});const p=Object.assign({},r.userAgentOptions);r.userAgentOptions.userAgentPrefix?p.userAgentPrefix=`${r.userAgentOptions.userAgentPrefix} ${n}`:p.userAgentPrefix=n;const d=Object.assign(Object.assign({},Object.assign(Object.assign({},r),{userAgentOptions:p})),{loggingOptions:{logger:o.k.info}}),h=(0,c.M)(this.tokenCredential),f=(0,l.WA)(d,h);this.api=new u.R$(this.url,f),this.signalingClient=((e,t)=>new a.CommunicationSignalingClient(e,t))(t,o.k)}getChatThreadClient(e){return(0,n.mG)(this,void 0,void 0,(function*(){return new f.D(e,this.url,this.tokenCredential,this.clientOptions)}))}createChatThread(e,t={}){var r,o,i;return(0,n.mG)(this,void 0,void 0,(function*(){const{span:n,updatedOptions:s}=(0,h.k)("ChatClient-CreateChatThread",t);try{const t=yield this.api.createChatThread({topic:e.topic,members:null===(r=e.members)||void 0===r?void 0:r.map((e=>(0,y.Ue)(e)))},(0,p.t)(s)),a=null!==(o=t.multipleStatus)&&void 0!==o?o:[],c=null===(i=a.find((e=>"Thread"===e.type&&201===e.statusCode)))||void 0===i?void 0:i.id;if(c)return this.getChatThreadClient(c);throw new Error("Chat thread creation failed.")}catch(e){throw n.setStatus({code:d.CanonicalCode.UNKNOWN,message:e.message}),e}finally{n.end()}}))}getChatThread(e,t={}){return(0,n.mG)(this,void 0,void 0,(function*(){const{span:r,updatedOptions:n}=(0,h.k)("ChatClient-GetChatThread",t);try{const t=yield this.api.getChatThread(e,(0,p.t)(n)),o=(0,y.CX)(t);return(0,y.Qq)(o,t._response)}catch(e){throw r.setStatus({code:d.CanonicalCode.UNKNOWN,message:e.message}),e}finally{r.end()}}))}listChatThreadsPage(e,t={}){return(0,n.FC)(this,arguments,(function*(){const r=(0,p.t)(t);if(!e.continuationToken){const t=yield(0,n.qq)(this.api.listChatThreads(r));e.continuationToken=t.nextLink,t.value&&(yield yield(0,n.qq)(t.value))}for(;e.continuationToken;){const t=yield(0,n.qq)(this.api.listChatThreadsNext(e.continuationToken,r));if(e.continuationToken=t.nextLink,!t.value)break;yield yield(0,n.qq)(t.value)}}))}listChatThreadsAll(e){return(0,n.FC)(this,arguments,(function*(){var t,r;try{for(var o,i=(0,n.KL)(this.listChatThreadsPage({},e));!(o=yield(0,n.qq)(i.next())).done;){const e=o.value;yield(0,n.qq)(yield*(0,n.V2)((0,n.KL)(e)))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&(yield(0,n.qq)(r.call(i)))}finally{if(t)throw t.error}}}))}listChatThreads(e={}){const{span:t,updatedOptions:r}=(0,h.k)("ChatClient-ListChatThreads",e);try{const e=this.listChatThreadsAll(r);return{next:()=>e.next(),[Symbol.asyncIterator](){return this},byPage:(e={})=>this.listChatThreadsPage(e,r)}}catch(e){throw t.setStatus({code:d.CanonicalCode.UNKNOWN,message:e.message}),e}finally{t.end()}}deleteChatThread(e,t={}){return(0,n.mG)(this,void 0,void 0,(function*(){const{span:r,updatedOptions:n}=(0,h.k)("ChatClient-DeleteChatThread",t);try{return yield this.api.deleteChatThread(e,(0,p.t)(n))}catch(e){throw r.setStatus({code:d.CanonicalCode.UNKNOWN,message:e.message}),e}finally{r.end()}}))}startRealtimeNotifications(){return(0,n.mG)(this,void 0,void 0,(function*(){if(void 0===this.signalingClient)throw new Error("Realtime notifications are only supported in the browser.");this.isRealtimeNotificationsStarted||(this.isRealtimeNotificationsStarted=!0,this.signalingClient.start(),this.subscribeToSignalingEvents())}))}stopRealtimeNotifications(){return(0,n.mG)(this,void 0,void 0,(function*(){if(void 0===this.signalingClient)throw new Error("Realtime notifications are only supported in the browser.");this.isRealtimeNotificationsStarted=!1,this.signalingClient.stop(),this.emitter.removeAllListeners()}))}on(e,t){if(void 0===this.signalingClient)throw new Error("Realtime notifications are only supported in the browser.");if(!this.isRealtimeNotificationsStarted)throw new Error("You must call startRealtimeNotifications before you can subscribe to events.");this.emitter.on(e,t)}off(e,t){if(void 0===this.signalingClient)throw new Error("Realtime notifications are only supported in the browser.");this.emitter.removeListener(e,t)}subscribeToSignalingEvents(){if(void 0===this.signalingClient)throw new Error("Realtime notifications are only supported in the browser.");this.signalingClient.on("chatMessageReceived",(e=>{this.emitter.emit("chatMessageReceived",e)})),this.signalingClient.on("chatMessageEdited",(e=>{this.emitter.emit("chatMessageEdited",e)})),this.signalingClient.on("chatMessageDeleted",(e=>{this.emitter.emit("chatMessageDeleted",e)})),this.signalingClient.on("typingIndicatorReceived",(e=>{this.emitter.emit("typingIndicatorReceived",e)})),this.signalingClient.on("readReceiptReceived",(e=>{this.emitter.emit("readReceiptReceived",e)}))}}},5267:(e,t,r)=>{"use strict";r.d(t,{D:()=>h});var n=r(1230),o=r(1543),i=r(6718),s=r(9418),a=r(9947),c=r(9789),u=r(5383),l=r(6563),p=r(1433),d=r(1266);class h{constructor(e,t,r,n={}){this.url=t,this.disposed=!1,this.timeOfLastTypingRequest=void 0,this.threadId=e,this.tokenCredential=r;const u=`azsdk-js-communication-chat/${i.J}`;n.userAgentOptions||(n.userAgentOptions={});const l=Object.assign({},n.userAgentOptions);n.userAgentOptions.userAgentPrefix?l.userAgentPrefix=`${n.userAgentOptions.userAgentPrefix} ${u}`:l.userAgentPrefix=u;const p=Object.assign(Object.assign({},Object.assign(Object.assign({},n),{userAgentOptions:l})),{loggingOptions:{logger:o.k.info}}),d=(0,s.M)(this.tokenCredential),h=(0,c.WA)(p,d);this.api=new a.R$(this.url,h)}updateThread(e={}){return(0,n.mG)(this,void 0,void 0,(function*(){const{span:t,updatedOptions:r}=(0,p.k)("ChatThreadClient-UpdateThread",e);try{return yield this.api.updateChatThread(this.threadId,{topic:e.topic},(0,u.t)(r))}catch(e){throw t.setStatus({code:l.CanonicalCode.UNKNOWN,message:e.message}),e}finally{t.end()}}))}sendMessage(e,t={}){return(0,n.mG)(this,void 0,void 0,(function*(){const{span:r,updatedOptions:n}=(0,p.k)("ChatThreadClient-SendMessage",t);try{return this.timeOfLastTypingRequest=void 0,yield this.api.sendChatMessage(this.threadId,Object.assign(Object.assign({},e),t),(0,u.t)(n))}catch(e){throw r.setStatus({code:l.CanonicalCode.UNKNOWN,message:e.message}),e}finally{r.end()}}))}getMessage(e,t={}){return(0,n.mG)(this,void 0,void 0,(function*(){const{span:r,updatedOptions:n}=(0,p.k)("ChatThreadClient-GetMessage",t);try{const t=yield this.api.getChatMessage(this.threadId,e,(0,u.t)(n)),o=(0,d.KJ)(t);return(0,d.Qq)(o,t._response)}catch(e){throw r.setStatus({code:l.CanonicalCode.UNKNOWN,message:e.message}),e}finally{r.end()}}))}listMessagesPage(e,t={}){return(0,n.FC)(this,arguments,(function*(){const r=(0,u.t)(t);if(!e.continuationToken){const t=yield(0,n.qq)(this.api.listChatMessages(this.threadId,r));e.continuationToken=t.nextLink,t.value&&(yield yield(0,n.qq)(t.value.map(d.KJ,this)))}for(;e.continuationToken;){const t=yield(0,n.qq)(this.api.listChatMessagesNext(this.threadId,e.continuationToken,r));if(e.continuationToken=t.nextLink,!t.value)break;yield yield(0,n.qq)(t.value.map(d.KJ,this))}}))}listMessagesAll(e){return(0,n.FC)(this,arguments,(function*(){var t,r;try{for(var o,i=(0,n.KL)(this.listMessagesPage({},e));!(o=yield(0,n.qq)(i.next())).done;){const e=o.value;yield(0,n.qq)(yield*(0,n.V2)((0,n.KL)(e)))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&(yield(0,n.qq)(r.call(i)))}finally{if(t)throw t.error}}}))}listMessages(e={}){const{span:t,updatedOptions:r}=(0,p.k)("ChatThreadClient-ListMessages",e);try{const e=this.listMessagesAll(r);return{next:()=>e.next(),[Symbol.asyncIterator](){return this},byPage:(e={})=>this.listMessagesPage(e,r)}}catch(e){throw t.setStatus({code:l.CanonicalCode.UNKNOWN,message:e.message}),e}finally{t.end()}}deleteMessage(e,t={}){return(0,n.mG)(this,void 0,void 0,(function*(){const{span:r,updatedOptions:n}=(0,p.k)("ChatThreadClient-DeleteMessage",t);try{return yield this.api.deleteChatMessage(this.threadId,e,(0,u.t)(n))}catch(e){throw r.setStatus({code:l.CanonicalCode.UNKNOWN,message:e.message}),e}finally{r.end()}}))}updateMessage(e,t={}){return(0,n.mG)(this,void 0,void 0,(function*(){const{span:r,updatedOptions:n}=(0,p.k)("ChatThreadClient-UpdateMessage",t);try{return yield this.api.updateChatMessage(this.threadId,e,t,(0,u.t)(n))}catch(e){throw r.setStatus({code:l.CanonicalCode.UNKNOWN,message:e.message}),e}finally{r.end()}}))}addMembers(e,t={}){return(0,n.mG)(this,void 0,void 0,(function*(){const{span:r,updatedOptions:n}=(0,p.k)("ChatThreadClient-AddMembers",t);try{return yield this.api.addChatThreadMembers(this.threadId,(0,d.Dw)(e),(0,u.t)(n))}catch(e){throw r.setStatus({code:l.CanonicalCode.UNKNOWN,message:e.message}),e}finally{r.end()}}))}listMembersPage(e,t={}){return(0,n.FC)(this,arguments,(function*(){const r=(0,u.t)(t);if(!e.continuationToken){const t=yield(0,n.qq)(this.api.listChatThreadMembers(this.threadId,r));e.continuationToken=t.nextLink,t.value&&(yield yield(0,n.qq)(t.value.map(d.Oq,this)))}for(;e.continuationToken;){const t=yield(0,n.qq)(this.api.listChatThreadMembersNext(this.threadId,e.continuationToken,r));if(e.continuationToken=t.nextLink,!t.value)break;yield yield(0,n.qq)(t.value.map(d.Oq,this))}}))}listMembersAll(e){return(0,n.FC)(this,arguments,(function*(){var t,r;try{for(var o,i=(0,n.KL)(this.listMembersPage({},e));!(o=yield(0,n.qq)(i.next())).done;){const e=o.value;yield(0,n.qq)(yield*(0,n.V2)((0,n.KL)(e)))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&(yield(0,n.qq)(r.call(i)))}finally{if(t)throw t.error}}}))}listMembers(e={}){const{span:t,updatedOptions:r}=(0,p.k)("ChatThreadClient-ListMembers",e);try{const e=this.listMembersAll(r);return{next:()=>e.next(),[Symbol.asyncIterator](){return this},byPage:(e={})=>this.listMembersPage(e,r)}}catch(e){throw t.setStatus({code:l.CanonicalCode.UNKNOWN,message:e.message}),e}finally{t.end()}}removeMember(e,t={}){return(0,n.mG)(this,void 0,void 0,(function*(){const{span:r,updatedOptions:n}=(0,p.k)("ChatThreadClient-RemoveMembers",t);try{return yield this.api.removeChatThreadMember(this.threadId,e.communicationUserId,(0,u.t)(n))}catch(e){throw r.setStatus({code:l.CanonicalCode.UNKNOWN,message:e.message}),e}finally{r.end()}}))}sendTypingNotification(e={}){return(0,n.mG)(this,void 0,void 0,(function*(){const{span:t,updatedOptions:r}=(0,p.k)("ChatThreadClient-SendTypingNotification",e);try{const e=new Date;return this.canPostTypingNotification(e)?(yield this.api.sendTypingNotification(this.threadId,(0,u.t)(r)),this.timeOfLastTypingRequest=e,!0):(o.k.info(`Typing Notification NOT Send. [thread_id=${this.threadId}]`),!1)}catch(e){throw t.setStatus({code:l.CanonicalCode.UNKNOWN,message:e.message}),e}finally{t.end()}}))}sendReadReceipt(e,t={}){return(0,n.mG)(this,void 0,void 0,(function*(){const{span:r,updatedOptions:n}=(0,p.k)("ChatThreadClient-SendReadReceipt",t);try{return yield this.api.sendChatReadReceipt(this.threadId,e,(0,u.t)(n))}catch(e){throw r.setStatus({code:l.CanonicalCode.UNKNOWN,message:e.message}),e}finally{r.end()}}))}listReadReceiptsPage(e,t={}){return(0,n.FC)(this,arguments,(function*(){const r=(0,u.t)(t);if(!e.continuationToken){const t=yield(0,n.qq)(this.api.listChatReadReceipts(this.threadId,r));e.continuationToken=t.nextLink,t.value&&(yield yield(0,n.qq)(t.value.map(d.Op,this)))}for(;e.continuationToken;){const t=yield(0,n.qq)(this.api.listChatReadReceiptsNext(this.threadId,e.continuationToken,r));if(e.continuationToken=t.nextLink,!t.value)break;yield yield(0,n.qq)(t.value.map(d.Op,this))}}))}listReadReceiptsAll(e){return(0,n.FC)(this,arguments,(function*(){var t,r;try{for(var o,i=(0,n.KL)(this.listReadReceiptsPage({},e));!(o=yield(0,n.qq)(i.next())).done;){const e=o.value;yield(0,n.qq)(yield*(0,n.V2)((0,n.KL)(e)))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&(yield(0,n.qq)(r.call(i)))}finally{if(t)throw t.error}}}))}listReadReceipts(e={}){const{span:t,updatedOptions:r}=(0,p.k)("ChatThreadClient-ListChatReadReceipts",e);try{const e=this.listReadReceiptsAll(r);return{next:()=>e.next(),[Symbol.asyncIterator](){return this},byPage:(e={})=>this.listReadReceiptsPage(e,r)}}catch(e){throw t.setStatus({code:l.CanonicalCode.UNKNOWN,message:e.message}),e}finally{t.end()}}dispose(){this.disposed||(this.disposed=!0)}canPostTypingNotification(e){return!(this.timeOfLastTypingRequest&&e.getTime()-this.timeOfLastTypingRequest.getTime()<8e3)||(o.k.info(`Typing interval check failed. [last_request=${this.timeOfLastTypingRequest}]`),!1)}}},6718:(e,t,r)=>{"use strict";r.d(t,{J:()=>n});const n="1.0.0-beta.3"},9418:(e,t,r)=>{"use strict";r.d(t,{M:()=>s});var n=r(1230),o=r(72),i=r(4809);const s=e=>({create:(t,r)=>new a(t,r,e)});class a extends o.U{constructor(e,t,r){super(e,t),this.credential=r}sendRequest(e){var t;return(0,n.mG)(this,void 0,void 0,(function*(){if(!e)throw new Error("webResource cannot be null or undefined");const r=null===(t=yield this.credential.getToken())||void 0===t?void 0:t.token;return e.headers.set(i.g.HeaderConstants.AUTHORIZATION,`Bearer ${r}`),this._nextPolicy.sendRequest(e)}))}}},9947:(e,t,r)=>{"use strict";r.d(t,{R$:()=>z});var n={};r.r(n),r.d(n,{AddChatThreadMembersRequest:()=>m,ChatMessage:()=>h,ChatMessagesCollection:()=>d,ChatThread:()=>O,ChatThreadInfo:()=>R,ChatThreadMember:()=>g,ChatThreadMembersCollection:()=>y,ChatThreadsInfoCollection:()=>_,CreateChatThreadRequest:()=>v,ErrorModel:()=>c,IndividualStatusResponse:()=>b,MultiStatusResponse:()=>T,ReadReceipt:()=>a,ReadReceiptsCollection:()=>s,SendChatMessageRequest:()=>l,SendChatMessageResult:()=>p,SendReadReceiptRequest:()=>u,UpdateChatMessageRequest:()=>f,UpdateChatThreadRequest:()=>w});var o=r(5383),i=r(3422);const s={type:{name:"Composite",className:"ReadReceiptsCollection",modelProperties:{value:{serializedName:"value",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ReadReceipt"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},a={type:{name:"Composite",className:"ReadReceipt",modelProperties:{senderId:{serializedName:"senderId",readOnly:!0,type:{name:"String"}},chatMessageId:{serializedName:"chatMessageId",readOnly:!0,type:{name:"String"}},readOn:{serializedName:"readOn",readOnly:!0,type:{name:"DateTime"}}}}},c={type:{name:"Composite",className:"ErrorModel",modelProperties:{code:{serializedName:"code",readOnly:!0,type:{name:"String"}},message:{serializedName:"message",readOnly:!0,type:{name:"String"}},target:{serializedName:"target",readOnly:!0,type:{name:"String"}},innerErrors:{serializedName:"innerErrors",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorModel"}}}}}}},u={type:{name:"Composite",className:"SendReadReceiptRequest",modelProperties:{chatMessageId:{serializedName:"chatMessageId",required:!0,type:{name:"String"}}}}},l={type:{name:"Composite",className:"SendChatMessageRequest",modelProperties:{priority:{serializedName:"priority",type:{name:"String"}},content:{serializedName:"content",required:!0,type:{name:"String"}},senderDisplayName:{serializedName:"senderDisplayName",type:{name:"String"}}}}},p={type:{name:"Composite",className:"SendChatMessageResult",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}}}}},d={type:{name:"Composite",className:"ChatMessagesCollection",modelProperties:{value:{serializedName:"value",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatMessage"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},h={type:{name:"Composite",className:"ChatMessage",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",type:{name:"String"}},priority:{serializedName:"priority",type:{name:"String"}},version:{serializedName:"version",readOnly:!0,type:{name:"String"}},content:{serializedName:"content",type:{name:"String"}},senderDisplayName:{serializedName:"senderDisplayName",type:{name:"String"}},createdOn:{serializedName:"createdOn",readOnly:!0,type:{name:"DateTime"}},senderId:{serializedName:"senderId",readOnly:!0,type:{name:"String"}},deletedOn:{serializedName:"deletedOn",type:{name:"DateTime"}},editedOn:{serializedName:"editedOn",type:{name:"DateTime"}}}}},f={type:{name:"Composite",className:"UpdateChatMessageRequest",modelProperties:{content:{serializedName:"content",type:{name:"String"}},priority:{serializedName:"priority",type:{name:"String"}}}}},y={type:{name:"Composite",className:"ChatThreadMembersCollection",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatThreadMember"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},g={type:{name:"Composite",className:"ChatThreadMember",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}},displayName:{serializedName:"displayName",type:{name:"String"}},shareHistoryTime:{serializedName:"shareHistoryTime",type:{name:"DateTime"}}}}},m={type:{name:"Composite",className:"AddChatThreadMembersRequest",modelProperties:{members:{serializedName:"members",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatThreadMember"}}}}}}},v={type:{name:"Composite",className:"CreateChatThreadRequest",modelProperties:{topic:{serializedName:"topic",required:!0,type:{name:"String"}},members:{serializedName:"members",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatThreadMember"}}}}}}},T={type:{name:"Composite",className:"MultiStatusResponse",modelProperties:{multipleStatus:{serializedName:"multipleStatus",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"IndividualStatusResponse"}}}}}}},b={type:{name:"Composite",className:"IndividualStatusResponse",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},statusCode:{serializedName:"statusCode",readOnly:!0,type:{name:"Number"}},message:{serializedName:"message",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}}}}},_={type:{name:"Composite",className:"ChatThreadsInfoCollection",modelProperties:{value:{serializedName:"value",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatThreadInfo"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},R={type:{name:"Composite",className:"ChatThreadInfo",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},topic:{serializedName:"topic",type:{name:"String"}},isDeleted:{serializedName:"isDeleted",type:{name:"Boolean"}},lastMessageReceivedOn:{serializedName:"lastMessageReceivedOn",readOnly:!0,type:{name:"DateTime"}}}}},w={type:{name:"Composite",className:"UpdateChatThreadRequest",modelProperties:{topic:{serializedName:"topic",type:{name:"String"}}}}},O={type:{name:"Composite",className:"ChatThread",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},topic:{serializedName:"topic",type:{name:"String"}},createdOn:{serializedName:"createdOn",readOnly:!0,type:{name:"DateTime"}},createdBy:{serializedName:"createdBy",readOnly:!0,type:{name:"String"}},members:{serializedName:"members",type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatThreadMember"}}}}}}},C={parameterPath:"endpoint",mapper:{serializedName:"endpoint",required:!0,type:{name:"String"}},skipEncoding:!0},E={parameterPath:"chatThreadId",mapper:{serializedName:"chatThreadId",required:!0,type:{name:"String"}}},P={parameterPath:"apiVersion",mapper:{defaultValue:"2020-09-21-preview2",isConstant:!0,serializedName:"api-version",type:{name:"String"}}},S={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},N={parameterPath:"body",mapper:u},k={parameterPath:"body",mapper:l},A={parameterPath:["options","maxPageSize"],mapper:{serializedName:"maxPageSize",type:{name:"Number"}}},I={parameterPath:["options","startTime"],mapper:{serializedName:"startTime",type:{name:"DateTime"}}},M={parameterPath:"chatMessageId",mapper:{serializedName:"chatMessageId",required:!0,type:{name:"String"}}},x={parameterPath:"body",mapper:f},D={parameterPath:"body",mapper:m},U={parameterPath:"body",mapper:v},q={parameterPath:"body",mapper:w},L={parameterPath:"nextLink",mapper:{serializedName:"nextLink",required:!0,type:{name:"String"}},skipEncoding:!0};var j=r(9789),B=r(9344);class H extends j.St{constructor(e,t){if(void 0===e)throw new Error("'endpoint' cannot be null");if(t||(t={}),!t.userAgent){const e=B.IM();t.userAgent=`azure-communication-chat/1.0.0-beta.3 ${e}`}super(void 0,t),this.requestContentType="application/json; charset=utf-8",this.baseUri=t.endpoint||"{endpoint}",this.endpoint=e,this.apiVersion=t.apiVersion||"2020-09-21-preview2"}}class z extends H{constructor(e,t){super(e,t)}listChatReadReceipts(e,t){const r=o.t(t||{});return this.sendOperationRequest({chatThreadId:e,options:r},V)}sendChatReadReceipt(e,t,r){const n=o.t(r||{});return this.sendOperationRequest({chatThreadId:e,body:t,options:n},G)}sendChatMessage(e,t,r){const n=o.t(r||{});return this.sendOperationRequest({chatThreadId:e,body:t,options:n},$)}listChatMessages(e,t){const r=o.t(t||{});return this.sendOperationRequest({chatThreadId:e,options:r},K)}getChatMessage(e,t,r){const n=o.t(r||{});return this.sendOperationRequest({chatThreadId:e,chatMessageId:t,options:n},X)}updateChatMessage(e,t,r,n){const i=o.t(n||{});return this.sendOperationRequest({chatThreadId:e,chatMessageId:t,body:r,options:i},Q)}deleteChatMessage(e,t,r){const n=o.t(r||{});return this.sendOperationRequest({chatThreadId:e,chatMessageId:t,options:n},W)}sendTypingNotification(e,t){const r=o.t(t||{});return this.sendOperationRequest({chatThreadId:e,options:r},J)}listChatThreadMembers(e,t){const r=o.t(t||{});return this.sendOperationRequest({chatThreadId:e,options:r},Y)}addChatThreadMembers(e,t,r){const n=o.t(r||{});return this.sendOperationRequest({chatThreadId:e,body:t,options:n},Z)}removeChatThreadMember(e,t,r){const n=o.t(r||{});return this.sendOperationRequest({chatThreadId:e,chatMemberId:t,options:n},ee)}createChatThread(e,t){const r=o.t(t||{});return this.sendOperationRequest({body:e,options:r},te)}listChatThreads(e){const t=o.t(e||{});return this.sendOperationRequest({options:t},re)}updateChatThread(e,t,r){const n=o.t(r||{});return this.sendOperationRequest({chatThreadId:e,body:t,options:n},ne)}getChatThread(e,t){const r=o.t(t||{});return this.sendOperationRequest({chatThreadId:e,options:r},oe)}deleteChatThread(e,t){const r=o.t(t||{});return this.sendOperationRequest({chatThreadId:e,options:r},ie)}listChatReadReceiptsNext(e,t,r){const n=o.t(r||{});return this.sendOperationRequest({chatThreadId:e,nextLink:t,options:n},se)}listChatMessagesNext(e,t,r){const n=o.t(r||{});return this.sendOperationRequest({chatThreadId:e,nextLink:t,options:n},ae)}listChatThreadMembersNext(e,t,r){const n=o.t(r||{});return this.sendOperationRequest({chatThreadId:e,nextLink:t,options:n},ce)}listChatThreadsNext(e,t){const r=o.t(t||{});return this.sendOperationRequest({nextLink:e,options:r},ue)}}const F=new i.ei(n,!1),V={path:"/chat/threads/{chatThreadId}/readreceipts",httpMethod:"GET",responses:{200:{bodyMapper:s},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},queryParameters:[P],urlParameters:[C,E],serializer:F},G={path:"/chat/threads/{chatThreadId}/readreceipts",httpMethod:"POST",responses:{201:{},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},requestBody:N,queryParameters:[P],urlParameters:[C,E],headerParameters:[S],mediaType:"json",serializer:F},$={path:"/chat/threads/{chatThreadId}/messages",httpMethod:"POST",responses:{201:{bodyMapper:p},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},requestBody:k,queryParameters:[P],urlParameters:[C,E],headerParameters:[S],mediaType:"json",serializer:F},K={path:"/chat/threads/{chatThreadId}/messages",httpMethod:"GET",responses:{200:{bodyMapper:d},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},queryParameters:[P,A,I],urlParameters:[C,E],serializer:F},X={path:"/chat/threads/{chatThreadId}/messages/{chatMessageId}",httpMethod:"GET",responses:{200:{bodyMapper:h},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},queryParameters:[P],urlParameters:[C,E,M],serializer:F},Q={path:"/chat/threads/{chatThreadId}/messages/{chatMessageId}",httpMethod:"PATCH",responses:{200:{},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},requestBody:x,queryParameters:[P],urlParameters:[C,E,M],headerParameters:[S],mediaType:"json",serializer:F},W={path:"/chat/threads/{chatThreadId}/messages/{chatMessageId}",httpMethod:"DELETE",responses:{204:{},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},queryParameters:[P],urlParameters:[C,E,M],serializer:F},J={path:"/chat/threads/{chatThreadId}/typing",httpMethod:"POST",responses:{200:{},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},queryParameters:[P],urlParameters:[C,E],serializer:F},Y={path:"/chat/threads/{chatThreadId}/members",httpMethod:"GET",responses:{200:{bodyMapper:y},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},queryParameters:[P],urlParameters:[C,E],serializer:F},Z={path:"/chat/threads/{chatThreadId}/members",httpMethod:"POST",responses:{207:{},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},requestBody:D,queryParameters:[P],urlParameters:[C,E],headerParameters:[S],mediaType:"json",serializer:F},ee={path:"/chat/threads/{chatThreadId}/members/{chatMemberId}",httpMethod:"DELETE",responses:{204:{},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},queryParameters:[P],urlParameters:[C,E,{parameterPath:"chatMemberId",mapper:{serializedName:"chatMemberId",required:!0,type:{name:"String"}}}],serializer:F},te={path:"/chat/threads",httpMethod:"POST",responses:{207:{bodyMapper:T},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},requestBody:U,queryParameters:[P],urlParameters:[C],headerParameters:[S],mediaType:"json",serializer:F},re={path:"/chat/threads",httpMethod:"GET",responses:{200:{bodyMapper:_},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},queryParameters:[P,A,I],urlParameters:[C],serializer:F},ne={path:"/chat/threads/{chatThreadId}",httpMethod:"PATCH",responses:{200:{},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},requestBody:q,queryParameters:[P],urlParameters:[C,E],headerParameters:[S],mediaType:"json",serializer:F},oe={path:"/chat/threads/{chatThreadId}",httpMethod:"GET",responses:{200:{bodyMapper:O},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},queryParameters:[P],urlParameters:[C,E],serializer:F},ie={path:"/chat/threads/{chatThreadId}",httpMethod:"DELETE",responses:{204:{},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},queryParameters:[P],urlParameters:[C,E],serializer:F},se={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:s},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},queryParameters:[P],urlParameters:[C,E,L],serializer:F},ae={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:d},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},queryParameters:[P,A,I],urlParameters:[C,E,L],serializer:F},ce={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:y},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},queryParameters:[P],urlParameters:[C,E,L],serializer:F},ue={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:_},401:{bodyMapper:c},403:{bodyMapper:c},429:{bodyMapper:c},503:{bodyMapper:c}},queryParameters:[P,A,I],urlParameters:[C,L],serializer:F}},2780:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ChatClient:()=>a.A,ChatThreadClient:()=>c.D});var n=r(1662),o={};for(const e in n)"default"!==e&&(o[e]=()=>n[e]);r.d(t,o);var i=r(3730);o={};for(const e in i)"default"!==e&&(o[e]=()=>i[e]);r.d(t,o);var s=r(2196);o={};for(const e in s)"default"!==e&&(o[e]=()=>s[e]);r.d(t,o);var a=r(9396),c=r(5267)},1543:(e,t,r)=>{"use strict";r.d(t,{k:()=>n});const n=(0,r(860).YR)("communication-chat")},1266:(e,t,r)=>{"use strict";r.d(t,{Ue:()=>o,Dw:()=>i,KJ:()=>s,Oq:()=>a,CX:()=>c,Op:()=>u,Qq:()=>l});var n=r(1230);const o=e=>{const t=Object.assign(Object.assign({},e),{id:e.user.communicationUserId});return delete t.user,t},i=e=>{var t;return{members:null===(t=e.members)||void 0===t?void 0:t.map((e=>o(e)))}},s=e=>{const t=Object.assign(Object.assign({},e),{sender:{communicationUserId:e.senderId}});return delete t.senderId,t},a=e=>{const t=Object.assign(Object.assign({},e),{user:{communicationUserId:e.id}});return delete t.id,t},c=e=>{var t;return{id:e.id,topic:e.topic,createdOn:e.createdOn,createdBy:{communicationUserId:e.createdBy},members:null===(t=e.members)||void 0===t?void 0:t.map((e=>a(e)))}},u=e=>{const t=Object.assign(Object.assign({},e),{sender:{communicationUserId:e.senderId}});return delete t.senderId,t},l=(e,t)=>{const{parsedBody:r,bodyAsText:o}=t,i=(0,n._T)(t,["parsedBody","bodyAsText"]);return Object.defineProperty(e,"_response",{value:i})}},2196:()=>{},1662:()=>{},3730:()=>{},1433:(e,t,r)=>{"use strict";r.d(t,{k:()=>i});var n=r(7176),o=r(6563);function i(e,t){const r=(0,n.Y)(),i=t.tracingOptions||{},s=Object.assign(Object.assign({},i.spanOptions),{kind:o.SpanKind.INTERNAL}),a=r.startSpan(`Azure.Communication.${e}`,s);a.setAttribute("az.namespace","Microsoft.Communication");let c=i.spanOptions||{};a.isRecording()&&(c=Object.assign(Object.assign({},i.spanOptions),{parent:a.context(),attributes:Object.assign(Object.assign({},s.attributes),{"az.namespace":"Microsoft.Communication"})}));const u=Object.assign(Object.assign({},i),{spanOptions:c});return{span:a,updatedOptions:Object.assign(Object.assign({},t),{tracingOptions:u})}}},9290:function(module,__unused_webpack_exports,__webpack_require__){var factory;factory=function(){"use strict";var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:{};function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var tsregistrar=createCommonjsModule((function(e,t){e.exports=function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.toJson=function(e){try{return JSON.stringify(e)}catch(t){return"Unable to serialize object of type "+typeof e}};var n=function(){function e(){this.start=Date.now()}return Object.defineProperty(e.prototype,"duration",{get:function(){return Date.now()-this.start},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startTime",{get:function(){return this.start},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.start=Date.now()},e}();t.Timespan=n},function(e,t,r){var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,i=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(s=(s=c.trys).length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){c.label=r[1];break}if(6===r[0]&&c.label<s[1]){c.label=s[1],s=r;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(r);break}s[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(e){r=[6,e],i=0}finally{o=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,s,a,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var s=r(0),a=function(e){function t(t){var r=e.call(this,t)||this;return r.name="CancelationError",r}return n(t,e),t}(Error),c=function(){function e(t,r,n){this.logger=t,this.maxBackoffInMs=r,this.initialDelay=n,this.backoffCount=0,this.id=++e.idCounter}return e.prototype.delay=function(e){var t=this;if(void 0!==this.timerHandle)throw new Error("Retry sequence logical failure");if(-1===this.backoffCount)return new Promise((function(e,t){t(new a("Cancelled"))}));var r=this.calculateNextBackoffMs();return this.backoffCount++,this.logger.info("[RegistrarClient] Backing off "+e+" for "+r+" milliseconds with ID "+this.id),new Promise((function(n,o){t.cancelFunc=o,t.timerHandle=setTimeout((function(){t.logger.info("[RegistrarClient] Back off for "+e+" with ID "+t.id+" complete"),t.timerHandle=void 0,n()}),r)}))},e.prototype.cancel=function(){void 0!==this.timerHandle&&(this.logger.debug("Resetting back off"),clearTimeout(this.timerHandle),void 0!==this.cancelFunc&&this.cancelFunc(new a("Cancelled"))),this.backoffCount=-1},e.prototype.calculateNextBackoffMs=function(){var e=1+.4*(Math.random()-.5),t=this.initialDelay*Math.pow(2,this.backoffCount)*e;return t=Math.round(t),Math.min(this.maxBackoffInMs,t)},e.idCounter=0,e}(),u=function(){function e(e,t,r){this.logger=e,this.skypeTokenProvider=t,this.options=r,this.backoffs={}}return e.prototype.setTelemetryLogger=function(e){this.eventLogger=e},e.prototype.register=function(e,t){return o(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return[4,this.performRegistration(e,t,"pr_set_registration")];case 1:return r.sent(),this.cachedRegistrationParams=[e,t],[2]}}))}))},e.prototype.unregister=function(){return o(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return this.logger.info("[RegistrarClient] sending unregister request"),e=new Request(this.options.registrarUrl+"/"+this.options.registrationId,{method:"DELETE",mode:"cors",headers:new Headers({accept:"application/json, text/javascript"})}),[4,this.callRegistrar(e,"pr_delete_registration")];case 1:return t.sent(),[2]}}))}))},e.prototype.cancelPendingRequests=function(){var e=this;Object.keys(this.backoffs).forEach((function(t){e.backoffs[t].cancel()})),this.backoffs={}},e.prototype.resendRegistration=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:if(!this.cachedRegistrationParams)throw new Error("Re-registration failed because there is no registration parameters cached");return[4,this.performRegistration(this.cachedRegistrationParams[0],this.cachedRegistrationParams[1],"pr_resend_registration")];case 1:return e.sent(),[2]}}))}))},e.prototype.performRegistration=function(e,t,r){return o(this,void 0,void 0,(function(){var n,o;return i(this,(function(i){switch(i.label){case 0:return this.logger.info("[RegistrarClient] Sending register request"),n={clientDescription:e,registrationId:this.options.registrationId,nodeId:"",transports:t},o=new Request(this.options.registrarUrl,{method:"POST",mode:"cors",headers:new Headers({"content-type":"application/json",accept:"application/json, text/javascript"}),body:s.toJson(n)}),[4,this.callRegistrar(o,r)];case 1:return i.sent(),[2]}}))}))},e.prototype.startBackoff=function(){var e=new c(this.logger,this.options.maxRetryDelayMs,this.options.initialRetryDelayMs);return this.backoffs[e.id]=e,e},e.prototype.stopBackoff=function(e){e.cancel(),delete this.backoffs[e.id]},e.prototype.getSkypeToken=function(){return o(this,void 0,void 0,(function(){var e,t,r;return i(this,(function(n){switch(n.label){case 0:e=this.startBackoff(),n.label=1;case 1:return n.trys.push([1,3,,8]),this.logger.info("[RegistrarClient] Asking for a new skypetoken"),[4,this.skypeTokenProvider(!0)];case 2:return t=n.sent(),this.stopBackoff(e),[2,t];case 3:n.sent(),n.label=4;case 4:return n.trys.push([4,6,,7]),[4,e.delay("Fetching a new skypetoken")];case 5:return n.sent(),[3,8];case 6:throw r=n.sent(),this.stopBackoff(e),r;case 7:return[3,8];case 8:return[3,1];case 9:return[2]}}))}))},e.prototype.callRegistrar=function(e,t){return o(this,void 0,void 0,(function(){var r,n,o,a,c,u,l,p,d;return i(this,(function(i){switch(i.label){case 0:return r=this.startBackoff(),[4,this.skypeTokenProvider(!1)];case 1:n=i.sent(),this.setSkypeTokenHeader(e,n),o=new s.Timespan,i.label=2;case 2:a=void 0,i.label=3;case 3:return i.trys.push([3,8,13,14]),c=e.clone(),[4,this.fetchWithTimeout(c)];case 4:return 401!==(a=i.sent()).status?[3,6]:(u=this.setSkypeTokenHeader,l=[e],[4,this.getSkypeToken()]);case 5:return u.apply(this,l.concat([i.sent()])),[3,15];case 6:if(a.status>=500&&a.status<600)throw new Error("Fetch for '"+e.url+"' failed with "+a.status+" "+a.statusText);i.label=7;case 7:return[3,14];case 8:p=i.sent(),this.logger.error("[RegistrarClient] Request failed with "+p),i.label=9;case 9:return i.trys.push([9,11,,12]),[4,r.delay("Registrar call retry")];case 10:return i.sent(),[3,15];case 11:throw d=i.sent(),this.logger.error("[RegistrarClient] Request cancelled"),this.stopBackoff(r),d;case 12:return[3,14];case 13:return this.sendTelemetryEvent(t,e,a,o),[7];case 14:if(this.stopBackoff(r),a.ok)return[2,a];throw new Error("Fetch for '"+e.url+"' failed with "+a.status+" "+a.statusText);case 15:return[3,2];case 16:return[2]}}))}))},e.prototype.setSkypeTokenHeader=function(e,t){e.headers.set("X-Skypetoken",t)},e.prototype.fetchWithTimeout=function(e){var t=this;return new Promise((function(r,n){fetch(e).then(r).catch(n),0!==t.options.requestTimeoutMs&&setTimeout(n,t.options.requestTimeoutMs,new Error("Fetch for '"+e.url+"' timed out"))}))},e.prototype.sendTelemetryEvent=function(e,t,r,n){if(void 0!==this.eventLogger){var o={name:e,properties:{url:{value:t.url},result_code:{value:void 0!==r?r.status:0},begin_timestamp:{value:n.startTime},elapsed:{value:n.duration}}};this.eventLogger.logEvent(o)}},e}();t.RegistrarClient=u,t.createRegistrarClient=function(e,t,r){return new u(e,t,r)}}])}));unwrapExports(tsregistrar);var tstrouter=createCommonjsModule((function(module,exports){var e;e=function(__WEBPACK_EXTERNAL_MODULE_20__){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=19)}([function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.name=e,this.logger=t}return e.prototype.debug=function(e){this.logger.debug("["+this.name+"] "+e)},e.prototype.info=function(e){this.logger.info("["+this.name+"] "+e)},e.prototype.warn=function(e){this.logger.warn("["+this.name+"] "+e)},e.prototype.error=function(e){this.logger.error("["+this.name+"] "+e)},e}();t.Logger=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});t.HttpHeaders=function(){},function(e){e[e.Unknown=0]="Unknown",e[e.Connected=2]="Connected",e[e.Disconnected=3]="Disconnected",e[e.Switching=9]="Switching"}(t.TrouterState||(t.TrouterState={})),function(e){e[e.Unknown=0]="Unknown",e[e.Active=1]="Active",e[e.Inactive=2]="Inactive"}(t.UserActivityState||(t.UserActivityState={}))},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.constants={TROUTER_INIT:"trouterinit",TROUTER_READY_EVENT:"trouterReadyEvent",TROUTER_READY_TIMEOUT:"trouterReadyTimeout",TROUTER_TOKEN_REQUEST:"trouterTokenRequest",TROUTER_TOKEN_GET_SUCCEEDED:"trouterTokenGetSucceeded",TROUTER_TOKEN_GET_FAILED:"trouterTokenGetFailed",TROUTER_RECONNECTING:"trouterReconnecting",RENEWAL:"renewal",NEW_CONNECTION:"newConnection",ENDPOINT_REGISTRATION_FAILED:"endpointRegistrationFailed"},t.CLIENT_VERSION="2020.37.01.1",t.HANDLED_MESSAGE_ACK=200,t.UNHANDLED_MESSAGE_ACK=404,t.FAILED_MESSAGE_ACK=500},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.toJson=function(e){try{return JSON.stringify(e)}catch(t){return"Unable to serialize object of type "+typeof e}},t.calculateTtlInSec=function(e){var t=Math.round((new Date).getTime()/1e3);return void 0!==e&&e>t?e-t:0},t.calculateExpireTsInSec=function(e){return Math.round((new Date).getTime()/1e3)+e};var n=function(){function e(){this.start=Date.now()}return Object.defineProperty(e.prototype,"duration",{get:function(){return Date.now()-this.start},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startTime",{get:function(){return this.start},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.start=Date.now()},e}();t.Timespan=n},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),o=function(){function e(e,t,r,n,o,i,s){this.connectionId=e,this.connectedClientId=t,this.domId=r,this.unsecureUrl=n,this.url=o,this.c2cUrlBase=i,this.expirationTsSec=s}return e.prototype.getRemainingTtlInSec=function(){return n.calculateTtlInSec(this.expirationTsSec)},e}();t.ServerState=o,function(e){e[e.Unknown=0]="Unknown",e[e.Modified=1]="Modified",e[e.Snapshot=2]="Snapshot",e[e.Connected=3]="Connected"}(t.UserActivityEventReason||(t.UserActivityEventReason={}))},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=function(){function e(e){this.logger=e,this.messageHandlers=[]}return e.prototype.register=function(e){if(this.messageHandlers.some((function(t){return t===e})))throw new Error("Registering the same handler twice is not allowed");this.messageHandlers.push(e)},e.prototype.clear=function(){this.logger.debug("Clearing message handlers"),this.messageHandlers=[]},e.prototype.active=function(){return this.messageHandlers.length>0},e.prototype.handleMessage=function(e){for(var t={resultCode:n.UNHANDLED_MESSAGE_ACK,isHandled:!1},r=0,o=this.messageHandlers;r<o.length;r++){var i=o[r],s=this.safeExecuteHandle(i,e);if(void 0!==s&&(void 0===s.isHandled||s.isHandled))return void 0===s.resultCode&&(s.resultCode=n.HANDLED_MESSAGE_ACK),s}return t},e.prototype.safeExecuteHandle=function(e,t){try{return e.handleMessage(t)}catch(e){return void this.logger.warn("A trouter message handler is throwing exceptions. exception: "+e)}},e}();t.MessageHandlerRegistry=o},function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,i=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(s=(s=c.trys).length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){c.label=r[1];break}if(6===r[0]&&c.label<s[1]){c.label=s[1],s=r;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(r);break}s[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(e){r=[6,e],i=0}finally{o=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,s,a,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0}),t.addCacheAsBackupTo=function(e){var t,r=this;return function(i){return n(r,void 0,void 0,(function(){return o(this,(function(r){return i&&(t=void 0),[2,new Promise((function(r,n){e(i).then((function(e){t=e,r(e)})).catch((function(e){void 0!==t&&t.length>0&&r(t),n(e)}))}))]}))}))}}},function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,i=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(s=(s=c.trys).length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){c.label=r[1];break}if(6===r[0]&&c.label<s[1]){c.label=s[1],s=r;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(r);break}s[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(e){r=[6,e],i=0}finally{o=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,s,a,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var i=r(3),s=r(1),a=r(0),c=r(16),u=r(18),l=function(){function e(e,t,r,n){this.logFunc=e,this.options=t,this.tokenProvider=r,this.listener=n,this.logger=new a.Logger("Manager",e),this.logger.info("Created TrouterManager with options "+i.toJson(this.options)),this.fsm=new u.TrouterManagerFsm(e,this),this.baseEndpointUrl="",this.processedMessageLoss={}}return e.prototype.start=function(){this.fsm.start()},e.prototype.stop=function(){this.fsm.stop()},e.prototype.configure=function(e){this.options=e,void 0!==this.firstConnection&&this.firstConnection.configure(e),void 0!==this.secondConnection&&this.secondConnection.configure(e),this.logger.info("Reconfigured TrouterManager with options "+i.toJson(this.options))},e.prototype.checkConnection=function(e){void 0!==this.firstConnection&&this.firstConnection.checkConnection(e),void 0!==this.secondConnection&&this.secondConnection.checkConnection(e)},e.prototype.resendRegistration=function(){return n(this,void 0,void 0,(function(){return o(this,(function(e){return void 0!==this.secondConnection?(this.logger.info("Resending registration on the second/new connection"),[2,this.secondConnection.resendRegistration()]):void 0!==this.firstConnection?(this.logger.info("Resending registration on the first/current connection"),[2,this.firstConnection.resendRegistration()]):(this.logger.info("No connection to resend registration on, will be done upon (re)connect"),[2])}))}))},e.prototype.getServerState=function(){if(void 0!==this.firstConnection)return this.firstConnection.getServerState()},e.prototype.getState=function(){return this.fsm.getState()},e.prototype.startFirstConnection=function(){this.firstConnection=new c.TrouterConnection(this.logFunc,this.options,this,this.tokenProvider),this.firstConnection.start()},e.prototype.startSecondConnection=function(){var e=void 0!==this.firstConnection?this.firstConnection.getUserActivityState():s.UserActivityState.Unknown;this.secondConnection=new c.TrouterConnection(this.logFunc,this.options,this,this.tokenProvider,e),this.secondConnection.start()},e.prototype.stopFirstConnection=function(e){void 0!==this.firstConnection&&(this.firstConnection.stop(e),this.storedFirstConnection=this.firstConnection,this.firstConnection=void 0)},e.prototype.stopSecondConnection=function(e){void 0!==this.secondConnection&&(this.secondConnection.stop(e),this.secondConnection=void 0)},e.prototype.stopSecondConnectionDelayed=function(){if(void 0!==this.secondConnection){var e=this.secondConnection;this.secondConnection=void 0,this.logger.info("Closing an inactive connection in "+Math.round(this.options.lingeringConnectionDelayMs/1e3)+"s"),setTimeout((function(){e.stop(!0)}),this.options.lingeringConnectionDelayMs)}},e.prototype.switchConnections=function(){var e=this.firstConnection;this.firstConnection=this.secondConnection,this.secondConnection=e},e.prototype.doesSecondConnectionExist=function(){return void 0!==this.secondConnection},e.prototype.dispatchConnected=function(){if(void 0!==this.firstConnection){var e=this.firstConnection.getServerState(),t="/"===e.url.slice(-1)?e.url.slice(0,-1):e.url,r={baseEndpointUrl:t,newEndpointUrl:t!==this.baseEndpointUrl,c2cUrlBase:e.c2cUrlBase,clientId:e.connectedClientId,connectionId:e.connectionId,connectionTtlSec:e.getRemainingTtlInSec()};this.baseEndpointUrl=t,this.listener.onTrouterConnected(e.url,r)}},e.prototype.dispatchReconnecting=function(){this.listener.onTrouterDisconnected&&this.listener.onTrouterDisconnected()},e.prototype.dispatchStopped=function(){this.listener.onTrouterDisconnected&&this.listener.onTrouterDisconnected()},e.prototype.onDownstreamRequest=function(e,t,r){var n={id:t.id,method:t.method,path:"/"+t.shortUrl,body:t.body,headers:t.headers},o={id:t.id,status:0,headers:{},body:"",send:function(){return o.status<=100||o.status>=999?3:(r.writeHead(o.status,o.headers),r.end(o.body))}};this.listener.onTrouterRequest(n,o)},e.prototype.onConnected=function(e){this.fsm.onConnected(e===this.firstConnection)},e.prototype.onRegistered=function(e){this.fsm.onRegistered(e===this.firstConnection)},e.prototype.onReconnecting=function(e){this.fsm.onReconnecting(e===this.firstConnection)},e.prototype.onReconnectIsRequired=function(e){this.fsm.onReconnectionRequired(e===this.firstConnection)},e.prototype.onDisconnected=function(e){this.fsm.onDisconnected(e===this.storedFirstConnection)},e.prototype.setUserActivityState=function(e){if(void 0!==this.secondConnection)return this.logger.info("Setting user activity state "+s.UserActivityState[e]+" on the second/new connection"),void this.secondConnection.setUserActivityState(e);if(void 0!==this.firstConnection)return this.logger.info("Setting user activity state "+s.UserActivityState[e]+" on the first/current connection"),void this.firstConnection.setUserActivityState(e);throw new Error("setUserActivityState called too early")},e.prototype.onTrouterMessageLost=function(e){var t=this;if(this.listener.onTrouterMessageLoss)if(e&&e.length){var r=e.filter((function(e){return void 0!==t.processedMessageLoss[e.tag+"-"+e.etag]}));if(r.length&&(this.logger.warn("onTrouterMessageLoss - removing duplicates and sending event to server"),this.sendProcessedDroppedIndicators(r),!(e=e.filter((function(e){return void 0===t.processedMessageLoss[e.tag+"-"+e.etag]}))).length))return void this.logger.warn("onTrouterMessageLoss - All the data are duplicated");if(!this.listener.onTrouterMessageLoss(e.map((function(e){return e.tag}))))return void this.logger.warn("onTrouterMessageLoss - flow tags have not been processed by listeners");e.forEach((function(e){t.processedMessageLoss[e.tag+"-"+e.etag]=""})),this.sendProcessedDroppedIndicators(e)}else this.logger.warn("onTrouterMessageLoss - no flow tags have been provided")},e.prototype.sendProcessedDroppedIndicators=function(e){return void 0!==this.firstConnection?void this.firstConnection.sendProcessedDroppedIndicators(e):void 0!==this.secondConnection?void this.secondConnection.sendProcessedDroppedIndicators(e):void 0},e}();t.TrouterManager=l},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.logger=e}return e.prototype.getPromise=function(){var e=this;return void 0!==this.url?(this.logger.debug("[TrouterUrlPromise] returning previously resolved url: "+this.url),Promise.resolve(this.url)):(void 0===this.pendingPromise?(this.logger.debug("[TrouterUrlPromise] creating and returning promise"),this.pendingPromise=new Promise((function(t,r){e.pendingPromiseResolveRef=t,e.pendingPromiseRejectRef=r}))):this.logger.debug("[TrouterUrlPromise] returning existing promise"),this.pendingPromise)},e.prototype.resolveUrl=function(e){this.url=e,this.logger.debug("[TrouterUrlPromise] got url: "+this.url);var t=this.pendingPromiseResolveRef;this.pendingPromise=void 0,this.pendingPromiseResolveRef=void 0,this.pendingPromiseRejectRef=void 0,void 0!==t&&(this.logger.debug("[TrouterUrlPromise] resolving promise"),t(e))},e.prototype.rejectUrl=function(e){this.logger.debug("[TrouterUrlPromise] aborting");var t=this.pendingPromiseRejectRef;this.url=void 0,this.pendingPromise=void 0,this.pendingPromiseResolveRef=void 0,this.pendingPromiseRejectRef=void 0,void 0!==t&&(this.logger.debug("[TrouterUrlPromise] rejecting promise"),t(e))},e.prototype.resetUrl=function(){this.logger.debug("[TrouterUrlPromise] resetting url"),this.url=void 0},e}();t.TrouterUrlPromise=n},function(module,exports,__nested_webpack_require_25138__){(function(global,module){var t,e,n;t=module.exports,e=void 0===global?window:global,n=t,n.version="0.9.6",n.protocol=1,n.transports=[],n.j=[],n.sockets={},n.connect=function(t,r){var o,i,s=n.util.parseUri(t);e&&e.location&&(s.protocol=s.protocol||e.location.protocol.slice(0,-1),s.host=s.host||(e.document?e.document.domain:e.location.hostname),s.port=s.port||e.location.port),o=n.util.uniqueUri(s);var a={host:s.host,secure:"https"==s.protocol,port:s.port||("https"==s.protocol?443:80),query:s.query||""};return n.util.merge(a,r),!a["force new connection"]&&n.sockets[o]||(i=new n.Socket(a)),!a["force new connection"]&&i&&(n.sockets[o]=i),(i=i||n.sockets[o]).of(s.path.length>1?s.path:"")};var io=module.exports;!function(e,t){var r=e.util={},n=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,o=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];r.parseUri=function(e){for(var t=n.exec(e||""),r={},i=14;i--;)r[o[i]]=t[i]||"";return r},r.uniqueUri=function(e){var r=e.protocol,n=e.host,o=e.port;return"document"in t?(n=n||document.domain,o=o||("https"==r&&"https:"!==document.location.protocol?443:document.location.port)):(n=n||"localhost",o||"https"!=r||(o=443)),(r||"http")+"://"+n+":"+(o||80)},r.query=function(e,t){var n=r.chunkQuery(e||""),o=[];for(var i in r.merge(n,r.chunkQuery(t||"")),n)n.hasOwnProperty(i)&&o.push(i+"="+n[i]);return o.length?"?"+o.join("&"):""},r.chunkQuery=function(e){for(var t,r={},n=e.split("&"),o=0,i=n.length;o<i;++o)(t=n[o].split("="))[0]&&(r[t[0]]=t[1]);return r};var i=!1;r.load=function(e){if("document"in t&&"complete"===document.readyState||i)return e();r.on(t,"load",e,!1)},r.on=function(e,t,r,n){e.attachEvent?e.attachEvent("on"+t,r):e.addEventListener&&e.addEventListener(t,r,n)},r.request=function(e){if(e&&"undefined"!=typeof XDomainRequest)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!e||r.ua.hasCORS))return new XMLHttpRequest;if(!e)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}return null},"undefined"!=typeof window&&r.load((function(){i=!0})),r.defer=function(e){if(!r.ua.webkit||"undefined"!=typeof importScripts)return e();r.load((function(){setTimeout(e,100)}))},r.merge=function(e,t,n,o){var i,s=o||[],a=void 0===n?2:n;for(i in t)t.hasOwnProperty(i)&&r.indexOf(s,i)<0&&("object"==typeof e[i]&&a?r.merge(e[i],t[i],a-1,s):(e[i]=t[i],s.push(t[i])));return e},r.mixin=function(e,t){r.merge(e.prototype,t.prototype)},r.inherit=function(e,t){function r(){}r.prototype=t.prototype,e.prototype=new r},r.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},r.intersect=function(e,t){for(var n=[],o=e.length>t.length?e:t,i=e.length>t.length?t:e,s=0,a=i.length;s<a;s++)~r.indexOf(o,i[s])&&n.push(i[s]);return n},r.indexOf=function(e,t,r){var n=e.length;for(r=r<0?r+n<0?0:r+n:r||0;r<n&&e[r]!==t;r++);return n<=r?-1:r},r.toArray=function(e){for(var t=[],r=0,n=e.length;r<n;r++)t.push(e[r]);return t},r.ua={},r.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var e=new XMLHttpRequest}catch(e){return!1}return null!=e.withCredentials}(),r.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent)}(void 0!==io?io:module.exports,void 0===global?window:global),function(e,t){function r(){}e.EventEmitter=r,r.prototype.on=function(e,r){return this.$events||(this.$events={}),this.$events[e]?t.util.isArray(this.$events[e])?this.$events[e].push(r):this.$events[e]=[this.$events[e],r]:this.$events[e]=r,this},r.prototype.addListener=r.prototype.on,r.prototype.once=function(e,t){function r(){n.removeListener(e,r),t.apply(this,arguments)}var n=this;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,r){if(this.$events&&this.$events[e]){var n=this.$events[e];if(t.util.isArray(n)){for(var o=-1,i=0,s=n.length;i<s;i++)if(n[i]===r||n[i].listener&&n[i].listener===r){o=i;break}if(o<0)return this;n.splice(o,1),n.length||delete this.$events[e]}else(n===r||n.listener&&n.listener===r)&&delete this.$events[e]}return this},r.prototype.removeAllListeners=function(e){return this.$events&&this.$events[e]&&(this.$events[e]=null),this},r.prototype.listeners=function(e){return this.$events||(this.$events={}),this.$events[e]||(this.$events[e]=[]),t.util.isArray(this.$events[e])||(this.$events[e]=[this.$events[e]]),this.$events[e]},r.prototype.emit=function(e){if(!this.$events)return!1;var r=this.$events[e];if(!r)return!1;var n=Array.prototype.slice.call(arguments,1);if("function"==typeof r)r.apply(this,n);else{if(!t.util.isArray(r))return!1;for(var o=r.slice(),i=0,s=o.length;i<s;i++)o[i].apply(this,n)}return!0}}(void 0!==io?io:module.exports,void 0!==io?io:module.parent.exports),function(exports,nativeJSON){function f(e){return e<10?"0"+e:e}function date(e,t){return isFinite(e.valueOf())?e.getUTCFullYear()+"-"+f(e.getUTCMonth()+1)+"-"+f(e.getUTCDate())+"T"+f(e.getUTCHours())+":"+f(e.getUTCMinutes())+":"+f(e.getUTCSeconds())+"Z":null}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,(function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function str(e,t){var r,n,o,i,s,a=gap,c=t[e];switch(c instanceof Date&&(c=date(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(c)){for(i=c.length,r=0;r<i;r+=1)s[r]=str(r,c)||"null";return o=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+a+"]":"["+s.join(",")+"]",gap=a,o}if(rep&&"object"==typeof rep)for(i=rep.length,r=0;r<i;r+=1)"string"==typeof rep[r]&&(o=str(n=rep[r],c))&&s.push(quote(n)+(gap?": ":":")+o);else for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(o=str(n,c))&&s.push(quote(n)+(gap?": ":":")+o);return o=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+a+"}":"{"+s.join(",")+"}",gap=a,o}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(e,t,r){var n;if(gap="",indent="","number"==typeof r)for(n=0;n<r;n+=1)indent+=" ";else"string"==typeof r&&(indent=r);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})},JSON.parse=function(text,reviver){function walk(e,t){var r,n,o=e[t];if(o&&"object"==typeof o)for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(void 0!==(n=walk(o,r))?o[r]=n:delete o[r]);return reviver.call(e,t,o)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}(void 0!==io?io:module.exports,"undefined"!=typeof JSON?JSON:void 0),function(e,t){var r=e.parser={},n=r.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],o=r.reasons=["transport not supported","client not handshaken","unauthorized"],i=r.advice=["reconnect"],s=t.JSON,a=t.util.indexOf;r.encodePacket=function(e){var t=a(n,e.type),r=e.id||"",c=e.endpoint||"",u=e.ack,l=null;switch(e.type){case"error":var p=e.reason?a(o,e.reason):"",d=e.advice?a(i,e.advice):"";""===p&&""===d||(l=p+(""!==d?"+"+d:""));break;case"message":""!==e.data&&(l=e.data);break;case"event":var h={name:e.name};e.args&&e.args.length&&(h.args=e.args),l=s.stringify(h);break;case"json":l=s.stringify(e.data);break;case"connect":e.qs&&(l=e.qs);break;case"ack":l=e.ackId+(e.args&&e.args.length?"+"+s.stringify(e.args):"")}var f=[t,r+("data"==u?"+":""),c];return null!=l&&f.push(l),f.join(":")},r.encodePayload=function(e){var t="";if(1==e.length)return e[0];for(var r=0,n=e.length;r<n;r++)t+="�"+e[r].length+"�"+e[r];return t};var c=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;r.decodePacket=function(e){if(!(a=e.match(c)))return{};var t=a[2]||"",r=(e=a[5]||"",{type:n[a[1]],endpoint:a[4]||""});switch(t&&(r.id=t,a[3]?r.ack="data":r.ack=!0),r.type){case"error":var a=e.split("+");r.reason=o[a[0]]||"",r.advice=i[a[1]]||"";break;case"message":r.data=e||"";break;case"event":try{var u=s.parse(e);r.name=u.name,r.args=u.args}catch(e){}r.args=r.args||[];break;case"json":try{r.data=s.parse(e)}catch(e){}break;case"connect":r.qs=e||"";break;case"ack":if((a=e.match(/^([0-9]+)(\+)?(.*)/))&&(r.ackId=a[1],r.args=[],a[3]))try{r.args=a[3]?s.parse(a[3]):[]}catch(e){}}return r},r.decodePayload=function(e){if("�"==e.charAt(0)){for(var t=[],n=1,o="";n<e.length;n++)"�"==e.charAt(n)?(t.push(r.decodePacket(e.substr(n+1).substr(0,o))),n+=Number(o)+1,o=""):o+=e.charAt(n);return t}return[r.decodePacket(e)]}}(void 0!==io?io:module.exports,void 0!==io?io:module.parent.exports),function(e,t){function r(e,t){this.socket=e,this.sessid=t,this.connectErrorCallback=void 0,this.isOpened=!1}e.Transport=r,t.util.mixin(r,t.EventEmitter),r.prototype.onData=function(e){if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==e){var r=t.parser.decodePayload(e);if(r&&r.length)for(var n=0,o=r.length;n<o;n++)this.onPacket(r[n])}return this},r.prototype.onPacket=function(e){return this.socket.setHeartbeatTimeout(),"heartbeat"==e.type?this.onHeartbeat():("connect"==e.type&&""==e.endpoint&&this.onConnect(),"error"==e.type&&"reconnect"==e.advice&&(this.isOpened=!1),this.socket.onPacket(e),this)},r.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var e=this;this.closeTimeout=setTimeout((function(){e.onDisconnect()}),this.socket.closeTimeout)}},r.prototype.onDisconnect=function(){return this.close&&this.isOpened&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},r.prototype.onConnect=function(){return this.socket.onConnect(),this.connectErrorCallback=void 0,this},r.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},r.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},r.prototype.packet=function(e){this.send(t.parser.encodePacket(e))},r.prototype.onHeartbeat=function(e){this.packet({type:"heartbeat"})},r.prototype.onOpen=function(){this.isOpened=!0,this.clearCloseTimeout(),this.socket.onOpen()},r.prototype.onClose=function(){this.isOpened=!1,this.socket.onClose(),this.onDisconnect()},r.prototype.prepareUrl=function(){var e=this.socket.options;return this.scheme()+"://"+e.host+":"+e.port+"/"+e.resource+"/"+t.protocol+"/"+this.name+"/"+this.sessid},r.prototype.ready=function(e,t){t.call(this)},r.prototype.clearEventHandlers=function(){return this}}(void 0!==io?io:module.exports,void 0!==io?io:module.parent.exports),function(e,t,r){function n(e){if(this.options={port:80,secure:!1,document:"document"in r&&document,resource:"socket.io",transports:t.transports.slice(),"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!0,"auto connect":!0,"flash policy port":10843},t.util.merge(this.options,e),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||t.util.ua.hasCORS)){var n=this;t.util.on(r,"unload",(function(){n.disconnectSync()}),!1)}this.options["auto connect"]&&this.connect()}function o(){}e.Socket=n,t.util.mixin(n,t.EventEmitter),n.prototype.of=function(e){return this.namespaces[e]||(this.namespaces[e]=new t.SocketNamespace(this,e),""!==e&&this.namespaces[e].packet({type:"connect"})),this.namespaces[e]},n.prototype.publish=function(){var e;for(var t in this.emit.apply(this,arguments),this.namespaces)this.namespaces.hasOwnProperty(t)&&(e=this.of(t)).$emit.apply(e,arguments)},n.prototype.handshake=function(e){function r(t){t instanceof Error?n.onError(t.message):e.apply(null,t.split(":"))}var n=this,i=this.options,s=["http"+(i.secure?"s":"")+":/",i.host+":"+i.port,i.resource,t.protocol,t.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!t.util.ua.hasCORS){var a=document.getElementsByTagName("script")[0],c=document.createElement("script");c.src=s+"&jsonp="+t.j.length,a.parentNode.insertBefore(c,a),t.j.push((function(e){r(e),c.parentNode.removeChild(c)}))}else{var u=t.util.request();u.open("GET",s,!0),u.withCredentials=!0,u.onreadystatechange=function(){4==u.readyState&&(u.onreadystatechange=o,200==u.status?r(u.responseText):!n.reconnecting&&n.onError(u.responseText))},u.send(null)}},n.prototype.getTransport=function(e){for(var r,n=e||this.transports,o=0;r=n[o];o++)if(t.Transport[r]&&t.Transport[r].check(this)&&(!this.isXDomain()||t.Transport[r].xdomainCheck()))return new t.Transport[r](this,this.sessionid);return null},n.prototype.connect=function(e){if(this.connecting)return this;var r=this;return this.handshake((function(n,o,i,s){function a(){if(!r.connected)if(r.connecting=!1,clearTimeout(r.connectTimeoutTimer),r.options["try multiple transports"]){for(;r.remainingTransports.length>0&&r.remainingTransports.splice(0,1)[0]!=r.transport.name;);r.remainingTransports.length?c(r.remainingTransports):r.publish("connect_failed")}else r.publish("connect_failed")}function c(e){if(r.transport&&(r.transport.clearTimeouts(),r.transport.clearEventHandlers()),r.transport=r.getTransport(e),!r.transport)return r.publish("connect_failed");r.transport.ready(r,(function(){r.connecting=!0,r.publish("connecting",r.transport.name),r.transport.open(a),r.options["connect timeout"]&&(r.connectTimeoutTimer=setTimeout((function(){a()}),r.options["connect timeout"]))}))}r.sessionid=n,r.closeTimeout=1e3*i+2e3,r.heartbeatTimeout=1e3*o+2e3,r.transports=s?t.util.intersect(s.split(","),r.options.transports):r.options.transports,r.setHeartbeatTimeout(),r.remainingTransports=r.transports.slice(0),c(r.transports),r.once("connect",(function(){clearTimeout(r.connectTimeoutTimer),e&&"function"==typeof e&&e()}))})),this},n.prototype.setHeartbeatTimeout=function(){clearTimeout(this.heartbeatTimeoutTimer);var e=this;this.heartbeatTimeoutTimer=setTimeout((function(){e.transport.onClose()}),this.heartbeatTimeout)},n.prototype.packet=function(e){return this.connected&&!this.doBuffer?this.transport.packet(e):this.buffer.push(e),this},n.prototype.setBuffer=function(e){this.doBuffer=e,!e&&this.connected&&this.buffer.length&&(this.transport.payload(this.buffer),this.buffer=[])},n.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},n.prototype.disconnectSync=function(){var e=t.util.request(),r=this.resource+"/"+t.protocol+"/"+this.sessionid;e.open("GET",r,!0),this.onDisconnect("booted")},n.prototype.isXDomain=function(){var e=r.location.port||("https:"==r.location.protocol?443:80);return this.options.host!==r.location.hostname||this.options.port!=e},n.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},n.prototype.onOpen=function(){this.open=!0},n.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},n.prototype.onPacket=function(e){this.of(e.endpoint).onPacket(e)},n.prototype.onError=function(e){e&&e.advice&&"reconnect"===e.advice&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",e&&e.reason?e.reason:e)},n.prototype.onDisconnect=function(e){var t=this.connected,r=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1,(t||r)&&(this.transport.close(),this.transport.clearTimeouts(),t&&(this.publish("disconnect",e),"booted"!=e&&this.options.reconnect&&!this.reconnecting&&this.reconnect()))},n.prototype.reconnect=function(){function e(){if(r.connected){for(var e in r.namespaces)r.namespaces.hasOwnProperty(e)&&""!==e&&r.namespaces[e].packet({type:"connect"});r.publish("reconnect",r.transport.name,r.reconnectionAttempts)}clearTimeout(r.reconnectionTimer),r.removeListener("connect_failed",t),r.removeListener("connect",t),r.reconnecting=!1,delete r.reconnectionAttempts,delete r.reconnectionDelay,delete r.reconnectionTimer,delete r.redoTransports,r.options["try multiple transports"]=o}function t(){if(r.reconnecting)return r.connected?e():r.connecting&&r.reconnecting?r.reconnectionTimer=setTimeout(t,1e3):void(r.reconnectionAttempts++>=n?r.redoTransports?(r.publish("reconnect_failed"),e()):(r.on("connect_failed",t),r.options["try multiple transports"]=!0,r.transport=r.getTransport(),r.redoTransports=!0,r.connect()):(r.reconnectionDelay<i&&(r.reconnectionDelay*=2),r.connect(),r.publish("reconnecting",r.reconnectionDelay,r.reconnectionAttempts),r.reconnectionTimer=setTimeout(t,r.reconnectionDelay)))}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var r=this,n=this.options["max reconnection attempts"],o=this.options["try multiple transports"],i=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(t,this.reconnectionDelay),this.on("connect",t)}}(void 0!==io?io:module.exports,void 0!==io?io:module.parent.exports,void 0===global?window:global),function(e,t){function r(e,t){this.socket=e,this.name=t||"",this.flags={},this.json=new n(this,"json"),this.ackPackets=0,this.acks={}}function n(e,t){this.namespace=e,this.name=t}e.SocketNamespace=r,t.util.mixin(r,t.EventEmitter),r.prototype.$emit=t.EventEmitter.prototype.emit,r.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},r.prototype.packet=function(e){return e.endpoint=this.name,this.socket.packet(e),this.flags={},this},r.prototype.send=function(e,t){var r={type:this.flags.json?"json":"message",data:e};return"function"==typeof t&&(r.id=++this.ackPackets,r.ack=!0,this.acks[r.id]=t),this.packet(r)},r.prototype.emit=function(e){var t=Array.prototype.slice.call(arguments,1),r=t[t.length-1],n={type:"event",name:e};return"function"==typeof r&&(n.id=++this.ackPackets,n.ack="data",this.acks[n.id]=r,t=t.slice(0,t.length-1)),n.args=t,this.packet(n)},r.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},r.prototype.onPacket=function(e){function r(){n.packet({type:"ack",args:t.util.toArray(arguments),ackId:e.id})}var n=this;switch(e.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(e.reason||"booted"):this.$emit("disconnect",e.reason);break;case"message":case"json":var o=["message",e.data];"data"==e.ack?o.push(r):e.ack&&this.packet({type:"ack",ackId:e.id}),this.$emit.apply(this,o);break;case"event":o=[e.name].concat(e.args),"data"==e.ack&&o.push(r),this.$emit.apply(this,o);break;case"ack":this.acks[e.ackId]&&(this.acks[e.ackId].apply(this,e.args),delete this.acks[e.ackId]);break;case"error":e.advice?this.socket.onError(e):"unauthorized"==e.reason?this.$emit("connect_failed",e.reason):this.$emit("error",e.reason)}},n.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},n.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}(void 0!==io?io:module.exports,void 0!==io?io:module.parent.exports),function(e,t,r){function n(e){t.Transport.apply(this,arguments)}function o(){}e.websocket=n,t.util.inherit(n,t.Transport),n.prototype.name="websocket",n.prototype.open=function(e){var n,o=t.util.query(this.socket.options.query),i=this;return this.connectErrorCallback=e,n||(n=r.MozWebSocket||r.WebSocket),this.websocket=new n(this.prepareUrl()+o),this.websocket.onopen=function(){i.onOpen(),i.socket.setBuffer(!1)},this.websocket.onmessage=function(e){i.onData(e.data)},this.websocket.onclose=function(){i.onClose(),i.socket.setBuffer(!0)},this.websocket.onerror=function(e){i.onError(e)},this},n.prototype.send=function(e){return this.websocket.send(e),this},n.prototype.payload=function(e){for(var t=0,r=e.length;t<r;t++)this.packet(e[t]);return this},n.prototype.close=function(){return this.websocket.close(),this},n.prototype.onError=function(e){void 0!==this.connectErrorCallback&&(this.connectErrorCallback(),this.connectErrorCallback=void 0),this.socket.onError(e)},n.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},n.check=function(){return"WebSocket"in r&&!("__addTask"in WebSocket)||"MozWebSocket"in r},n.xdomainCheck=function(){return!0},n.prototype.clearEventHandlers=function(){return this.websocket&&(this.websocket.onopen=this.websocket.onmessage=this.websocket.onclose=this.websocket.onerror=o),this},t.transports.push("websocket")}(void 0!==io?io.Transport:module.exports,void 0!==io?io:module.parent.exports,void 0===global?window:global),function(e,t,r){function n(e){e&&(t.Transport.apply(this,arguments),this.sendBuffer=[])}function o(){}e.XHR=n,t.util.inherit(n,t.Transport),n.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},n.prototype.payload=function(e){for(var r=[],n=0,o=e.length;n<o;n++)r.push(t.parser.encodePacket(e[n]));this.send(t.parser.encodePayload(r))},n.prototype.send=function(e){return this.post(e),this},n.prototype.post=function(e){var t=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),r.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=function(){this.onload=o,t.socket.setBuffer(!1)}:this.sendXHR.onreadystatechange=function(){4==this.readyState&&(this.onreadystatechange=o,t.posting=!1,200==this.status?(t.socket.setBuffer(!1),clearTimeout(t.sendXHR.ackTimeoutTimer)):t.onClose())},this.sendXHR.send(e),t.sendXHR.ackTimeoutTimer=setTimeout((function(){t.onClose()}),t.socket.options.ackTimeoutMs)},n.prototype.close=function(){return this.onClose(),this},n.prototype.request=function(e){var r=t.util.request(this.socket.isXDomain()),n=t.util.query(this.socket.options.query,"t="+ +new Date);if(r.open(e||"GET",this.prepareUrl()+n,!0),"POST"==e)try{r.setRequestHeader?r.setRequestHeader("Content-type","text/plain;charset=UTF-8"):r.contentType="text/plain"}catch(e){}return r},n.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},n.check=function(e,n){try{var o=t.util.request(n),i=r.XDomainRequest&&o instanceof XDomainRequest,s=(e&&e.options&&e.options.secure?"https:":"http:")!=r.location.protocol;if(o&&(!i||!s))return!0}catch(e){}return!1},n.xdomainCheck=function(){return n.check(null,!0)},n.prototype.clearEventHandlers=function(){return this.sendXHR&&(this.sendXHR.onreadystatechange=this.sendXHR.onload=o),this}}(void 0!==io?io.Transport:module.exports,void 0!==io?io:module.parent.exports,void 0===global?window:global),function(e,t,r){function n(){t.Transport.XHR.apply(this,arguments)}function o(){}e["xhr-polling"]=n,t.util.inherit(n,t.Transport.XHR),t.util.merge(n,t.Transport.XHR),n.prototype.name="xhr-polling",n.prototype.open=function(e){return this.connectErrorCallback=e,t.Transport.XHR.prototype.open.call(this),!1},n.prototype.get=function(){if(this.isOpened){var e=this;this.xhr=this.request(),r.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=function(){e.connectErrorCallback=void 0,this.onload=o,this.onerror=o,e.onData(this.responseText),e.get()},this.xhr.onerror=function(){e.onClose(),void 0!==e.connectErrorCallback&&(e.connectErrorCallback(),e.connectErrorCallback=void 0)}):this.xhr.onreadystatechange=function(){4==this.readyState&&(this.onreadystatechange=o,200==this.status?(e.connectErrorCallback=void 0,e.onData(this.responseText),e.get()):(e.onClose(),void 0!==e.connectErrorCallback&&(e.connectErrorCallback(),e.connectErrorCallback=void 0)))},this.xhr.send(null)}},n.prototype.onClose=function(){if(t.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=o;try{this.xhr.abort()}catch(e){}this.xhr=null}},n.prototype.ready=function(e,r){var n=this;t.util.defer((function(){r.call(n)}))},n.prototype.clearEventHandlers=function(){return t.Transport.XHR.prototype.clearEventHandlers.call(this),this.xhr&&(this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=o),this},t.transports.push("xhr-polling")}(void 0!==io?io.Transport:module.exports,void 0!==io?io:module.parent.exports,void 0===global?window:global),exports.io=io}).call(exports,__nested_webpack_require_25138__(4),__nested_webpack_require_25138__(13)(module))},function(e,t,r){(function(t,n){!function(t,r){e.exports=r()}(0,(function(){function e(e){return"function"==typeof e}function o(){var e=setTimeout;return function(){return e(i,1)}}function i(){for(var e=0;e<w;e+=2)(0,I[e])(I[e+1]),I[e]=void 0,I[e+1]=void 0;w=0}function s(e,t){var r=arguments,n=this,o=new this.constructor(c);void 0===o[x]&&T(o);var i=n._state;return i?function(){var e=r[i-1];E((function(){return v(i,o,e,n._result)}))}():y(n,o,e,t),o}function a(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(c);return p(t,e),t}function c(){}function u(e){try{return e.then}catch(e){return L.error=e,L}}function l(t,r,n){r.constructor===t.constructor&&n===s&&r.constructor.resolve===a?function(e,t){t._state===U?h(e,t._result):t._state===q?f(e,t._result):y(t,void 0,(function(t){return p(e,t)}),(function(t){return f(e,t)}))}(t,r):n===L?f(t,L.error):void 0===n?h(t,r):e(n)?function(e,t,r){E((function(e){var n=!1,o=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?p(e,r):h(e,r))}),(function(t){n||(n=!0,f(e,t))}),e._label);!n&&o&&(n=!0,f(e,o))}),e)}(t,r,n):h(t,r)}function p(e,t){e===t?f(e,new TypeError("You cannot resolve a promise with itself")):function(e){return"function"==typeof e||"object"==typeof e&&null!==e}(t)?l(e,t,u(t)):h(e,t)}function d(e){e._onerror&&e._onerror(e._result),g(e)}function h(e,t){e._state===D&&(e._result=t,e._state=U,0!==e._subscribers.length&&E(g,e))}function f(e,t){e._state===D&&(e._state=q,e._result=t,E(d,e))}function y(e,t,r,n){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+U]=r,o[i+q]=n,0===i&&e._state&&E(g,e)}function g(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,o=void 0,i=e._result,s=0;s<t.length;s+=3)n=t[s],o=t[s+r],n?v(r,n,o,i):o(i);e._subscribers.length=0}}function m(){this.error=null}function v(t,r,n,o){var i=e(n),s=void 0,a=void 0,c=void 0,u=void 0;if(i){if((s=function(e,t){try{return e(t)}catch(e){return j.error=e,j}}(n,o))===j?(u=!0,a=s.error,s=null):c=!0,r===s)return void f(r,new TypeError("A promises callback cannot return that same promise."))}else s=o,c=!0;r._state!==D||(i&&c?p(r,s):u?f(r,a):t===U?h(r,s):t===q&&f(r,s))}function T(e){e[x]=B++,e._state=void 0,e._result=void 0,e._subscribers=[]}function b(e,t){this._instanceConstructor=e,this.promise=new e(c),this.promise[x]||T(this.promise),R(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?h(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&h(this.promise,this._result))):f(this.promise,new Error("Array Methods must be provided an Array"))}function _(e){this[x]=B++,this._result=this._state=void 0,this._subscribers=[],c!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof _?function(e,t){try{t((function(t){p(e,t)}),(function(t){f(e,t)}))}catch(t){f(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}var R=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},w=0,O=void 0,C=void 0,E=function(e,t){I[w]=e,I[w+1]=t,2===(w+=2)&&(C?C(i):M())},P="undefined"!=typeof window?window:void 0,S=P||{},N=S.MutationObserver||S.WebKitMutationObserver,k="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),A="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,I=new Array(1e3),M=void 0;M=k?function(){return t.nextTick(i)}:N?function(){var e=0,t=new N(i),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}():A?function(){var e=new MessageChannel;return e.port1.onmessage=i,function(){return e.port2.postMessage(0)}}():void 0===P?function(){try{var e=r(21);return void 0!==(O=e.runOnLoop||e.runOnContext)?function(){O(i)}:o()}catch(e){return o()}}():o();var x=Math.random().toString(36).substring(16),D=void 0,U=1,q=2,L=new m,j=new m,B=0;return b.prototype._enumerate=function(){for(var e=this.length,t=this._input,r=0;this._state===D&&r<e;r++)this._eachEntry(t[r],r)},b.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===a){var o=u(e);if(o===s&&e._state!==D)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(r===_){var i=new r(c);l(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},b.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===D&&(this._remaining--,e===q?f(n,r):this._result[t]=r),0===this._remaining&&h(n,this._result)},b.prototype._willSettleAt=function(e,t){var r=this;y(e,void 0,(function(e){return r._settledAt(U,t,e)}),(function(e){return r._settledAt(q,t,e)}))},_.all=function(e){return new b(this,e).promise},_.race=function(e){var t=this;return new t(R(e)?function(r,n){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(r,n)}:function(e,t){return t(new TypeError("You must pass an array to race."))})},_.resolve=a,_.reject=function(e){var t=new this(c);return f(t,e),t},_._setScheduler=function(e){C=e},_._setAsap=function(e){E=e},_._asap=E,_.prototype={constructor:_,then:s,catch:function(e){return this.then(null,e)}},_.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=_},_.Promise=_,_}))}).call(t,r(12),r(4))},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(e){if(u===setTimeout)return setTimeout(e,0);if((u===r||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function i(){f&&d&&(f=!1,d.length?h=d.concat(h):y=-1,h.length&&s())}function s(){if(!f){var e=o(i);f=!0;for(var t=h.length;t;){for(d=h,h=[];++y<t;)d&&d[y].run();y=-1,t=h.length}d=null,f=!1,function(e){if(l===clearTimeout)return clearTimeout(e);if((l===n||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}(e)}}function a(e,t){this.fun=e,this.array=t}function c(){}var u,l,p=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:r}catch(e){u=r}try{l="function"==typeof clearTimeout?clearTimeout:n}catch(e){l=n}}();var d,h=[],f=!1,y=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];h.push(new a(e,t)),1!==h.length||f||o(s)},a.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.prependListener=c,p.prependOnceListener=c,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(3),i=r(2),s=r(0);t.ResponseData=function(e){this.id=e,this.status=200,this.headers={},this.body=""},function(e){e.Connected="trouter_js_client_connected",e.Disconnected="trouter_js_client_disconnected",e.Error="trouter_js_client_error",e.Progress="trouter_js_client_progress",e.Response="trouter_js_client_response",e.Request="trouter_js_client_request",e.CheckConnection="trouter_js_client_check_connection",e.Registration="trouter_js_client_registration",e.Unregistration="trouter_js_client_unregistration"}(n=t.ClientEventName||(t.ClientEventName={}));var a=function(e,t,r,n,o){this.stepName=e,this.operation=t,this.delta=r,this.ts=n,this.error=o};t.TrackerStep=a;t.Properties=function(){};var c=function(){this.numberOfPingReplies=0,this.connectedTimestamp=0,this.isNewUrl=!1,this.transportType="",this.connectionNumber=0},u=function(){this.enabled=!1,this.numberOfStepsToMaintain=40,this.logHealthCheckError=!1,this.sendProgressTimeoutSecs=55,this.logSendPingError=!1,this.maxBackoffInMs=12e4,this.trouter_js_client_connected=!1,this.trouter_js_client_disconnected=!1,this.trouter_js_client_error=!1,this.trouter_js_client_progress=!1,this.trouter_js_client_response=!1,this.trouter_js_client_request=!1,this.trouter_js_client_registration=!1,this.trouter_js_client_unregistration=!1,this.trouter_js_client_check_connection=!0},l=function(){function e(e,t,r,n,i,a,l){this.clientId=t,this.clientInfo=r,this.getServerState=n,this.endpointId=i,this.clientCorrelationID=a,this.environment=l,this.logger=new s.Logger("ConnectionTracker",e),this.clientCorrelationID=void 0!==a?a:"",this.steps=[],this.connectionAttempt=0,this.totalStepCount=0,this.beginTimestamp=new o.Timespan,this.eventLogSettings=new u,this.connectedInfo=new c}return e.prototype.enable=function(e){this.eventLogSettings.enabled=!0,this.eventLogger=e},e.prototype.disable=function(){this.eventLogSettings.enabled=!1},e.prototype.sendProgress=function(e){this.steps.length>0&&this.sendTelemetry(n.Progress,e,this.steps)},e.prototype.cancelProgressTimer=function(){void 0!==this.progressTimeout&&(clearTimeout(this.progressTimeout),this.progressTimeout=void 0)},e.prototype.resetProgressSendTimer=function(){var e=this;this.cancelProgressTimer(),void 0!==this.eventLogSettings.sendProgressTimeoutSecs&&this.eventLogSettings.sendProgressTimeoutSecs>0&&(this.progressTimeout=setTimeout((function(){e.sendProgress({reason:"timeout",timeoutSecs:e.eventLogSettings.sendProgressTimeoutSecs})}),1e3*this.eventLogSettings.sendProgressTimeoutSecs))},e.prototype.setConnectedInfo=function(e,t){this.connectedInfo.numberOfPingReplies=0,this.connectedInfo.connectedTimestamp=Date.now(),this.connectedInfo.isNewUrl=e,this.connectedInfo.transportType=t,++this.connectedInfo.connectionNumber},e.prototype.clearConnectedInfo=function(){this.connectedInfo.numberOfPingReplies=0,this.connectedInfo.connectedTimestamp=0,this.connectedInfo.isNewUrl=!0,this.connectedInfo.transportType=""},e.prototype.copyProperties=function(e,t){for(var r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];t.hasOwnProperty(o)&&void 0!==t[o]&&(e[o.replace(/-/g,"_")]={value:t[o]})}},e.prototype.increasePingResponseCount=function(){++this.connectedInfo.numberOfPingReplies},e.prototype.sendTelemetry=function(e,t,r){try{if(!0===this.eventLogSettings.enabled&&!0===this.eventLogSettings[e]&&void 0!==this.eventLogger){var n=this.getServerState(),s={name:e,properties:{connectionAttempt:{value:this.connectionAttempt},epid:{value:this.endpointId},clientCorrelationID:{value:this.clientCorrelationID},steps:{value:o.toJson(r)},clientID:{value:this.clientId},eventVersion:{value:3},environment:{value:this.environment},cv:{value:i.CLIENT_VERSION},ua:{value:this.clientInfo.ua},connectionId:{value:n.connectionId},connectedClientId:{value:n.connectedClientId},domId:{value:n.domId},url:{value:n.unsecureUrl},surl:{value:n.url},ttlInSecs:{value:n.getRemainingTtlInSec()},numberOfPingReplies:{value:this.connectedInfo.numberOfPingReplies},connectedTimestamp:{value:this.connectedInfo.connectedTimestamp},isNewUrl:{value:this.connectedInfo.isNewUrl},transportType:{value:this.connectedInfo.transportType},connectionNumber:{value:this.connectedInfo.connectionNumber}}};this.copyProperties(s.properties,t),this.eventLogger.logEvent(s)}}catch(t){this.logger.warn("error in sending event "+e+": "+o.toJson(t))}},e.prototype.createStep=function(e,t,r){return new a(e,t,this.beginTimestamp.duration,Date.now(),r)},e.prototype.addStep=function(e,t,r){if(!1!==this.eventLogSettings.enabled&&(0===this.steps.length&&this.beginTimestamp.reset(),this.steps.push(this.createStep(e,t,r)),++this.totalStepCount,void 0!==this.eventLogSettings.numberOfStepsToMaintain&&this.steps.length>this.eventLogSettings.numberOfStepsToMaintain)){var o=this.steps.slice(0);this.steps.length=0,this.sendTelemetry(n.Progress,{reason:"flush"},o)}},e.prototype.trackStart=function(e){this.addStep(e,"start")},e.prototype.trackEnd=function(e){this.addStep(e,"end")},e.prototype.trackError=function(e,t,r,o){void 0===r&&(r=!0),"health"===e&&!0!==this.eventLogSettings.logHealthCheckError||"ping"===e&&!1===this.eventLogSettings.logSendPingError||(void 0===o&&(o="error"),!0===r&&this.addStep(e,o,t),this.sendTelemetry(n.Error,{},[this.createStep(e,o,t)]))},e.prototype.trackProgress=function(e,t){this.addStep(e,t)},e.prototype.trackConnected=function(e,t){this.setConnectedInfo(e,t);var r=this.steps.slice(0),o=this.totalStepCount,i=this.beginTimestamp.duration;this.steps.length=0,this.totalStepCount=0,this.sendTelemetry(n.Connected,{stepCount:r.length,totalStepCount:o,connectionEstablishmentMs_Total:i},r),this.cancelProgressTimer()},e.prototype.trackDisconnected=function(e){e.sessionLengthMS=Date.now()-this.connectedInfo.connectedTimestamp,this.sendTelemetry(n.Disconnected,e,[]),this.resetProgressSendTimer()},e.prototype.trackNewConnection=function(){++this.connectionAttempt},e.prototype.trackRequest=function(e,t){var r={};void 0!==t&&(r.hasError=!0,r.error=t);try{if(e){r.requestID=e.id,r.httpMethod=e.method,r.url=e.url,r.bodyLength=e.body.length,r.shortUrl=e.shortUrl,r.requestTimeStamp=e.startTS,r.correlationVector=e.correlationVector;for(var i=e.headers,s=0,a=Object.keys(i);s<a.length;s++){var c=a[s];i.hasOwnProperty(c)&&(r[c]=i[c])}}}catch(e){r.hasError=!0,r.error=r.error+" error creating request context "+o.toJson(e)}this.sendTelemetry(n.Request,r,[])},e.prototype.trackResponse=function(e,t,r,i){var s={};void 0!==i&&(s.hasError=!0,s.error=i);try{if(s.responseTimestamp=void 0!==r?r.sentTS:Date.now(),e){s.requestID=e.id,s.httpMethod=e.method,s.shortUrl=e.shortUrl,s.correlationVector=e.correlationVector;for(var a=e.headers,c=0,u=Object.keys(a);c<u.length;c++){var l=u[c];a.hasOwnProperty(l)&&(s[l]=a[l])}}r&&(s.latencyMS=t,s.responseCode=r.status,s.responseLength=r.body.length)}catch(e){s.hasError=!0,s.error=s.error+" error creating response context "+o.toJson(e)}this.sendTelemetry(n.Response,s,[])},e.prototype.sendResponseError=function(e,t,r){this.trackResponse(t,void 0,r,e)},e.prototype.close=function(){this.sendProgress({reason:"closed"}),this.steps.length=0,this.cancelProgressTimer()},e.prototype.mergeSettings=function(e){if(e){this.eventLogSettings.numberOfStepsToMaintain=Math.min(40,Math.max(10,void 0!==e.numberOfStepsToMaintain?e.numberOfStepsToMaintain:0));var t=Math.min(3600,Math.max(55,void 0!==e.sendProgressTimeoutSecs?e.sendProgressTimeoutSecs:0));this.eventLogSettings.logHealthCheckError=e.logHealthCheckError,this.eventLogSettings.logSendPingError=e.logSendPingError;for(var r=0,o=Object.keys(n).map((function(e){return n[e]}));r<o.length;r++){var i=o[r];e.hasOwnProperty(i)&&void 0!==e[i]&&(this.eventLogSettings[i]=e[i])}this.eventLogSettings.sendProgressTimeoutSecs!==t&&(this.eventLogSettings.sendProgressTimeoutSecs=t,this.resetProgressSendTimer())}},e}();t.ConnectionTracker=l},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.logger=e,this.maxBackoffInMs=t,this.backoffId=0,this.backoffCount=0}return e.calculateNextBackoffMs=function(e,t){var r=1+.4*(Math.random()-.5),n=1e3*Math.pow(2,e)*r;return n=Math.round(n),Math.min(t,n)},e.prototype.setMaxBackoffMs=function(e){this.maxBackoffInMs=e},e.prototype.backoff=function(t,r){var n=this;void 0!==this.timerHandle&&(this.logger.debug("Clearing current back off"),clearTimeout(this.timerHandle),this.timerHandle=void 0);var o=e.calculateNextBackoffMs(this.backoffCount,this.maxBackoffInMs);this.backoffId++,this.backoffCount++,this.logger.info("Backing off "+t+" for "+o+" milliseconds with ID "+this.backoffId),this.timerHandle=setTimeout((function(){n.logger.info("Back off for "+t+" with ID "+n.backoffId+" complete, invoking handler"),n.timerHandle=void 0,r()}),o)},e.prototype.reset=function(){void 0!==this.timerHandle&&(this.logger.debug("Resetting back off"),clearTimeout(this.timerHandle),this.timerHandle=void 0),this.backoffCount=0},e}();t.ExponentialBackoff=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(20),o=r(11),i=r(3),s=r(14),a=r(2),c=r(15),u=r(1),l=r(5),p=r(0),d=r(17),h=r(10),f=function(){this.cv=a.CLIENT_VERSION,this.ua="",this.hr="",this.v=""},y=function(){this["force new connection"]=!0,this.reconnect=!1,this.query="",this.ackTimeoutMs=5e3},g="MS-CV",m=function(){function e(e){this.cvCounter=0;var t=JSON.parse(e);this.startTS=t.hasOwnProperty("startTS")?t.startTS:0,this.url=t.hasOwnProperty("url")?t.url:"",this.shortUrl=t.hasOwnProperty("shortUrl")?t.shortUrl:"",this.body=t.hasOwnProperty("body")?t.body:"",this.headers=t.hasOwnProperty("headers")?t.headers:{},this.id=t.hasOwnProperty("id")&&"number"==typeof t.id?t.id:-1,this.method=t.hasOwnProperty("method")?t.method:"",this.replied=!1,this.timedout=!1,this.timeoutTimerId=0,this.receivedCv=this.headers[g],this.updateCvHeader()}return Object.defineProperty(e.prototype,"correlationVector",{get:function(){return this.receivedCv?this.receivedCv+"."+this.cvCounter:""},enumerable:!0,configurable:!0}),e.prototype.on=function(e,t){"data"===e?this.dataCallback=t:"end"===e&&("function"==typeof this.dataCallback&&this.dataCallback(this.body),t())},e.prototype.incrementCorrelationVector=function(){++this.cvCounter,this.updateCvHeader()},e.prototype.updateCvHeader=function(){var e=this.correlationVector;e&&(this.headers[g]=e)},e}(),v=function(){function e(e,t,r){this.request=e,this.responseData=t,this.sendResponse=r}return e.prototype.writeHead=function(e,t){this.responseData.status=e,this.responseData.headers=t},e.prototype.write=function(e){this.responseData.body+=e},e.prototype.end=function(e){return e&&(this.responseData.body+=e),this.sendResponse(this.request,this.responseData)},e}(),T=function(e){this.name=e,this.args={},this.timeoutTimerId=0},b=function(){function e(e,t,r,o,i){var l=this;this.options=t,this.manager=r,this.tokenProvider=o,this.connectionId="",this.inIncallMode=!1,this.connectionAttempt=0,this.connectedClientId="",this.c2cUrlBase="",this.pendingTimers={},this.UNKNOWN_TRANSPORT="unknown_transport",this.logger=new p.Logger("Connection",e),this.timeoutOptions=this.options.timeoutOptions,this.healthBackoff=new c.ExponentialBackoff(this.logger,this.timeoutOptions.maxBackoffMs),this.tokenBackoff=new c.ExponentialBackoff(this.logger,this.timeoutOptions.maxBackoffMs),this.clientID=Date.now(),"undefined"!=typeof window&&window.location&&(this.domId=window.location.hostname),this.clientInfo=new f,this.clientInfo.cv=a.CLIENT_VERSION,this.clientInfo.ua="",this.options&&this.options.clientInfo&&(this.clientInfo.ua=this.safeString(this.options.clientInfo.ua),this.clientInfo.v=this.safeString(this.options.clientInfo.v)),this.connectionTracker=new s.ConnectionTracker(e,this.clientID,this.clientInfo,(function(){return l.getServerState()}),this.options.endpointId,this.options.clientCorrelationID,this.options.environment),this.applyConnectionTrackerOptions(t);var h=this.options.incallModeTimeoutMs>0;if(this.fsm=new d.TrouterFsm(e,this,h),t.registration){var y={registrarUrl:t.registration.registrarUrl,registrationId:t.registration.registrationId,requestTimeoutMs:t.timeoutOptions.fetchTimeoutMs,initialRetryDelayMs:1e3,maxRetryDelayMs:t.timeoutOptions.maxBackoffMs};this.registrarClient=n.createRegistrarClient(e,this.tokenProvider,y)}this.userActivityState=i||u.UserActivityState.Unknown}return e.prototype.start=function(){this.logger.info("Starting"),this.fsm.start()},e.prototype.stop=function(e){this.logger.info("Stopping"),this.connectionTracker.close(),this.fsm.stop(e)},e.prototype.configure=function(e){var t=this.options.trouterUrl!==e.trouterUrl;this.options=e,this.applyConnectionTrackerOptions(e),t&&this.onTrouterReconnect()},e.prototype.checkConnection=function(e){this.logger.info("checkConnection called with "+e),this.fsm.checkConnection(e),e&&this.connectionTracker.sendTelemetry(s.ClientEventName.CheckConnection,{disconnectDetected:e},[])},e.prototype.getServerState=function(){return new l.ServerState(this.connectionId,this.connectedClientId,this.domId?this.domId:"",this.allocateResult?this.allocateResult.url:"",this.allocateResult?this.allocateResult.surl:"",this.c2cUrlBase,this.connectionExpireTimestampInSecs)},e.prototype.getUserActivityState=function(){return this.userActivityState},e.prototype.getToken=function(e,t){var r=this;this.logger.info("Getting token "+(t?"with backoff":"without backoff"));var n=function(){r.connectionTracker.trackStart("token"),r.tokenProvider(!e).then((function(e){r.logger.debug("token is received"),r.connectionTracker.trackEnd("token"),r.fsm.onTokenReceived(e)})).catch((function(t){var n=i.toJson(t.stack);r.logger.error("Getting token failed, will retry after timeout. Error: "+n),r.connectionTracker.trackError("token",n),r.getToken(e,!0)}))};t?this.tokenBackoff.backoff("getting token",n):(this.tokenBackoff.reset(),n())},e.prototype.startConnectionTimer=function(){var e=this;this.stopConnectionTimer(),this.logger.debug("Starting connection timeout for "+this.timeoutOptions.connectionTimeoutMs+" ms"),this.connectionTimeoutId=setTimeout((function(){e.logger.info("Connection timeout is fired"),e.fsm.onConnectingTimeout()}),this.timeoutOptions.connectionTimeoutMs)},e.prototype.stopConnectionTimer=function(){this.connectionTimeoutId&&(this.logger.debug("Stopping connection timeout"),clearTimeout(this.connectionTimeoutId),this.connectionTimeoutId=void 0)},e.prototype.startPingTimer=function(){var e=this;"websocket"===this.transportTypeName?(this.logger.debug("Starting ping timeout for "+this.timeoutOptions.pingTimeoutMs+" ms"),this.pingTimerId=setInterval((function(){e.logger.info("Ping interval fired"),e.fsm.onPingInterval()}),this.timeoutOptions.pingTimeoutMs)):this.logger.debug("Not starting ping for transport "+this.transportTypeName)},e.prototype.stopPingTimer=function(){this.pingTimerId&&(this.logger.debug("Stopping ping timeout"),this.clearPingResponseTimer(),clearInterval(this.pingTimerId),this.pingTimerId=void 0)},e.prototype.shouldSkipRegistration=function(){return void 0===this.options.registration},e.prototype.hasCustomRegisterTtl=function(){return this.options.registration&&this.options.registration.registrarTtlSec},e.prototype.startRegisterTimer=function(){var e=this;if(void 0===this.registrationTimerId){var t=this.getRegistrationTtl()-30;this.logger.debug("Starting registration timeout for "+t+" sec"),this.registrationTimerId=setTimeout((function(){e.logger.info("Registration timeout is fired"),e.registrationTimerId=void 0,e.fsm.onRegistrationTimeout()}),1e3*t)}else this.logger.error("Another registration timer is set - don't create another one")},e.prototype.stopRegisterTimer=function(){this.registrationTimerId&&(this.logger.debug("Stopping registration timeout"),clearTimeout(this.registrationTimerId),this.registrationTimerId=void 0)},e.prototype.resendRegistration=function(){if(!this.registrarClient)throw new Error("Trouter Client not configured to handle registrations");return this.registrarClient.resendRegistration()},e.prototype.buildSocketIoUrlParams=function(){if(!this.allocateResult)throw new Error("Allocate result is undefined in buildSocketIoUrlParams()");var e={};if(this.allocateResult.connectparams)for(var t=this.allocateResult.connectparams,r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];t.hasOwnProperty(o)&&void 0!==t[o]&&(e[o]=t[o])}return e.v="v4",e.tc=encodeURI(i.toJson(this.clientInfo)),e.timeout=this.timeoutOptions.pingTimeoutMs/1e3,e.auth="true",this.options.endpointId&&(e.epid=this.options.endpointId),this.userActivityState!==u.UserActivityState.Unknown&&(e.userActivity=encodeURI(i.toJson(this.createUserActivityObject(this.userActivityState)))),this.appendConnectedClientIds(this.buildQuery(e),!0)},e.prototype.startSocketIo=function(){var e=this;if(this.logger.info("Starting socket io"),this.connectionTracker.trackStart("connectSocket"),!this.allocateResult)throw new Error("Allocate result is undefined in startSocketIo()");var t=this.options.ioOptions||new y;if(t["force new connection"]=!0,t.reconnect=!1,t.query=this.buildSocketIoUrlParams(),this.logger.info("connecting to "+this.allocateResult.socketio+"?"+t.query),this.stopSocketIo(),this.socket=(this.options.io||h).connect(this.allocateResult.socketio,t),void 0===this.socket)throw new Error("Can't create Socket.io object");this.socket.on("connecting",(function(t){e.onSocketConnecting(t)})),this.socket.on("connect",(function(){e.onSocketConnect()})),this.socket.on("connect_failed",(function(t){e.onSocketConnectFailed(t)})),this.socket.on("disconnect",(function(){e.onSocketDisconnect()})),this.socket.on("reconnect",(function(){e.onSocketReconnect()})),this.socket.on("reconnect_failed",(function(t){e.onSocketReconnectFailed(t)})),this.socket.on("reconnecting",(function(){e.onSocketReconnecting()})),this.socket.on("error",(function(t){e.onSocketError(t)})),this.socket.on("message",(function(t){e.onSocketMessage(t)})),this.socket.on("trouter.connected",(function(t){e.onTrouterConnected(t)})),this.socket.on("trouter.reconnect",(function(){e.onTrouterReconnect()})),this.socket.on("trouter.message_loss",(function(t){e.onTrouterMessageLoss(t)}))},e.prototype.stopSocketIo=function(){if(this.socket){this.logger.info("clearing socket.io");try{for(var e=0,t=["connecting","connect","connect_failed","disconnect","reconnect","reconnect_failed","reconnecting","error","message","trouter.connected","trouter.reconnect","trouter.message_loss"];e<t.length;e++){var r=t[e];this.socket.removeAllListeners(r)}this.socket.disconnect(),this.logger.debug("cleared socket"),this.socket=void 0}catch(e){this.logger.error("exception in disconnecting previous socket. Error: "+i.toJson(e.stack))}}},e.prototype.dispatchConnected=function(){this.logger.info("dispatching connected"),this.manager.onConnected(this)},e.prototype.dispatchRegistered=function(){this.logger.info("dispatching connected"),this.manager.onRegistered(this)},e.prototype.dispatchDownstreamRequest=function(e){var t=this;this.logger.info("dispatching downstream request");try{var r=new v(e,new s.ResponseData(e.id),(function(e,r){return t.logger.info("sending response to downstream"),t.sendResponse(e,r)}));this.manager.onDownstreamRequest(this,e,r)}catch(e){this.logger.error("exception in socket.on message. Error : "+i.toJson(e.stack))}},e.prototype.dispatchReconnecting=function(){this.logger.info("dispatching reconnecting"),this.manager.onReconnecting(this)},e.prototype.dispatchReconnectIsRequired=function(){this.logger.info("dispatching reconnect is required by server"),this.manager.onReconnectIsRequired(this)},e.prototype.dispatchDisconnected=function(){this.logger.info("dispatching disconnected"),this.manager.onDisconnected(this)},e.prototype.dispatchTrouterMessageLost=function(e){this.logger.info("dispatching trouter lost message"),this.manager.onTrouterMessageLost(e)},e.prototype.sendProcessedDroppedIndicators=function(e){var t=this;try{this.logger.info("emitting processed flow tags to the server");var r=new T("trouter.processed_message_loss");r.args={droppedIndicators:e},this.sendDownstreamEvent(r,(function(){t.logger.info("emitted processed flow tags to the server")}))}catch(e){var n=i.toJson(e.stack);this.logger.error("unable to send processed message loss event. Error: "+n),this.connectionTracker.trackError("trouter.processed_message_loss",n,!1)}},e.prototype.resetAllocationConnectionParams=function(){this.allocateResult&&(this.logger.info("Resetting allocation connection parameters"),this.allocateResult.connectparams=void 0)},e.prototype.sendAllocateRequest=function(e){var t=this;this.connectionAttempt++,this.connectionTracker.trackNewConnection();var r=this.appendCorrelationIds(this.options.trouterUrl,!1);this.allocateResult&&this.allocateResult.connectparams&&(r+="&"+this.buildQuery(this.allocateResult.connectparams),this.allocateResult.connectparams.v||(r+="&v=v4"));var n=new Request(r,{method:"POST",mode:"cors",headers:new Headers({"X-Skypetoken":e,"Content-Type":"text/plain"})});this.logger.info("sendAllocateRequest: POST "+r),this.connectionTracker.trackStart("allocation");var o=-1;this.fetchWithTimeout(n,this.timeoutOptions.fetchTimeoutMs).then((function(e){if(o=e.status,!e.ok)throw new Error(e.statusText);var r=e.headers.get("content-type");if(!r||"application/json"!==r&&"application/json;"!==r.substring(0,17))throw new Error("Content-type '"+r+"' is unexpected");return t.connectionTracker.trackEnd("allocation"),e.json()})).then((function(e){t.onAllocationResponse(e)})).catch((function(e){var r=e+", status code "+o;t.logger.error("Allocation request failed. Error: "+r),t.connectionTracker.trackError("allocation",r),t.fsm.onAllocationFailed(401===o)}))},e.prototype.sendPingRequest=function(){var e=this;if(this.socket&&void 0===this.pingResponseTimerId)try{this.logger.info("emitting ping event"),this.socket.emit("ping",(function(){e.onPingResponse()})),this.pingResponseTimerId=setTimeout((function(){e.logger.error("Ping response timeout is fired"),e.clearPingResponseTimer(),e.fsm.onPingResponseTimeout()}),this.timeoutOptions.pongTimeoutMs)}catch(e){var t=i.toJson(e.stack);this.logger.error("unable to send ping. Error: "+t),this.connectionTracker.trackError("ping",t,!1)}},e.prototype.setUserActivityState=function(e){var t=e!==this.userActivityState;this.userActivityState=e,this.fsm.onSetUserActivityState(e,t)},e.prototype.sendUserActivityState=function(e,t){this.userActivityState!==u.UserActivityState.Unknown&&("websocket"===this.transportTypeName&&t?e===l.UserActivityEventReason.Connected?this.sendUserActivityStateMultiple(2):this.sendUserActivityStateMultiple(1):"xhr-polling"===this.transportTypeName&&e===l.UserActivityEventReason.Modified&&this.fsm.forceReconnect())},e.prototype.sendRegisterRequest=function(){var e=this;if(!this.options.registration||!this.registrarClient)throw new Error("Internal error - options.registration is undefined");if(!this.allocateResult)throw new Error("Allocate result is undefined in sendRegisterRequest()");this.logger.info("sending register request");var t=new i.Timespan;this.connectionTracker.trackStart("registration"),this.registrarClient.register({appId:this.options.registration.pnhAppId,aesKey:"",languageId:"en-US",platform:this.options.registration.platform,templateKey:this.options.registration.pnhTemplateKey,platformUIVersion:this.options.registration.platformUIVersion,productContext:this.options.registration.productContext},{TROUTER:[{context:this.options.registration.context,path:this.allocateResult.surl,ttl:this.getRegistrationTtl()}]}).then((function(){e.logger.info("Register request successful"),e.connectionTracker.trackEnd("registration"),e.fsm.onRegistrationSucceed(),e.connectionTracker.sendTelemetry(s.ClientEventName.Registration,{duration:t.duration},[])})).catch((function(r){e.logger.error("Register request failed. Error: "+r),e.connectionTracker.trackError("registration",r.message),e.connectionTracker.sendTelemetry(s.ClientEventName.Registration,{duration:t.duration},[])}))},e.prototype.sendUnregisterRequest=function(){var e=this;this.logger.info("sending unregister request");var t=new i.Timespan;if(!this.options.registration||!this.registrarClient)throw new Error("Internal error - options.registration is undefined");this.connectionTracker.trackStart("unregistration"),this.registrarClient.unregister().then((function(){e.logger.info("Unregister request successful"),e.connectionTracker.trackEnd("unregistration"),e.fsm.onUnregistrationSucceed(),e.connectionTracker.sendTelemetry(s.ClientEventName.Unregistration,{duration:t.duration},[])})).catch((function(r){e.logger.error("Unregister request failed. Error: "+r),e.connectionTracker.trackError("unregistration",r.message),e.fsm.onUnregistrationFailed(!1),e.connectionTracker.sendTelemetry(s.ClientEventName.Unregistration,{duration:t.duration},[])}))},e.prototype.fetchWithTimeout=function(e,t){return new o.Promise((function(r,n){fetch(e).then(r).catch(n),0!==t&&setTimeout(n,t,new Error("Fetch for '"+e.url+"' timed out"))}))},e.prototype.resetTokenBackoff=function(){this.tokenBackoff.reset()},e.prototype.resetRegisterBackoff=function(){this.registrarClient&&this.registrarClient.cancelPendingRequests()},e.prototype.clearTimers=function(){this.logger.debug("Clearing all pending downstream events related timers");for(var e=0,t=Object.keys(this.pendingTimers);e<t.length;e++){var r=t[e];this.clearTimer(Number(r))}},e.prototype.restartIncallModeTimer=function(){var e=this;this.clearIncallModeTimerId(),this.logger.debug("Restarting incall mode timer"),this.incallModeTimerId=setTimeout((function(){e.logger.info("Call mode timer fired"),e.fsm.onIncallModeTimer()}),this.options.incallModeTimeoutMs)},e.prototype.enterIncallMode=function(){this.logger.info("Entering incall mode"),this.timeoutOptions=this.options.incallTimeoutOptions,this.healthBackoff.setMaxBackoffMs(this.timeoutOptions.maxBackoffMs),this.tokenBackoff.setMaxBackoffMs(this.timeoutOptions.maxBackoffMs),this.inIncallMode=!0},e.prototype.exitIncallMode=function(){this.logger.info("Exiting incall mode"),this.clearIncallModeTimerId(),this.timeoutOptions=this.options.timeoutOptions,this.healthBackoff.setMaxBackoffMs(this.timeoutOptions.maxBackoffMs),this.tokenBackoff.setMaxBackoffMs(this.timeoutOptions.maxBackoffMs),this.inIncallMode=!1},e.prototype.isIncallMode=function(){return this.inIncallMode},e.prototype.onSocketConnecting=function(e){this.logger.info("onSocketConnecting("+e+")"),this.transportTypeName=e,this.connectionTracker.trackProgress("connecting",this.transportTypeName),this.fsm.onConnecting()},e.prototype.onSocketConnect=function(){this.logger.info("onSocketConnect")},e.prototype.onSocketConnectFailed=function(e){this.logger.error("onSocketConnectFailed"),this.connectionTracker.trackError("connect_failed",e,!0,this.transportTypeName?this.transportTypeName:this.UNKNOWN_TRANSPORT),this.fsm.onConnectingFailed()},e.prototype.onSocketDisconnect=function(){this.logger.error("onSocketDisconnect"),this.connectionTracker.trackDisconnected({serverClosed:!this.fsm.isActive()}),this.connectionTracker.clearConnectedInfo(),this.fsm.onSocketError(void 0),this.connectionExpireTimestampInSecs=void 0},e.prototype.onSocketReconnect=function(){this.logger.error("onSocketReconnect"),this.fsm.onTrouterConnected()},e.prototype.onSocketReconnectFailed=function(e){this.logger.error("onSocketReconnectFailed with '"+e+"'"),this.fsm.onSocketError("string"==typeof e?e:void 0)},e.prototype.onSocketReconnecting=function(){this.logger.error("onSocketReconnecting")},e.prototype.onSocketError=function(e){this.logger.error("onSocketError with '"+i.toJson(e)+"'"),this.connectionTracker.trackError("connectSocket",e),this.fsm.onSocketError("string"==typeof e?e:void 0)},e.prototype.onSocketMessage=function(e){var t,r=this;this.logger.info("onSocketMessage");try{var n=(t=new m(e)).headers&&t.headers["X-Microsoft-Skype-Chain-ID"],o=n?" Chain-Id "+n:"";this.logger.info("Received request N "+t.id+o+" CV "+t.correlationVector+" to '"+t.url+"'"),t.startTS=Date.now(),t.url&&this.urlPath&&0===t.url.indexOf(this.urlPath)&&(t.shortUrl=t.url.substring(this.urlPath.length))}catch(e){var a=i.toJson(e.stack);return this.logger.error("unable to parse request. Error: "+a),this.connectionTracker.trackRequest(void 0,a),void this.connectionTracker.sendResponseError("unable to parse request, error: "+e)}t.timeoutTimerId=setTimeout((function(){if(!t.replied){r.logger.error("Request "+t.id+" timed out");var e=new s.ResponseData(t.id);e.status=504,e.headers={"Trouter-Responder":"ClientLib"},r.sendResponse(t,e),t.timedout=!0}}),this.timeoutOptions.requestTimeoutMs);try{this.connectionTracker.trackRequest(t),this.fsm.onDownstreamRequest(t)}catch(e){this.logger.error("exception in socket.on message. Error: "+i.toJson(e.stack)),this.connectionTracker.sendResponseError(e.message,t,void 0)}},e.prototype.onTrouterConnected=function(e){if(this.allocateResult){this.logger.info("onTrouterConnected: "+this.allocateResult.url),this.socket&&this.socket.socket&&this.socket.socket.options&&this.socket.socket.options.query&&(this.socket.socket.options.query+="&connected=true"),this.urlPath=this.allocateResult.url.replace(/https?:\/\/([A-z0-9\:\$\-\_\.\+\!\*\"\(\)\,]*)\//,"/");var t=this.connectedUrl!==this.allocateResult.url;this.connectedUrl=this.allocateResult.url,this.connectionExpireTimestampInSecs=i.calculateExpireTsInSec(e.ttl),this.connectionTracker.trackEnd("connectSocket"),this.connectionTracker.trackConnected(t,this.transportTypeName?this.transportTypeName:this.UNKNOWN_TRANSPORT),this.fsm.onTrouterConnected()}else this.logger.error("Invalid internal state - received onTrouterConnected while allocateResult is not set")},e.prototype.onTrouterReconnect=function(){this.logger.info("onTrouterReconnect"),this.fsm.onReconnectRequired()},e.prototype.onTrouterMessageLoss=function(e){this.logger.info("onTrouterMessageLoss"),this.fsm.onTrouterMessageLost(e.droppedIndicators)},e.prototype.onAllocationResponse=function(e){this.logger.info("Received allocation response "+JSON.stringify(e)),this.allocateResult=e;var t=+e.ttl;if(this.connectionExpireTimestampInSecs=i.calculateExpireTsInSec(t),this.connectionId=this.allocateResult.id||"",this.connectedClientId=this.allocateResult.ccid,this.logger.info("connected client id set {connectedClientId:"+this.connectedClientId+"}"),this.c2cUrlBase=e.curlb||"",""===this.c2cUrlBase){var r=e.surl.indexOf("://");r>=0&&(r=e.surl.indexOf("/",r+3))>=5&&":3443"===e.surl.substr(r-5,5)&&(this.c2cUrlBase=e.surl.substr(0,r-5))}this.fsm.onAllocationSucceed()},e.prototype.onPingResponse=function(){this.logger.info("onPingResponse"),this.connectionTracker.increasePingResponseCount(),this.clearPingResponseTimer(),this.fsm.onPingResponse()},e.prototype.clearPingResponseTimer=function(){void 0!==this.pingResponseTimerId&&(clearTimeout(this.pingResponseTimerId),this.pingResponseTimerId=void 0)},e.prototype.buildQuery=function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var o=n[r];e.hasOwnProperty(o)&&void 0!==e[o]&&t.push(o+"="+e[o])}return t.join("&")},e.prototype.appendConnectedClientIds=function(e,t){var r="";e.indexOf("ccid=")<0&&(r="ccid="+this.connectedClientId+"&"),this.domId&&(r+="dom="+this.domId+"&"),r.length>0&&(r=r.slice(0,-1));var n=t||-1!==e.indexOf("?")?"&":"?";return this.appendCorrelationIds(e+n+r,t)},e.prototype.appendCorrelationIds=function(e,t){var r=t||-1!==e.indexOf("?")?"&":"?";return e.indexOf("cor_id")<0?""+e+r+"cor_id="+this.options.clientCorrelationID+"&con_num="+this.clientID+"_"+this.connectionAttempt:e},e.prototype.getHealthUrl=function(e){return e.substring(0,e.lastIndexOf("/a"))+"/h"},e.prototype.safeString=function(e){return"string"==typeof e?e:""},e.prototype.sendResponse=function(e,t){if(e.timedout)return this.logger.error("Request "+e.id+" already timed out"),1;if(e.replied)return this.logger.error("Response for request "+e.id+" already sent"),2;clearTimeout(e.timeoutTimerId),e.timeoutTimerId=0,e.replied=!0,t.headers=t.headers||{};var r=e.correlationVector;this.logger.info("Sending response for request N "+e.id+" CV "+r+" with status "+t.status),r&&(t.headers[g]=r),e.headers&&e.headers["trouter-request"]&&!t.headers["trouter-request"]&&(t.headers["trouter-request"]=e.headers["trouter-request"]);var n=Date.now()-e.startTS;if(t.headers["trouter-client"]=i.toJson({cd:n}),this.logger.debug("response: "+i.toJson(t)),!this.socket)return this.connectionTracker.sendResponseError("no socket",e,t),4;try{return this.socket.send(i.toJson(t)),t.sentTS=Date.now(),e.incrementCorrelationVector(),this.connectionTracker.trackResponse(e,n,t),"websocket"===this.transportTypeName&&this.sendPingRequest(),0}catch(r){var o="unable to send data on response.end. Error: "+i.toJson(r.stack);return this.logger.error(o),this.connectionTracker.sendResponseError(o,e,t),4}},e.prototype.sendUserActivityStateMultiple=function(e){var t=this,r=new T("user.activity");r.args=this.createUserActivityObject(this.userActivityState),this.logger.debug("Sending user activity '"+u.UserActivityState[this.userActivityState]+"', remaining "+(e-1)),this.sendDownstreamEvent(r,(function(){if(t.onDownstreamEventResponse(r),t.clearTimer(r.timeoutTimerId),e>1){var n=setTimeout((function(){t.clearTimer(n),t.sendUserActivityStateMultiple(e-1)}),t.options.userActivitySecondResendDelayMs);t.registerTimer(n,"user.activity/resend")}})),r.timeoutTimerId=setTimeout((function(){t.logger.error("Activity state response timeout is fired"),t.fsm.onActivityStateResponseTimeout(),t.clearTimer(r.timeoutTimerId)}),this.timeoutOptions.userActivityResponseTimeoutMs),this.registerTimer(r.timeoutTimerId,"user.activity/response")},e.prototype.sendDownstreamEvent=function(e,t){this.logger.info("Sending downstream event "+e.name),this.socket&&this.socket.emit(e.name,e.args,t)},e.prototype.onDownstreamEventResponse=function(e){this.logger.info("onDownstreamEventResponse("+e.name+")")},e.prototype.registerTimer=function(e,t){this.logger.debug("registering timer "+e+" -> "+t),this.pendingTimers[e]=t},e.prototype.clearTimer=function(e){var t=this.pendingTimers[e];this.logger.debug("clearing timer "+e+" -> "+t),delete this.pendingTimers[e],clearTimeout(e)},e.prototype.getRegistrationTtl=function(){var e=i.calculateTtlInSec(this.connectionExpireTimestampInSecs);return this.logger.debug("Current connectionID will expire in "+e+" seconds"),this.options.registration&&this.options.registration.registrarTtlSec&&e>0?Math.min(this.options.registration.registrarTtlSec,e):this.options.registration&&this.options.registration.registrarTtlSec?this.options.registration.registrarTtlSec:e>0?e:3600},e.prototype.clearIncallModeTimerId=function(){void 0!==this.incallModeTimerId&&(this.logger.debug("Clearing in-call mode timer"),clearTimeout(this.incallModeTimerId),this.incallModeTimerId=void 0)},e.prototype.applyConnectionTrackerOptions=function(e){try{e.eventLogger&&"function"==typeof e.eventLogger.logEvent?(this.connectionTracker.mergeSettings(e.telemetrySettings),this.connectionTracker.enable(e.eventLogger)):this.logger.warn("Trouter client event logging disabled due to invalid configuration.")}catch(e){this.logger.warn("Trouter client event logging disabled. Error: "+i.toJson(e.stack)),this.connectionTracker.disable()}},e.prototype.createUserActivityObject=function(e){var t;switch(e){case u.UserActivityState.Active:t="active";break;case u.UserActivityState.Inactive:t="inactive";break;case u.UserActivityState.Unknown:t="unknown";break;default:t="undefined"}return{state:t}},e}();t.TrouterConnection=b},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,o,i=r(1),s=r(5),a=r(0);!function(e){e[e.Initial=0]="Initial",e[e.RetrievingToken=1]="RetrievingToken",e[e.Allocating=2]="Allocating",e[e.Handshaking=3]="Handshaking",e[e.Connecting=4]="Connecting",e[e.Connected=5]="Connected",e[e.UnregisteringRetrievingToken=6]="UnregisteringRetrievingToken",e[e.Unregistering=7]="Unregistering"}(n=t.State||(t.State={})),function(e){e[e.Initial=0]="Initial",e[e.RetrievingToken=1]="RetrievingToken",e[e.Registering=2]="Registering",e[e.Registered=3]="Registered",e[e.NotRegistered=4]="NotRegistered"}(o||(o={}));var c=function(){function e(e,t,r){this.worker=t,this.incallModeEnabled=r,this.state=n.Initial,this.connectionErrors=0,this.logger=new a.Logger("ConnectionFsm",e),this.connectedSubstate=o.Initial,this.userActivityState=i.UserActivityState.Unknown}return e.prototype.getState=function(){return this.state},e.prototype.isActive=function(){return this.state===n.Allocating||this.state===n.Connected||this.state===n.Handshaking||this.state===n.Connecting||this.state===n.RetrievingToken},e.prototype.start=function(){return this.state===n.Initial?(this.setState(n.RetrievingToken),this.worker.getToken(!0,!1),!0):(this.showIgnored("start"),!1)},e.prototype.stop=function(e){e&&(this.connectedSubstate=o.Initial),this.worker.isIncallMode()&&this.worker.exitIncallMode(),this.worker.resetTokenBackoff(),this.worker.resetRegisterBackoff(),this.worker.stopConnectionTimer(),this.worker.stopPingTimer(),this.worker.clearTimers(),this.state!==n.Connecting&&this.state!==n.Handshaking&&this.state!==n.Connected||this.worker.stopSocketIo(),this.isRegistered()?(this.setState(n.UnregisteringRetrievingToken),this.worker.stopRegisterTimer(),this.worker.getToken(!0,!1)):(this.setState(n.Initial),this.worker.dispatchDisconnected())},e.prototype.onTokenReceived=function(e){this.state===n.RetrievingToken?(this.setState(n.Allocating),this.worker.startConnectionTimer(),this.worker.sendAllocateRequest(e)):this.state===n.Connected&&this.connectedSubstate===o.RetrievingToken?(this.connectedSubstate=o.Registering,this.worker.sendRegisterRequest()):this.state===n.UnregisteringRetrievingToken?(this.setState(n.Unregistering),this.worker.sendUnregisterRequest()):this.showIgnored("onTokenReceived")},e.prototype.checkConnection=function(e){e&&this.onPingInterval()},e.prototype.onAllocationSucceed=function(){return this.state===n.Allocating?(this.setState(n.Handshaking),this.connectedSubstate=o.Initial,this.worker.startSocketIo(),!0):(this.showIgnored("onAllocationSucceed"),!1)},e.prototype.onAllocationFailed=function(e){this.state===n.Allocating?(this.setState(n.RetrievingToken),this.worker.stopConnectionTimer(),this.worker.getToken(!e,!0)):this.showIgnored("onAllocationFailed")},e.prototype.onConnectingTimeout=function(){this.state===n.Allocating||this.state===n.Connecting||this.state===n.Handshaking?(this.setState(n.RetrievingToken),this.resetAllocationIfNecessary(void 0),this.worker.stopSocketIo(),this.worker.getToken(!0,!1)):this.showIgnored("onConnectingTimeout")},e.prototype.onConnecting=function(){this.state===n.Handshaking?this.setState(n.Connecting):this.showIgnored("onConnecting")},e.prototype.onConnectingFailed=function(){this.state===n.Connecting?this.onConnectingTimeout():this.state===n.Handshaking?(this.logger.error("Unexpected error in Socket.io - no valid transports"),this.onConnectingTimeout()):this.showIgnored("onConnectingFailed")},e.prototype.onSocketError=function(e){this.state===n.Handshaking||this.state===n.Connected?(this.worker.stopSocketIo(),this.worker.stopPingTimer(),this.worker.clearTimers(),this.worker.stopConnectionTimer(),this.state!==n.Connected&&this.worker.resetAllocationConnectionParams(),this.setState(n.RetrievingToken),this.worker.dispatchReconnecting(),this.worker.getToken(!0,!1)):this.showIgnored("onSocketError")},e.prototype.onTrouterConnected=function(){this.state===n.Connecting?(this.setState(n.Connected),this.worker.resetTokenBackoff(),this.worker.stopConnectionTimer(),this.worker.sendUserActivityState(s.UserActivityEventReason.Connected,!0),this.worker.startPingTimer(),this.worker.dispatchConnected(),this.connectionErrors=0,this.worker.shouldSkipRegistration()?(this.connectedSubstate=o.NotRegistered,this.worker.dispatchRegistered()):(this.connectedSubstate=o.RetrievingToken,this.worker.getToken(!0,!1))):this.showIgnored("onTrouterConnected")},e.prototype.onReconnectRequired=function(){this.worker.dispatchReconnectIsRequired()},e.prototype.onDownstreamRequest=function(e){this.state===n.Connected?(this.switchToIncallModeIfEnabled(),this.worker.dispatchDownstreamRequest(e)):this.showIgnored("onDownstreamRequest")},e.prototype.onTrouterMessageLost=function(e){this.state===n.Connected?this.worker.dispatchTrouterMessageLost(e):this.showIgnored("onTrouterMessageLost")},e.prototype.onPingInterval=function(){this.state===n.Connected?this.worker.sendPingRequest():this.showIgnored("onPingInterval")},e.prototype.onPingResponseTimeout=function(){this.onMissedResponse("onPingResponseTimeout")},e.prototype.onPingResponse=function(){this.state===n.Connected||this.showIgnored("onPingResponse")},e.prototype.onRegistrationFailed=function(e){this.state===n.Connected&&this.connectedSubstate===o.Registering?(this.connectedSubstate=o.RetrievingToken,this.worker.getToken(!e,!0)):this.showIgnored("onRegistrationFailed")},e.prototype.onRegistrationSucceed=function(){this.state===n.Connected?(this.connectedSubstate===o.Registering&&(this.connectedSubstate=o.Registered,this.worker.dispatchRegistered()),this.worker.hasCustomRegisterTtl()&&this.worker.startRegisterTimer()):this.showIgnored("onRegistrationSucceed")},e.prototype.onRegistrationTimeout=function(){this.state===n.Connected&&this.connectedSubstate!==o.NotRegistered?(this.connectedSubstate=o.RetrievingToken,this.worker.getToken(!0,!1)):this.showIgnored("onRegistrationTimeout")},e.prototype.onUnregistrationFailed=function(e){this.state===n.Unregistering?(this.setState(n.UnregisteringRetrievingToken),this.worker.getToken(!e,!e)):this.showIgnored("onUnregistrationFailed")},e.prototype.onUnregistrationSucceed=function(){this.state===n.Unregistering?(this.setState(n.Initial),this.worker.dispatchDisconnected()):this.showIgnored("onUnregistrationSucceed")},e.prototype.onIncallModeTimer=function(){this.worker.exitIncallMode(),this.state===n.Connected?(this.worker.stopPingTimer(),this.worker.startPingTimer()):this.showIgnored("onIncallModeTimer")},e.prototype.onSetUserActivityState=function(e,t){t?(this.logger.info("Changing user activity state to '"+i.UserActivityState[e]+"'"),this.worker.sendUserActivityState(s.UserActivityEventReason.Modified,this.state===n.Connected)):this.logger.debug("Not changing the same user activity state '"+i.UserActivityState[e]+"'")},e.prototype.onActivityStateResponseTimeout=function(){this.onMissedResponse("onActivityStateResponseTimeout")},e.prototype.forceReconnect=function(){this.setState(n.RetrievingToken),this.worker.resetTokenBackoff(),this.worker.stopConnectionTimer(),this.worker.stopPingTimer(),this.worker.clearTimers(),this.worker.stopSocketIo(),this.worker.dispatchReconnecting(),this.worker.getToken(!0,!1)},e.prototype.onMissedResponse=function(e){this.state===n.Connected?(this.setState(n.RetrievingToken),this.worker.stopPingTimer(),this.worker.clearTimers(),this.worker.stopSocketIo(),this.worker.dispatchReconnecting(),this.worker.getToken(!0,!1)):this.showIgnored(e)},e.prototype.showIgnored=function(e){this.logger.debug("Ignoring event '"+e+"' in state '"+n[this.state]+"'")},e.prototype.setState=function(e){this.logger.info("Switching from state '"+n[this.state]+"' to state '"+n[e]+"'"),this.state!==e?this.state=e:this.logger.error("Attempt to switching into the current state '"+n[e]+"'")},e.prototype.resetAllocationIfNecessary=function(e){this.connectionErrors++,this.connectionErrors>=2||void 0!==e&&/^4\d\d /.test(e)?(this.logger.error("Connection error count is "+this.connectionErrors+" - will reset allocation"),this.connectionErrors=0):this.logger.info("Connection error count is "+this.connectionErrors+" - will NOT reset allocation")},e.prototype.isRegistered=function(){return this.connectedSubstate===o.Registered||this.connectedSubstate===o.Registering},e.prototype.switchToIncallModeIfEnabled=function(){this.incallModeEnabled&&(this.worker.isIncallMode()||(this.worker.enterIncallMode(),this.worker.stopPingTimer(),this.worker.startPingTimer()),this.worker.restartIncallModeTimer())},e}();t.TrouterFsm=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=function(){function e(e,t){this.worker=t,this.state=n.TrouterState.Unknown,this.logger=new o.Logger("ManagerFsm",e)}return e.prototype.start=function(){this.state===n.TrouterState.Unknown?(this.setState(n.TrouterState.Disconnected),this.worker.startFirstConnection()):this.showIgnored("start")},e.prototype.stop=function(){this.state!==n.TrouterState.Unknown?(this.setState(n.TrouterState.Unknown),this.worker.stopFirstConnection(!1),this.worker.stopSecondConnection(!1)):this.showIgnored("stop")},e.prototype.getState=function(){return this.state},e.prototype.onConnected=function(e){this.state===n.TrouterState.Disconnected&&e?this.worker.doesSecondConnectionExist()?this.setState(n.TrouterState.Switching):(this.setState(n.TrouterState.Connected),this.worker.dispatchConnected()):this.showIgnored("onConnected("+e+")")},e.prototype.onRegistered=function(e){this.state!==n.TrouterState.Disconnected||e?this.state!==n.TrouterState.Switching||e?this.showIgnored("onRegistered("+e+")"):(this.setState(n.TrouterState.Connected),this.worker.switchConnections(),this.worker.stopSecondConnectionDelayed(),this.worker.dispatchConnected()):(this.setState(n.TrouterState.Connected),this.worker.switchConnections(),this.worker.stopSecondConnection(!0),this.worker.dispatchConnected())},e.prototype.onReconnecting=function(e){this.state===n.TrouterState.Connected&&e||this.state===n.TrouterState.Switching&&e?(this.setState(n.TrouterState.Disconnected),this.worker.dispatchReconnecting()):this.showIgnored("onReconnecting("+e+")")},e.prototype.onReconnectionRequired=function(e){this.state===n.TrouterState.Connected&&e?(this.setState(n.TrouterState.Switching),this.worker.startSecondConnection()):this.state===n.TrouterState.Disconnected&&e?this.worker.startSecondConnection():this.showIgnored("onReconnectionRequired("+e+")")},e.prototype.onDisconnected=function(e){this.state===n.TrouterState.Unknown&&e?this.worker.dispatchStopped():this.showIgnored("onDisconnected("+e+")")},e.prototype.showIgnored=function(e){this.logger.info("Ignoring event '"+e+"' in state '"+n.TrouterState[this.state]+"'")},e.prototype.setState=function(e){this.logger.info("Switching from state '"+n.TrouterState[this.state]+"' to state '"+n.TrouterState[e]+"'"),this.state!==e?this.state=e:this.logger.error("Attempt to switching into the current state '"+n.TrouterState[e]+"'")},e}();t.TrouterManagerFsm=i},function(e,t,r){function n(e,t){if(!t)return e;var r=i({},e,{enabled:t.TelemetryEnabled});return void 0!==t.ClientTelemetryEventEnabled&&(r=i({},r,t.ClientTelemetryEventEnabled)),r}function o(e,t){return{clientInfo:{ua:e.trouterSettings.productName,v:e.trouterSettings.version},ioOptions:{ackTimeoutMs:5e3},clientCorrelationID:e.trouterSettings.sessionId,environment:e.trouterSettings.environment,telemetrySettings:n(e.telemetryConfig.settings,t),eventLogger:e.telemetryConfig.eventLogger,endpointId:e.trouterSettings.registrationId,trouterUrl:t&&t.TrouterConnectionUrl||e.trouterSettings.trouterServiceUrl,registration:e.trouterSettings.registrarServiceUrl?{registrarUrl:e.trouterSettings.registrarServiceUrl,registrationId:e.trouterSettings.registrationId||"",pnhAppId:e.trouterSettings.pnhAppId||"",platform:e.trouterSettings.platform||"",pnhTemplateKey:e.trouterSettings.pnhTemplate||"",platformUIVersion:e.trouterSettings.platformUIVersion||"",productContext:e.trouterSettings.pnhProductContext||void 0,context:e.trouterSettings.pnhContext||"",registrarTtlSec:(e.trouterSettings.maxRegistrationTimeInMs||0)/1e3}:void 0,timeoutOptions:i({connectionTimeoutMs:e.trouterSettings.trouterConnectTimeoutInMs||3e4,fetchTimeoutMs:1e4,pingTimeoutMs:4e4,pongTimeoutMs:5e3,maxBackoffMs:3e4,requestTimeoutMs:5e3,userActivityResponseTimeoutMs:1e4},e.trouterSettings.timeoutOptions),incallTimeoutOptions:i({connectionTimeoutMs:1e4,fetchTimeoutMs:5e3,pingTimeoutMs:5e3,pongTimeoutMs:2e3,maxBackoffMs:1e4,requestTimeoutMs:5e3,userActivityResponseTimeoutMs:1e4},e.trouterSettings.incallTimeoutOptions),incallModeTimeoutMs:e.trouterSettings.incallModeTimeoutMs||0,lingeringConnectionDelayMs:6e4,userActivitySecondResendDelayMs:e.trouterSettings.userActivitySecondResendDelayMs||1e4}}var i=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(s,a)}c((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,i=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(s=(s=c.trys).length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){c.label=r[1];break}if(6===r[0]&&c.label<s[1]){c.label=s[1],s=r;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(r);break}s[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(e){r=[6,e],i=0}finally{o=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,s,a,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var c=r(2),u=r(1);t.TrouterState=u.TrouterState,t.UserActivityState=u.UserActivityState;var l=r(0),p=r(6),d=r(7),h=r(8),f=r(9),y=function(){function e(e){this.logProvider=e,this.stateChangedListeners=[],this.logger=new l.Logger("Trouter",e),this.trouterUrlPromise=new f.TrouterUrlPromise(e),this.messageHandlers=new p.MessageHandlerRegistry(e),this.listeners={},this.connectionInfo=null,this.logger.info("Created TrouterService version "+c.CLIENT_VERSION)}return e.prototype.start=function(e){if(this.logger.info("Start"),!e.trouterSettings.disableInternalSkypeTokenCache){var t=e.skypeTokenProvider;e.skypeTokenProvider=d.addCacheAsBackupTo(t)}this.trouterCfg=e;var r=o(e,this.ecsCfg);void 0===this.trouterServer&&(this.trouterServer=new h.TrouterManager(this.logProvider,r,e.skypeTokenProvider,this)),this.trouterServer.start()},e.prototype.stop=function(){this.logger.info("close connection"),this.trouterUrlPromise.rejectUrl(new Error("TrouterService is stopped")),void 0!==this.trouterServer&&this.trouterServer.stop()},e.prototype.setEcsConfig=function(e){return s(this,void 0,void 0,(function(){var t=this;return a(this,(function(r){return[2,new Promise((function(r,n){if(t.ecsCfg=e.TrouterJScriptClient,t.logger.info("Setting ECS configuration to "+JSON.stringify(t.ecsCfg)),void 0!==t.trouterServer&&void 0!==t.trouterCfg){var i=o(t.trouterCfg,t.ecsCfg);t.trouterServer.configure(i)}r()}))]}))}))},e.prototype.checkConnection=function(e){void 0!==this.trouterServer&&this.trouterServer.checkConnection(e||!1)},e.prototype.resendRegistration=function(){return s(this,void 0,void 0,(function(){return a(this,(function(e){if(!this.trouterServer)throw new Error("resendRegistration called too early");return[2,this.trouterServer.resendRegistration()]}))}))},e.prototype.registerListener=function(e,t){return""===t||"/"!==t[0]||t.indexOf("?")>=0||t.indexOf("#")>=0?(this.logger.error("Listener path '"+t+"' is not valid"),!1):this.listeners[t]?(this.logger.error("Another listener is already registered for path '"+t+"'"),!1):(this.listeners[t]=e,this.logger.debug("Listener for path '"+t+"' registered"),this.connectionInfo&&e.onTrouterConnected(this.connectionInfo.baseEndpointUrl+t,this.connectionInfo),!0)},e.prototype.unregisterListener=function(e){for(var t=[],r=0,n=Object.keys(this.listeners);r<n.length;r++){var o=n[r];this.listeners[o]===e&&t.push(o)}if(0===t.length)return!1;for(var i=0,s=t;i<s.length;i++)o=s[i],delete this.listeners[o];return this.logger.debug("Listener for path(s) '"+t.join("', '")+"' unregistered"),!0},e.prototype.onTrouterConnected=function(e,t){this.logger.debug("Trouter is now connected");for(var r=0,n=Object.keys(this.listeners);r<n.length;r++){var o=n[r];try{this.listeners[o].onTrouterConnected(t.baseEndpointUrl+o,t)}catch(e){this.logger.error("Listener '"+o+"' threw an exception from onTrouterConnected(): "+e)}}this.connectionInfo=t,this.trouterUrlPromise.resolveUrl(e),this.notifyStateChanged(u.TrouterState.Connected,{url:e,getRemainingTtlInSec:function(){return t.connectionTtlSec}})},e.prototype.onTrouterDisconnected=function(){this.logger.debug("Trouter is now disconnected"),this.connectionInfo=null;for(var e=0,t=Object.keys(this.listeners);e<t.length;e++){var r=t[e],n=this.listeners[r].onTrouterDisconnected;if(n)try{n()}catch(e){this.logger.error("Listener '"+r+"' threw an exception from onTrouterDisconnected(): "+e)}}this.notifyStateChanged(u.TrouterState.Disconnected)},e.prototype.onTrouterRequest=function(e,t){for(var r="",n=0,o=Object.keys(this.listeners);n<o.length;n++){var i=o[n];e.path.substring(0,i.length)===i&&i.length>r.length&&(r=i)}if(""===r)this.tryMessageHandlers(e,t)||(t.status=404,t.headers={"Trouter-Responder":"ClientLib"},t.send());else try{this.listeners[r].onTrouterRequest(e,t)}catch(e){this.logger.error("Listener '"+r+"' threw an exception from onTrouterRequest(): "+e),t.status=500,t.headers={"Trouter-Responder":"ClientLib"},t.send()}},e.prototype.onTrouterMessageLoss=function(e){this.logger.info("onTrouterMessageLoss called with value "+e);for(var t=!0,r=0,n=Object.keys(this.listeners);r<n.length;r++){var o=n[r],i=this.listeners[o].onTrouterMessageLoss;if(i)try{void 0===(t=i(e)&&t)&&(this.logger.error("Listener '"+o+"' did not response with boolean value onTrouterMessageLoss()"),t=!1)}catch(e){this.logger.error("Listener '"+o+"' threw an exception from onTrouterMessageLoss(): "+e),t=!1}}return t},e.prototype.setUserActivityState=function(e){if(e!==u.UserActivityState.Active&&e!==u.UserActivityState.Inactive)throw new Error("setUserActivityState called with unsupported value "+e);if(this.logger.info("setUserActivityState called with value "+u.UserActivityState[e]),!this.trouterServer||this.state()===u.TrouterState.Unknown)throw new Error("setUserActivityState called too early");this.trouterServer.setUserActivityState(e)},e.prototype.state=function(){return void 0!==this.trouterServer?this.trouterServer.getState():u.TrouterState.Unknown},e.prototype.getServerState=function(){if(void 0!==this.trouterServer)return this.trouterServer.getServerState()},e.prototype.getTrouterUrlAsync=function(){return void 0!==this.trouterServer?this.trouterUrlPromise.getPromise():Promise.reject(new Error("TrouterService has not been started"))},e.prototype.onStateChanged=function(e){if(this.logger.info("onStateChanged called"),void 0===e)this.stateChangedListeners=this.stateChangedListeners.filter((function(e){return void 0===e.wrappedCallback}));else{this.offStateChanged(e);var t=function(t,r){e(t,r?r.url:"")};t.wrappedCallback=e,this.stateChangedListeners.push(t)}},e.prototype.offStateChanged=function(e){this.logger.info("offStateChanged called");var t=this.stateChangedListeners.length;return this.stateChangedListeners=this.stateChangedListeners.filter((function(t){return t.wrappedCallback!==e})),t>this.stateChangedListeners.length},e.prototype.addCallback=function(e){this.logger.info("addListener called"),-1===this.stateChangedListeners.indexOf(e,0)&&void 0!==e&&this.stateChangedListeners.push(e)},e.prototype.removeCallback=function(e){this.logger.info("removeListener called");var t=this.stateChangedListeners.indexOf(e,0);return t>-1&&(this.stateChangedListeners.splice(t,1),!0)},e.prototype.registerMessageHandler=function(e){this.logger.info("registerMessageHandler is called"),this.messageHandlers.register(e)},e.prototype.clearMessageHandlers=function(){this.logger.info("clearMessageHandlers is called"),this.messageHandlers.clear()},e.prototype.notifyStateChanged=function(e,t){var r=this;this.logger.info("notifyStateChanged called, will forward to "+this.stateChangedListeners.length+" listeners"),this.stateChangedListeners.forEach((function(n){try{n(e,t)}catch(e){r.logger.error("Error in callback "+e)}}))},e.prototype.tryMessageHandlers=function(e,t){if(!this.messageHandlers.active())return!1;var r,n=null;try{n=(r=JSON.parse(e.body))&&(r.evt||r.eventId)||null}catch(e){}var o={eventId:n,url:(this.connectionInfo?this.connectionInfo.baseEndpointUrl:"")+e.path,body:r,rawBody:e.body,headers:e.headers},i=this.messageHandlers.handleMessage(o);return!!i.isHandled&&(t.status=i.resultCode,i.responseHeaders&&(t.headers=i.responseHeaders),i.responseBody&&(t.body=i.responseBody),t.send(),!0)},e}();t.TrouterService=y,t.createTrouterService=function(e){return new y(e)},t.getTrouterServiceVersion=function(){return c.CLIENT_VERSION},t.replaceTrouterUrlBase=function(e,t){var r=e.indexOf("://");if(r>=0){var n=e.indexOf("/",r+3);if(n>=0)return t+e.substr(n)}return""}},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_20__},function(e,t){}])},module.exports=e(tsregistrar)}));unwrapExports(tstrouter);var TrouterUtils=createCommonjsModule((function(e,t){t.__esModule=!0;var r=new Map([["chatMessageReceived",200],["typingIndicatorReceived",245],["readReceiptReceived",246],["chatMessageEdited",247],["chatMessageDeleted",248]]);t.toMessageHandler=function(e,t){var o=r.get(e);return{handleMessage:function(r){var i=null;if(r&&r.rawBody&&(i=JSON.parse(r.rawBody)),null!==i&&i._eventId===o){var s=n(e,i);if(null!==s)return t(s),{isHandled:!0,resultCode:200}}}}};var n=function(e,t){if("chatMessageReceived"===e)return{threadId:(r=t).groupId,sender:{communicationUserId:r.senderId},recipient:{communicationUserId:"8:"+r.recipientId},id:r.messageId,senderDisplayName:r.senderDisplayName,createdOn:r.originalArrivalTime,version:r.version,type:r.messageType,content:r.messageBody,priority:r.priority};if("chatMessageEdited"===e)return{threadId:(r=t).groupId,sender:{communicationUserId:r.senderId},recipient:{communicationUserId:"8:"+r.recipientId},id:r.messageId,senderDisplayName:r.senderDisplayName,createdOn:r.originalArrivalTime,version:r.version,content:r.messageBody,editedOn:r.edittime};if("chatMessageDeleted"===e)return{threadId:(r=t).groupId,sender:{communicationUserId:r.senderId},recipient:{communicationUserId:"8:"+r.recipientId},id:r.messageId,senderDisplayName:r.senderDisplayName,createdOn:r.originalArrivalTime,version:r.version,deletedOn:r.deletetime};if("typingIndicatorReceived"===e)return{threadId:(r=t).groupId,sender:{communicationUserId:r.senderId},recipient:{communicationUserId:"8:"+r.recipientId},version:r.version,receivedOn:r.originalArrivalTime};if("readReceiptReceived"===e){var r=t,n=JSON.parse(r.messageBody).consumptionhorizon.split(";"),o=new Date(+n[1]).toISOString();return{threadId:r.groupId,sender:{communicationUserId:r.senderId},recipient:{communicationUserId:"8:"+r.recipientId},chatMessageId:r.messageId,readOn:o}}return null};t.toLogProvider=function(e){return{log:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.info(t)},warn:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.warning(t)},error:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.error(t)},debug:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.verbose(t)},info:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.verbose(t)}}},t.toTelemetrySender=function(e){return{logEvent:function(t){return e.info(t)}}}}));unwrapExports(TrouterUtils);var TrouterUtils_1=TrouterUtils.toMessageHandler,TrouterUtils_2=TrouterUtils.toLogProvider,TrouterUtils_3=TrouterUtils.toTelemetrySender;function getHeaderKey(e){return e.toLowerCase()}function isHttpHeadersLike(e){return!(!e||"object"!=typeof e)&&"function"==typeof e.rawHeaders&&"function"==typeof e.clone&&"function"==typeof e.get&&"function"==typeof e.set&&"function"==typeof e.contains&&"function"==typeof e.remove&&"function"==typeof e.headersArray&&"function"==typeof e.headerValues&&"function"==typeof e.headerNames&&"function"==typeof e.toJson}var HttpHeaders=function(){function e(e){if(this._headersMap={},e)for(var t in e)this.set(t,e[t])}return e.prototype.set=function(e,t){this._headersMap[getHeaderKey(e)]={name:e,value:t.toString()}},e.prototype.get=function(e){var t=this._headersMap[getHeaderKey(e)];return t?t.value:void 0},e.prototype.contains=function(e){return!!this._headersMap[getHeaderKey(e)]},e.prototype.remove=function(e){var t=this.contains(e);return delete this._headersMap[getHeaderKey(e)],t},e.prototype.rawHeaders=function(){var e={};for(var t in this._headersMap){var r=this._headersMap[t];e[r.name.toLowerCase()]=r.value}return e},e.prototype.headersArray=function(){var e=[];for(var t in this._headersMap)e.push(this._headersMap[t]);return e},e.prototype.headerNames=function(){for(var e=[],t=this.headersArray(),r=0;r<t.length;++r)e.push(t[r].name);return e},e.prototype.headerValues=function(){for(var e=[],t=this.headersArray(),r=0;r<t.length;++r)e.push(t[r].value);return e},e.prototype.toJson=function(){return this.rawHeaders()},e.prototype.toString=function(){return JSON.stringify(this.toJson())},e.prototype.clone=function(){return new e(this.rawHeaders())},e}();function encodeString(e){return btoa(e)}function encodeByteArray(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function decodeString(e){for(var t=atob(e),r=new Uint8Array(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r}var getRandomValues="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),rnds8=new Uint8Array(16);function rng(){if(!getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}for(var byteToHex=[],i=0;i<256;++i)byteToHex.push((i+256).toString(16).substr(1));function bytesToUuid(e,t){var r=t||0,n=byteToHex;return(n[e[r+0]]+n[e[r+1]]+n[e[r+2]]+n[e[r+3]]+"-"+n[e[r+4]]+n[e[r+5]]+"-"+n[e[r+6]]+n[e[r+7]]+"-"+n[e[r+8]]+n[e[r+9]]+"-"+n[e[r+10]]+n[e[r+11]]+n[e[r+12]]+n[e[r+13]]+n[e[r+14]]+n[e[r+15]]).toLowerCase()}function v4(e,t,r){"string"==typeof e&&(t="binary"===e?new Uint8Array(16):null,e=null);var n=(e=e||{}).random||(e.rng||rng)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){for(var o=r||0,i=0;i<16;++i)t[o+i]=n[i];return t}return bytesToUuid(n)}var Constants={coreHttpVersion:"1.1.4",HTTP:"http:",HTTPS:"https:",HTTP_PROXY:"HTTP_PROXY",HTTPS_PROXY:"HTTPS_PROXY",HttpConstants:{HttpVerbs:{PUT:"PUT",GET:"GET",DELETE:"DELETE",POST:"POST",MERGE:"MERGE",HEAD:"HEAD",PATCH:"PATCH"},StatusCodes:{TooManyRequests:429}},HeaderConstants:{AUTHORIZATION:"authorization",AUTHORIZATION_SCHEME:"Bearer",RETRY_AFTER:"Retry-After",USER_AGENT:"User-Agent"}},validUuidRegex=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i,isNode="undefined"!=typeof process&&!!process.version&&!!process.versions&&!!process.versions.node;function encodeUri(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/"/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function stripResponse(e){var t={};return t.body=e.bodyAsText,t.headers=e.headers,t.status=e.status,t}function stripRequest(e){var t=e.clone();return t.headers&&t.headers.remove("authorization"),t}function isValidUuid(e){return validUuidRegex.test(e)}function generateUuid(){return v4()}function executePromisesSequentially(e,t){var r=Promise.resolve(t);return e.forEach((function(e){r=r.then(e)})),r}function delay(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))}function promiseToCallback(e){if("function"!=typeof e.then)throw new Error("The provided input is not a Promise.");return function(t){e.then((function(e){return t(void 0,e)})).catch((function(e){t(e)}))}}function promiseToServiceCallback(e){if("function"!=typeof e.then)throw new Error("The provided input is not a Promise.");return function(t){e.then((function(e){return process.nextTick(t,void 0,e.parsedBody,e.request,e)})).catch((function(e){process.nextTick(t,e)}))}}function prepareXMLRootList(e,t){var r;return Array.isArray(e)||(e=[e]),(r={})[t]=e,r}function applyMixins(e,t){t.forEach((function(t){Object.getOwnPropertyNames(t.prototype).forEach((function(r){e.prototype[r]=t.prototype[r]}))}))}var validateISODuration=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function isDuration(e){return validateISODuration.test(e)}function replaceAll(e,t,r){return e&&t?e.split(t).join(r||""):e}function isPrimitiveType(e){return"object"!=typeof e&&"function"!=typeof e||null===e}var Serializer=function(){function e(e,t){void 0===e&&(e={}),this.modelMappers=e,this.isXML=t}return e.prototype.validateConstraints=function(e,t,r){var n=function(e,n){throw new Error('"'+r+'" with value "'+t+'" should satisfy the constraint "'+e+'": '+n+".")};if(e.constraints&&null!=t){var o=e.constraints,i=o.ExclusiveMaximum,s=o.ExclusiveMinimum,a=o.InclusiveMaximum,c=o.InclusiveMinimum,u=o.MaxItems,l=o.MaxLength,p=o.MinItems,d=o.MinLength,h=o.MultipleOf,f=o.Pattern,y=o.UniqueItems;if(null!=i&&t>=i&&n("ExclusiveMaximum",i),null!=s&&t<=s&&n("ExclusiveMinimum",s),null!=a&&t>a&&n("InclusiveMaximum",a),null!=c&&t<c&&n("InclusiveMinimum",c),null!=u&&t.length>u&&n("MaxItems",u),null!=l&&t.length>l&&n("MaxLength",l),null!=p&&t.length<p&&n("MinItems",p),null!=d&&t.length<d&&n("MinLength",d),null!=h&&t%h!=0&&n("MultipleOf",h),f){var g="string"==typeof f?new RegExp(f):f;"string"==typeof t&&null!==t.match(g)||n("Pattern",f)}y&&t.some((function(e,t,r){return r.indexOf(e)!==t}))&&n("UniqueItems",y)}},e.prototype.serialize=function(e,t,r){var n={},o=e.type.name;r||(r=e.serializedName),null!==o.match(/^Sequence$/i)&&(n=[]),e.isConstant&&(t=e.defaultValue);var i=e.required,s=e.nullable;if(i&&s&&void 0===t)throw new Error(r+" cannot be undefined.");if(i&&!s&&null==t)throw new Error(r+" cannot be null or undefined.");if(!i&&!1===s&&null===t)throw new Error(r+" cannot be null.");return null==t?n=t:(this.validateConstraints(e,t,r),null!==o.match(/^any$/i)?n=t:null!==o.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)?n=serializeBasicTypes(o,r,t):null!==o.match(/^Enum$/i)?n=serializeEnumType(r,e.type.allowedValues,t):null!==o.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?n=serializeDateTypes(o,t,r):null!==o.match(/^ByteArray$/i)?n=serializeByteArrayType(r,t):null!==o.match(/^Base64Url$/i)?n=serializeBase64UrlType(r,t):null!==o.match(/^Sequence$/i)?n=serializeSequenceType(this,e,t,r):null!==o.match(/^Dictionary$/i)?n=serializeDictionaryType(this,e,t,r):null!==o.match(/^Composite$/i)&&(n=serializeCompositeType(this,e,t,r))),n},e.prototype.deserialize=function(e,t,r){if(null==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),void 0!==e.defaultValue&&(t=e.defaultValue),t;var n,o=e.type.name;return r||(r=e.serializedName),null!==o.match(/^Composite$/i)?n=deserializeCompositeType(this,e,t,r):(this.isXML&&null!=t.$&&null!=t._&&(t=t._),null!==o.match(/^Number$/i)?(n=parseFloat(t),isNaN(n)&&(n=t)):null!==o.match(/^Boolean$/i)?n="true"===t||"false"!==t&&t:null!==o.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?n=t:null!==o.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?n=new Date(t):null!==o.match(/^UnixTime$/i)?n=unixTimeToDate(t):null!==o.match(/^ByteArray$/i)?n=decodeString(t):null!==o.match(/^Base64Url$/i)?n=base64UrlToByteArray(t):null!==o.match(/^Sequence$/i)?n=deserializeSequenceType(this,e,t,r):null!==o.match(/^Dictionary$/i)&&(n=deserializeDictionaryType(this,e,t,r))),e.isConstant&&(n=e.defaultValue),n},e}();function trimEnd(e,t){for(var r=e.length;r-1>=0&&e[r-1]===t;)--r;return e.substr(0,r)}function bufferToBase64Url(e){if(e){if(!(e instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return trimEnd(encodeByteArray(e),"=").replace(/\+/g,"-").replace(/\//g,"_")}}function base64UrlToByteArray(e){if(e){if(e&&"string"!=typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return decodeString(e=e.replace(/-/g,"+").replace(/_/g,"/"))}}function splitSerializeName(e){var t=[],r="";if(e)for(var n=0,o=e.split(".");n<o.length;n++){var i=o[n];"\\"===i.charAt(i.length-1)?r+=i.substr(0,i.length-1)+".":(r+=i,t.push(r),r="")}return t}function dateToUnixTime(e){if(e)return"string"==typeof e.valueOf()&&(e=new Date(e)),Math.floor(e.getTime()/1e3)}function unixTimeToDate(e){if(e)return new Date(1e3*e)}function serializeBasicTypes(e,t,r){if(null!=r)if(null!==e.match(/^Number$/i)){if("number"!=typeof r)throw new Error(t+" with value "+r+" must be of type number.")}else if(null!==e.match(/^String$/i)){if("string"!=typeof r.valueOf())throw new Error(t+' with value "'+r+'" must be of type string.')}else if(null!==e.match(/^Uuid$/i)){if("string"!=typeof r.valueOf()||!isValidUuid(r))throw new Error(t+' with value "'+r+'" must be of type string and a valid uuid.')}else if(null!==e.match(/^Boolean$/i)){if("boolean"!=typeof r)throw new Error(t+" with value "+r+" must be of type boolean.")}else if(null!==e.match(/^Stream$/i)){var n=typeof r;if(!("string"===n||"function"===n||r instanceof ArrayBuffer||ArrayBuffer.isView(r)||"function"==typeof Blob&&r instanceof Blob))throw new Error(t+" must be a string, Blob, ArrayBuffer, ArrayBufferView, or a function returning NodeJS.ReadableStream.")}return r}function serializeEnumType(e,t,r){if(!t)throw new Error("Please provide a set of allowedValues to validate "+e+" as an Enum Type.");if(!t.some((function(e){return"string"==typeof e.valueOf()?e.toLowerCase()===r.toLowerCase():e===r})))throw new Error(r+" is not a valid value for "+e+". The valid values are: "+JSON.stringify(t)+".");return r}function serializeByteArrayType(e,t){var r="";if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");r=encodeByteArray(t)}return r}function serializeBase64UrlType(e,t){var r="";if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");r=bufferToBase64Url(t)||""}return r}function serializeDateTypes(e,t,r){if(null!=t)if(null!==e.match(/^Date$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in RFC-1123 format.");t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.");t=dateToUnixTime(t)}else if(null!==e.match(/^TimeSpan$/i)&&!isDuration(t))throw new Error(r+' must be a string in ISO 8601 format. Instead was "'+t+'".');return t}function serializeSequenceType(e,t,r,n){if(!Array.isArray(r))throw new Error(n+" must be of type Array.");var o=t.type.element;if(!o||"object"!=typeof o)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+n+".");for(var i=[],s=0;s<r.length;s++)i[s]=e.serialize(o,r[s],n);return i}function serializeDictionaryType(e,t,r,n){if("object"!=typeof r)throw new Error(n+" must be of type object.");var o=t.type.value;if(!o||"object"!=typeof o)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+n+".");for(var i={},s=0,a=Object.keys(r);s<a.length;s++){var c=a[s];i[c]=e.serialize(o,r[c],n+"."+c)}return i}function resolveModelProperties(e,t,r){var n=t.type.modelProperties;if(!n){var o=t.type.className;if(!o)throw new Error('Class name for model "'+r+'" is not provided in the mapper "'+JSON.stringify(t,void 0,2)+'".');var i=e.modelMappers[o];if(!i)throw new Error('mapper() cannot be null or undefined for model "'+o+'".');if(!(n=i.type.modelProperties))throw new Error('modelProperties cannot be null or undefined in the mapper "'+JSON.stringify(i)+'" of type "'+o+'" for object "'+r+'".')}return n}function serializeCompositeType(e,t,r,n){var o;if(getPolymorphicDiscriminatorRecursively(e,t)&&(t=getPolymorphicMapper(e,t,r,"clientName")),null!=r){for(var i={},s=resolveModelProperties(e,t,n),a=0,c=Object.keys(s);a<c.length;a++){var u=c[a],l=s[u];if(!l.readOnly){var p=void 0,d=i;if(e.isXML)p=l.xmlIsWrapped?l.xmlName:l.xmlElementName||l.xmlName;else{var h=splitSerializeName(l.serializedName);p=h.pop();for(var f=0,y=h;f<y.length;f++){var g=y[f];null!=d[g]||null==r[u]&&void 0===l.defaultValue||(d[g]={}),d=d[g]}}if(null!=d){var m=""!==l.serializedName?n+"."+l.serializedName:n,v=r[u],T=getPolymorphicDiscriminatorRecursively(e,t);T&&T.clientName===u&&null==v&&(v=t.serializedName);var b=e.serialize(l,v,m);void 0!==b&&null!=p&&(l.xmlIsAttribute?(d.$=d.$||{},d.$[p]=b):l.xmlIsWrapped?d[p]=((o={})[l.xmlElementName]=b,o):d[p]=b)}}}var _=t.type.additionalProperties;if(_){var R=Object.keys(s),w=function(t){R.every((function(e){return e!==t}))&&(i[t]=e.serialize(_,r[t],n+'["'+t+'"]'))};for(var O in r)w(O)}return i}return r}function isSpecialXmlProperty(e){return["$","_"].includes(e)}function deserializeCompositeType(e,t,r,n){getPolymorphicDiscriminatorRecursively(e,t)&&(t=getPolymorphicMapper(e,t,r,"serializedName"));for(var o=resolveModelProperties(e,t,n),i={},s=[],a=0,c=Object.keys(o);a<c.length;a++){var u=c[a],l=o[u],p=splitSerializeName(o[u].serializedName);s.push(p[0]);var d=l.serializedName,h=l.xmlName,f=l.xmlElementName,y=n;""!==d&&void 0!==d&&(y=n+"."+d);var g=l.headerCollectionPrefix;if(g){for(var m={},v=0,T=Object.keys(r);v<T.length;v++){var b=T[v];b.startsWith(g)&&(m[b.substring(g.length)]=e.deserialize(l.type.value,r[b],y)),s.push(b)}i[u]=m}else if(e.isXML)if(l.xmlIsAttribute&&r.$)i[u]=e.deserialize(l,r.$[h],y);else{var _=r[f||h||d];l.xmlIsWrapped&&void 0===(_=(_=r[h])&&_[f])&&(_=[]),i[u]=e.deserialize(l,_,y)}else{for(var R=void 0,w=r,O=0,C=p;O<C.length;O++){var E=C[O];if(!w)break;w=w[E]}R=w;var P=t.type.polymorphicDiscriminator;P&&u===P.clientName&&null==R&&(R=t.serializedName);var S=void 0;Array.isArray(r[u])&&""===o[u].serializedName?(R=r[u],i=e.deserialize(l,R,y)):void 0===R&&void 0===l.defaultValue||(S=e.deserialize(l,R,y),i[u]=S)}}var N=t.type.additionalProperties;if(N){var k=function(e){for(var t in o)if(splitSerializeName(o[t].serializedName)[0]===e)return!1;return!0};for(var A in r)k(A)&&(i[A]=e.deserialize(N,r[A],n+'["'+A+'"]'))}else if(r)for(var I=0,M=Object.keys(r);I<M.length;I++)void 0!==i[u=M[I]]||s.includes(u)||isSpecialXmlProperty(u)||(i[u]=r[u]);return i}function deserializeDictionaryType(e,t,r,n){var o=t.type.value;if(!o||"object"!=typeof o)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+n);if(r){for(var i={},s=0,a=Object.keys(r);s<a.length;s++){var c=a[s];i[c]=e.deserialize(o,r[c],n)}return i}return r}function deserializeSequenceType(e,t,r,n){var o=t.type.element;if(!o||"object"!=typeof o)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+n);if(r){Array.isArray(r)||(r=[r]);for(var i=[],s=0;s<r.length;s++)i[s]=e.deserialize(o,r[s],n+"["+s+"]");return i}return r}function getPolymorphicMapper(e,t,r,n){var o=getPolymorphicDiscriminatorRecursively(e,t);if(o){var i=o[n];if(null!=i){var s=r[i];if(null!=s){var a=t.type.uberParent||t.type.className,c=s===a?s:a+"."+s,u=e.modelMappers.discriminators[c];u&&(t=u)}}}return t}function getPolymorphicDiscriminatorRecursively(e,t){return t.type.polymorphicDiscriminator||getPolymorphicDiscriminatorSafely(e,t.type.uberParent)||getPolymorphicDiscriminatorSafely(e,t.type.className)}function getPolymorphicDiscriminatorSafely(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}function serializeObject(e){if(null!=e){if(e instanceof Uint8Array)return encodeByteArray(e);if(e instanceof Date)return e.toISOString();if(Array.isArray(e)){for(var t=[],r=0;r<e.length;r++)t.push(serializeObject(e[r]));return t}if("object"==typeof e){var n={};for(var o in e)n[o]=serializeObject(e[o]);return n}return e}}function strEnum(e){for(var t={},r=0,n=e;r<n.length;r++){var o=n[r];t[o]=o}return t}var MapperType=strEnum(["Base64Url","Boolean","ByteArray","Composite","Date","DateTime","DateTimeRfc1123","Dictionary","Enum","Number","Object","Sequence","String","Stream","TimeSpan","UnixTime"]);function isWebResourceLike(e){return"object"==typeof e&&!("string"!=typeof e.url||"string"!=typeof e.method||"object"!=typeof e.headers||!isHttpHeadersLike(e.headers)||"function"!=typeof e.validateRequestProperties||"function"!=typeof e.prepare||"function"!=typeof e.clone)}var WebResource=function(){function e(e,t,r,n,o,i,s,a,c,u,l,p,d,h){this.streamResponseBody=i,this.url=e||"",this.method=t||"GET",this.headers=isHttpHeadersLike(o)?o:new HttpHeaders(o),this.body=r,this.query=n,this.formData=void 0,this.withCredentials=s||!1,this.abortSignal=a,this.timeout=c||0,this.onUploadProgress=u,this.onDownloadProgress=l,this.proxySettings=p,this.keepAlive=d,this.decompressResponse=h,this.requestId=this.headers.get("x-ms-client-request-id")||generateUuid()}return e.prototype.validateRequestProperties=function(){if(!this.method)throw new Error("WebResource.method is required.");if(!this.url)throw new Error("WebResource.url is required.")},e.prototype.prepare=function(e){if(!e)throw new Error("options object is required");if(void 0===e.method||null===e.method||"string"!=typeof e.method.valueOf())throw new Error("options.method must be a string.");if(e.url&&e.pathTemplate)throw new Error("options.url and options.pathTemplate are mutually exclusive. Please provide exactly one of them.");if(!(void 0!==e.pathTemplate&&null!==e.pathTemplate&&"string"==typeof e.pathTemplate.valueOf()||void 0!==e.url&&null!==e.url&&"string"==typeof e.url.valueOf()))throw new Error("Please provide exactly one of options.pathTemplate or options.url.");if(e.url){if("string"!=typeof e.url)throw new Error('options.url must be of type "string".');this.url=e.url}if(e.method){var t=["GET","PUT","HEAD","DELETE","OPTIONS","POST","PATCH","TRACE"];if(-1===t.indexOf(e.method.toUpperCase()))throw new Error('The provided method "'+e.method+'" is invalid. Supported HTTP methods are: '+JSON.stringify(t))}if(this.method=e.method.toUpperCase(),e.pathTemplate){var r=e.pathTemplate,n=e.pathParameters;if("string"!=typeof r)throw new Error('options.pathTemplate must be of type "string".');e.baseUrl||(e.baseUrl="https://management.azure.com");var o=e.baseUrl,i=o+(o.endsWith("/")?"":"/")+(r.startsWith("/")?r.slice(1):r),s=i.match(/({[\w-]*\s*[\w-]*})/gi);if(s&&s.length){if(!n)throw new Error("pathTemplate: "+r+" has been provided. Hence, options.pathParameters must also be provided.");s.forEach((function(e){var t=e.slice(1,-1),o=n[t];if(null==o||"string"!=typeof o&&"object"!=typeof o){var s=JSON.stringify(n,void 0,2);throw new Error("pathTemplate: "+r+" contains the path parameter "+t+" however, it is not present in parameters: "+s+'.The value of the path parameter can either be a "string" of the form { '+t+': "some sample value" } or it can be an "object" of the form { "'+t+'": { value: "some sample value", skipUrlEncoding: true } }.')}if("string"==typeof o.valueOf()&&(i=i.replace(e,encodeURIComponent(o))),"object"==typeof o.valueOf()){if(!o.value)throw new Error("options.pathParameters["+t+'] is of type "object" but it does not contain a "value" property.');i=o.skipUrlEncoding?i.replace(e,o.value):i.replace(e,encodeURIComponent(o.value))}}))}this.url=i}if(e.queryParameters){var a=e.queryParameters;if("object"!=typeof a)throw new Error('options.queryParameters must be of type object. It should be a JSON object of "query-parameter-name" as the key and the "query-parameter-value" as the value. The "query-parameter-value" may be fo type "string" or an "object" of the form { value: "query-parameter-value", skipUrlEncoding: true }.');this.url&&-1===this.url.indexOf("?")&&(this.url+="?");var c=[];for(var u in this.query={},a){var l=a[u];if(l)if("string"==typeof l)c.push(u+"="+encodeURIComponent(l)),this.query[u]=encodeURIComponent(l);else if("object"==typeof l){if(!l.value)throw new Error("options.queryParameters["+u+'] is of type "object" but it does not contain a "value" property.');l.skipUrlEncoding?(c.push(u+"="+l.value),this.query[u]=l.value):(c.push(u+"="+encodeURIComponent(l.value)),this.query[u]=encodeURIComponent(l.value))}}this.url+=c.join("&")}if(e.headers)for(var p=e.headers,d=0,h=Object.keys(e.headers);d<h.length;d++){var f=h[d];this.headers.set(f,p[f])}return this.headers.get("accept-language")||this.headers.set("accept-language","en-US"),this.headers.get("x-ms-client-request-id")||e.disableClientRequestId||this.headers.set("x-ms-client-request-id",this.requestId),this.headers.get("Content-Type")||this.headers.set("Content-Type","application/json; charset=utf-8"),this.body=e.body,void 0!==e.body&&null!==e.body&&(e.bodyIsStream?(this.headers.get("Transfer-Encoding")||this.headers.set("Transfer-Encoding","chunked"),"application/octet-stream"!==this.headers.get("Content-Type")&&this.headers.set("Content-Type","application/octet-stream")):(e.serializationMapper&&(this.body=new Serializer(e.mappers).serialize(e.serializationMapper,e.body,"requestBody")),e.disableJsonStringifyOnBody||(this.body=JSON.stringify(e.body)))),e.spanOptions&&(this.spanOptions=e.spanOptions),this.abortSignal=e.abortSignal,this.onDownloadProgress=e.onDownloadProgress,this.onUploadProgress=e.onUploadProgress,this},e.prototype.clone=function(){var t=new e(this.url,this.method,this.body,this.query,this.headers&&this.headers.clone(),this.streamResponseBody,this.withCredentials,this.abortSignal,this.timeout,this.onUploadProgress,this.onDownloadProgress,this.proxySettings,this.keepAlive,this.decompressResponse);return this.formData&&(t.formData=this.formData),this.operationSpec&&(t.operationSpec=this.operationSpec),this.shouldDeserialize&&(t.shouldDeserialize=this.shouldDeserialize),this.operationResponseGetter&&(t.operationResponseGetter=this.operationResponseGetter),t},e}(),extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function __extends(e,t){function r(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function __values(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}var listenersMap=new WeakMap,abortedMap=new WeakMap,AbortSignal=function(){function e(){this.onabort=null,listenersMap.set(this,[]),abortedMap.set(this,!1)}return Object.defineProperty(e.prototype,"aborted",{get:function(){if(!abortedMap.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");return abortedMap.get(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"none",{get:function(){return new e},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(e,t){if(!listenersMap.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");listenersMap.get(this).push(t)},e.prototype.removeEventListener=function(e,t){if(!listenersMap.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");var r=listenersMap.get(this),n=r.indexOf(t);n>-1&&r.splice(n,1)},e.prototype.dispatchEvent=function(e){throw new Error("This is a stub dispatchEvent implementation that should not be used.  It only exists for type-checking purposes.")},e}();function abortSignal(e){if(!e.aborted){e.onabort&&e.onabort.call(e);var t=listenersMap.get(e);t&&t.forEach((function(t){t.call(e,{type:"abort"})})),abortedMap.set(e,!0)}}var AbortError=function(e){function t(t){var r=e.call(this,t)||this;return r.name="AbortError",r}return __extends(t,e),t}(Error),AbortController=function(){function e(e){var t=this;if(this._signal=new AbortSignal,e){Array.isArray(e)||(e=arguments);for(var r=0,n=e;r<n.length;r++){var o=n[r];o.aborted?this.abort():o.addEventListener("abort",(function(){t.abort()}))}}}return Object.defineProperty(e.prototype,"signal",{get:function(){return this._signal},enumerable:!0,configurable:!0}),e.prototype.abort=function(){abortSignal(this._signal)},e.timeout=function(e){var t=new AbortSignal,r=setTimeout(abortSignal,e,t);return"function"==typeof r.unref&&r.unref(),t},e}(),extendStatics$1=function(e,t){return(extendStatics$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function __extends$1(e,t){function r(){this.constructor=e}extendStatics$1(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function __rest(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function __awaiter(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function __generator(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function __spreadArrays(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}var custom={},URLQuery=function(){function e(){this._rawQuery={}}return e.prototype.any=function(){return Object.keys(this._rawQuery).length>0},e.prototype.keys=function(){return Object.keys(this._rawQuery)},e.prototype.set=function(e,t){if(e)if(null!=t){var r=Array.isArray(t)?t:t.toString();this._rawQuery[e]=r}else delete this._rawQuery[e]},e.prototype.get=function(e){return e?this._rawQuery[e]:void 0},e.prototype.toString=function(){var e="";for(var t in this._rawQuery){e&&(e+="&");var r=this._rawQuery[t];if(Array.isArray(r)){for(var n=[],o=0,i=r;o<i.length;o++){var s=i[o];n.push(t+"="+s)}e+=n.join("&")}else e+=t+"="+r}return e},e.parse=function(t){var r=new e;if(t){t.startsWith("?")&&(t=t.substring(1));for(var n="ParameterName",o="",i="",s=0;s<t.length;++s){var a=t[s];switch(n){case"ParameterName":switch(a){case"=":n="ParameterValue";break;case"&":o="",i="";break;default:o+=a}break;case"ParameterValue":switch(a){case"=":o="",i="",n="Invalid";break;case"&":r.set(o,i),o="",i="",n="ParameterName";break;default:i+=a}break;case"Invalid":"&"===a&&(n="ParameterName");break;default:throw new Error("Unrecognized URLQuery parse state: "+n)}}"ParameterValue"===n&&r.set(o,i)}return r},e}(),URLBuilder=function(){function e(){}return e.prototype.setScheme=function(e){e?this.set(e,"SCHEME"):this._scheme=void 0},e.prototype.getScheme=function(){return this._scheme},e.prototype.setHost=function(e){e?this.set(e,"SCHEME_OR_HOST"):this._host=void 0},e.prototype.getHost=function(){return this._host},e.prototype.setPort=function(e){null==e||""===e?this._port=void 0:this.set(e.toString(),"PORT")},e.prototype.getPort=function(){return this._port},e.prototype.setPath=function(e){if(e){var t=e.indexOf("://");if(-1!==t){var r=e.lastIndexOf("/",t);this.set(-1===r?e:e.substr(r+1),"SCHEME")}else this.set(e,"PATH")}else this._path=void 0},e.prototype.appendPath=function(e){if(e){var t=this.getPath();t&&(t.endsWith("/")||(t+="/"),e.startsWith("/")&&(e=e.substring(1)),e=t+e),this.set(e,"PATH")}},e.prototype.getPath=function(){return this._path},e.prototype.setQuery=function(e){this._query=e?URLQuery.parse(e):void 0},e.prototype.setQueryParameter=function(e,t){e&&(this._query||(this._query=new URLQuery),this._query.set(e,t))},e.prototype.getQueryParameterValue=function(e){return this._query?this._query.get(e):void 0},e.prototype.getQuery=function(){return this._query?this._query.toString():void 0},e.prototype.set=function(e,t){for(var r=new URLTokenizer(e,t);r.next();){var n=r.current(),o=void 0;if(n)switch(n.type){case"SCHEME":this._scheme=n.text||void 0;break;case"HOST":this._host=n.text||void 0;break;case"PORT":this._port=n.text||void 0;break;case"PATH":o=n.text||void 0,this._path&&"/"!==this._path&&"/"===o||(this._path=o);break;case"QUERY":this._query=URLQuery.parse(n.text);break;default:throw new Error("Unrecognized URLTokenType: "+n.type)}}},e.prototype.toString=function(){var e="";return this._scheme&&(e+=this._scheme+"://"),this._host&&(e+=this._host),this._port&&(e+=":"+this._port),this._path&&(this._path.startsWith("/")||(e+="/"),e+=this._path),this._query&&this._query.any()&&(e+="?"+this._query.toString()),e},e.prototype.replaceAll=function(e,t){e&&(this.setScheme(replaceAll(this.getScheme(),e,t)),this.setHost(replaceAll(this.getHost(),e,t)),this.setPort(replaceAll(this.getPort(),e,t)),this.setPath(replaceAll(this.getPath(),e,t)),this.setQuery(replaceAll(this.getQuery(),e,t)))},e.parse=function(t){var r=new e;return r.set(t,"SCHEME_OR_HOST"),r},e}(),URLToken=function(){function e(e,t){this.text=e,this.type=t}return e.scheme=function(t){return new e(t,"SCHEME")},e.host=function(t){return new e(t,"HOST")},e.port=function(t){return new e(t,"PORT")},e.path=function(t){return new e(t,"PATH")},e.query=function(t){return new e(t,"QUERY")},e}();function isAlphaNumericCharacter(e){var t=e.charCodeAt(0);return 48<=t&&t<=57||65<=t&&t<=90||97<=t&&t<=122}var URLTokenizer=function(){function e(e,t){this._text=e,this._textLength=e?e.length:0,this._currentState=null!=t?t:"SCHEME_OR_HOST",this._currentIndex=0}return e.prototype.current=function(){return this._currentToken},e.prototype.next=function(){if(hasCurrentCharacter(this))switch(this._currentState){case"SCHEME":nextScheme(this);break;case"SCHEME_OR_HOST":nextSchemeOrHost(this);break;case"HOST":nextHost(this);break;case"PORT":nextPort(this);break;case"PATH":nextPath(this);break;case"QUERY":nextQuery(this);break;default:throw new Error("Unrecognized URLTokenizerState: "+this._currentState)}else this._currentToken=void 0;return!!this._currentToken},e}();function readRemaining(e){var t="";return e._currentIndex<e._textLength&&(t=e._text.substring(e._currentIndex),e._currentIndex=e._textLength),t}function hasCurrentCharacter(e){return e._currentIndex<e._textLength}function getCurrentCharacter(e){return e._text[e._currentIndex]}function nextCharacter(e,t){hasCurrentCharacter(e)&&(t||(t=1),e._currentIndex+=t)}function peekCharacters(e,t){var r=e._currentIndex+t;return e._textLength<r&&(r=e._textLength),e._text.substring(e._currentIndex,r)}function readWhile(e,t){for(var r="";hasCurrentCharacter(e);){var n=getCurrentCharacter(e);if(!t(n))break;r+=n,nextCharacter(e)}return r}function readWhileLetterOrDigit(e){return readWhile(e,(function(e){return isAlphaNumericCharacter(e)}))}function readUntilCharacter(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return readWhile(e,(function(e){return-1===t.indexOf(e)}))}function nextScheme(e){var t=readWhileLetterOrDigit(e);e._currentToken=URLToken.scheme(t),hasCurrentCharacter(e)?e._currentState="HOST":e._currentState="DONE"}function nextSchemeOrHost(e){var t=readUntilCharacter(e,":","/","?");hasCurrentCharacter(e)?":"===getCurrentCharacter(e)?"://"===peekCharacters(e,3)?(e._currentToken=URLToken.scheme(t),e._currentState="HOST"):(e._currentToken=URLToken.host(t),e._currentState="PORT"):(e._currentToken=URLToken.host(t),"/"===getCurrentCharacter(e)?e._currentState="PATH":e._currentState="QUERY"):(e._currentToken=URLToken.host(t),e._currentState="DONE")}function nextHost(e){"://"===peekCharacters(e,3)&&nextCharacter(e,3);var t=readUntilCharacter(e,":","/","?");e._currentToken=URLToken.host(t),hasCurrentCharacter(e)?":"===getCurrentCharacter(e)?e._currentState="PORT":"/"===getCurrentCharacter(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}function nextPort(e){":"===getCurrentCharacter(e)&&nextCharacter(e);var t=readUntilCharacter(e,"/","?");e._currentToken=URLToken.port(t),hasCurrentCharacter(e)?"/"===getCurrentCharacter(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}function nextPath(e){var t=readUntilCharacter(e,"?");e._currentToken=URLToken.path(t),hasCurrentCharacter(e)?e._currentState="QUERY":e._currentState="DONE"}function nextQuery(e){"?"===getCurrentCharacter(e)&&nextCharacter(e);var t=readRemaining(e);e._currentToken=URLToken.query(t),e._currentState="DONE"}var RedactedString="REDACTED",defaultAllowedHeaderNames=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent"],defaultAllowedQueryParameters=["api-version"],Sanitizer=function(){function e(e){var t=void 0===e?{}:e,r=t.allowedHeaderNames,n=void 0===r?[]:r,o=t.allowedQueryParameters,i=void 0===o?[]:o;n=Array.isArray(n)?defaultAllowedHeaderNames.concat(n):defaultAllowedHeaderNames,i=Array.isArray(i)?defaultAllowedQueryParameters.concat(i):defaultAllowedQueryParameters,this.allowedHeaderNames=new Set(n.map((function(e){return e.toLowerCase()}))),this.allowedQueryParameters=new Set(i.map((function(e){return e.toLowerCase()})))}return e.prototype.sanitize=function(e){return JSON.stringify(e,this.replacer.bind(this),2)},e.prototype.replacer=function(e,t){return t instanceof Error?__assign(__assign({},t),{name:t.name,message:t.message}):"_headersMap"===e?this.sanitizeHeaders(e,t):"url"===e?this.sanitizeUrl(t):"query"===e?this.sanitizeQuery(t):"body"!==e&&"response"!==e&&"operationSpec"!==e?t:void 0},e.prototype.sanitizeHeaders=function(e,t){return this.sanitizeObject(t,this.allowedHeaderNames,(function(e,t){return e[t].value}))},e.prototype.sanitizeQuery=function(e){return this.sanitizeObject(e,this.allowedQueryParameters,(function(e,t){return e[t]}))},e.prototype.sanitizeObject=function(e,t,r){if("object"!=typeof e||null===e)return e;for(var n={},o=0,i=Object.keys(e);o<i.length;o++){var s=i[o];t.has(s.toLowerCase())?n[s]=r(e,s):n[s]=RedactedString}return n},e.prototype.sanitizeUrl=function(e){if("string"!=typeof e||null===e)return e;var t=URLBuilder.parse(e),r=t.getQuery();if(!r)return e;for(var n=URLQuery.parse(r),o=0,i=n.keys();o<i.length;o++){var s=i[o];this.allowedQueryParameters.has(s.toLowerCase())||n.set(s,RedactedString)}return t.setQuery(n.toString()),t.toString()},e}(),errorSanitizer=new Sanitizer,RestError=function(e){function t(r,n,o,i,s){var a=e.call(this,r)||this;return a.name="RestError",a.code=n,a.statusCode=o,a.request=i,a.response=s,Object.setPrototypeOf(a,t.prototype),a}return __extends$1(t,e),t.prototype[custom]=function(){return"RestError: "+this.message+" \n "+errorSanitizer.sanitize(this)},t.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",t.PARSE_ERROR="PARSE_ERROR",t}(Error),XhrHttpClient=function(){function e(){}return e.prototype.sendRequest=function(e){var t=new XMLHttpRequest;if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");var r=e.abortSignal;if(r){if(r.aborted)return Promise.reject(new AbortError("The operation was aborted."));var n=function(){t.abort()};r.addEventListener("abort",n),t.addEventListener("readystatechange",(function(){t.readyState===XMLHttpRequest.DONE&&r.removeEventListener("abort",n)}))}if(addProgressListener(t.upload,e.onUploadProgress),addProgressListener(t,e.onDownloadProgress),e.formData){for(var o=e.formData,i=new FormData,s=function(e,t){t&&t.hasOwnProperty("value")&&t.hasOwnProperty("options")?i.append(e,t.value,t.options):i.append(e,t)},a=0,c=Object.keys(o);a<c.length;a++){var u=c[a],l=o[u];if(Array.isArray(l))for(var p=0;p<l.length;p++)s(u,l[p]);else s(u,l)}e.body=i,e.formData=void 0;var d=e.headers.get("Content-Type");d&&-1!==d.indexOf("multipart/form-data")&&e.headers.remove("Content-Type")}t.open(e.method,e.url),t.timeout=e.timeout,t.withCredentials=e.withCredentials;for(var h=0,f=e.headers.headersArray();h<f.length;h++){var y=f[h];t.setRequestHeader(y.name,y.value)}return t.responseType=e.streamResponseBody?"blob":"text",t.send(void 0===e.body?null:e.body),e.streamResponseBody?new Promise((function(r,n){t.addEventListener("readystatechange",(function(){if(t.readyState===XMLHttpRequest.HEADERS_RECEIVED){var n=new Promise((function(r,n){t.addEventListener("load",(function(){r(t.response)})),rejectOnTerminalEvent(e,t,n)}));r({request:e,status:t.status,headers:parseHeaders(t),blobBody:n})}})),rejectOnTerminalEvent(e,t,n)})):new Promise((function(r,n){t.addEventListener("load",(function(){return r({request:e,status:t.status,headers:parseHeaders(t),bodyAsText:t.responseText})})),rejectOnTerminalEvent(e,t,n)}))},e}(),HttpPipelineLogLevel;function addProgressListener(e,t){t&&e.addEventListener("progress",(function(e){return t({loadedBytes:e.loaded})}))}function parseHeaders(e){for(var t=new HttpHeaders,r=0,n=e.getAllResponseHeaders().trim().split(/[\r\n]+/);r<n.length;r++){var o=n[r],i=o.indexOf(":"),s=o.slice(0,i),a=o.slice(i+2);t.set(s,a)}return t}function rejectOnTerminalEvent(e,t,r){t.addEventListener("error",(function(){return r(new RestError("Failed to send request to "+e.url,RestError.REQUEST_SEND_ERROR,void 0,e))}));var n=new AbortError("The operation was aborted.");t.addEventListener("abort",(function(){return r(n)})),t.addEventListener("timeout",(function(){return r(n)}))}function operationOptionsToRequestOptionsBase(e){var t=e.requestOptions,r=e.tracingOptions,n=__rest(e,["requestOptions","tracingOptions"]);return t&&(n=__assign(__assign({},n),t)),r&&(n.spanOptions=r.spanOptions),n}function isTokenCredential(e){return e&&"function"==typeof e.getToken&&(void 0===e.signRequest||e.getToken.length>0)}!function(e){e[e.OFF=0]="OFF",e[e.ERROR=1]="ERROR",e[e.WARNING=2]="WARNING",e[e.INFO=3]="INFO"}(HttpPipelineLogLevel||(HttpPipelineLogLevel={}));var BaseRequestPolicy=function(){function e(e,t){this._nextPolicy=e,this._options=t}return e.prototype.shouldLog=function(e){return this._options.shouldLog(e)},e.prototype.log=function(e,t){this._options.log(e,t)},e}(),RequestPolicyOptions=function(){function e(e){this._logger=e}return e.prototype.shouldLog=function(e){return!!this._logger&&e!==HttpPipelineLogLevel.OFF&&e<=this._logger.minimumLogLevel},e.prototype.log=function(e,t){this._logger&&this.shouldLog(e)&&this._logger.log(e,t)},e}(),logFunction=console.debug||console.log;function log(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];logFunction.apply(void 0,__spread(e))}var debugEnvVariable="undefined"!=typeof process&&process.env&&process.env.DEBUG||void 0,enabledString,enabledNamespaces=[],skippedNamespaces=[],debuggers=[];function enable(e){var t,r,n,o;enabledString=e,enabledNamespaces=[],skippedNamespaces=[];var i=/\*/g,s=e.split(",").map((function(e){return e.trim().replace(i,".*?")}));try{for(var a=__values(s),c=a.next();!c.done;c=a.next()){var u=c.value;u.startsWith("-")?skippedNamespaces.push(new RegExp("^"+u.substr(1)+"$")):enabledNamespaces.push(new RegExp("^"+u+"$"))}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}try{for(var l=__values(debuggers),p=l.next();!p.done;p=l.next()){var d=p.value;d.enabled=enabled(d.namespace)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}}function enabled(e){var t,r,n,o;if(e.endsWith("*"))return!0;try{for(var i=__values(skippedNamespaces),s=i.next();!s.done;s=i.next())if(s.value.test(e))return!1}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}try{for(var a=__values(enabledNamespaces),c=a.next();!c.done;c=a.next())if(c.value.test(e))return!0}catch(e){n={error:e}}finally{try{c&&!c.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return!1}function disable(){var e=enabledString||"";return enable(""),e}function createDebugger(e){var t=Object.assign((function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];t.enabled&&(r.length>0&&(r[0]=e+" "+r[0]),t.log.apply(t,__spread(r)))}),{enabled:enabled(e),destroy,log:debugObj.log,namespace:e,extend});return debuggers.push(t),t}function destroy(){var e=debuggers.indexOf(this);return e>=0&&(debuggers.splice(e,1),!0)}function extend(e){var t=createDebugger(this.namespace+":"+e);return t.log=this.log,t}debugEnvVariable&&enable(debugEnvVariable);var debugObj=Object.assign((function(e){return createDebugger(e)}),{enable,enabled,disable,log}),registeredLoggers=new Set,logLevelFromEnv="undefined"!=typeof process&&process.env&&process.env.AZURE_LOG_LEVEL||void 0,azureLogLevel,AzureLogger=debugObj("azure");AzureLogger.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];debugObj.log.apply(debugObj,__spread(e))};var AZURE_LOG_LEVELS=["verbose","info","warning","error"];function setLogLevel(e){var t,r;if(e&&!isAzureLogLevel(e))throw new Error("Unknown log level '"+e+"'. Acceptable values: "+AZURE_LOG_LEVELS.join(","));azureLogLevel=e;var n=[];try{for(var o=__values(registeredLoggers),i=o.next();!i.done;i=o.next()){var s=i.value;shouldEnable(s)&&n.push(s.namespace)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}debugObj.enable(n.join(","))}logLevelFromEnv&&(isAzureLogLevel(logLevelFromEnv)?setLogLevel(logLevelFromEnv):console.error("AZURE_LOG_LEVEL set to unknown log level '"+logLevelFromEnv+"'; logging is not enabled. Acceptable values: "+AZURE_LOG_LEVELS.join(", ")+"."));var levelMap={verbose:400,info:300,warning:200,error:100};function createClientLogger(e){var t=AzureLogger.extend(e);return patchLogMethod(AzureLogger,t),{error:createLogger(t,"error"),warning:createLogger(t,"warning"),info:createLogger(t,"info"),verbose:createLogger(t,"verbose")}}function patchLogMethod(e,t){t.log=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e.log.apply(e,__spread(t))}}function createLogger(e,t){var r=Object.assign(e.extend(t),{level:t});if(patchLogMethod(e,r),shouldEnable(r)){var n=debugObj.disable();debugObj.enable(n+","+r.namespace)}return registeredLoggers.add(r),r}function shouldEnable(e){return!!(azureLogLevel&&levelMap[e.level]<=levelMap[azureLogLevel])}function isAzureLogLevel(e){return AZURE_LOG_LEVELS.includes(e)}var logger=createClientLogger("core-http");function logPolicy(e){return void 0===e&&(e={}),{create:function(t,r){return new LogPolicy(t,r,e)}}}var LogPolicy=function(e){function t(t,r,n){var o=void 0===n?{}:n,i=o.logger,s=void 0===i?logger.info:i,a=o.allowedHeaderNames,c=void 0===a?[]:a,u=o.allowedQueryParameters,l=void 0===u?[]:u,p=e.call(this,t,r)||this;return p.logger=s,p.sanitizer=new Sanitizer({allowedHeaderNames:c,allowedQueryParameters:l}),p}return __extends$1(t,e),Object.defineProperty(t.prototype,"allowedHeaderNames",{get:function(){return this.sanitizer.allowedHeaderNames},set:function(e){this.sanitizer.allowedHeaderNames=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowedQueryParameters",{get:function(){return this.sanitizer.allowedQueryParameters},set:function(e){this.sanitizer.allowedQueryParameters=e},enumerable:!1,configurable:!0}),t.prototype.sendRequest=function(e){var t=this;return this.logger.enabled?(this.logRequest(e),this._nextPolicy.sendRequest(e).then((function(e){return t.logResponse(e)}))):this._nextPolicy.sendRequest(e)},t.prototype.logRequest=function(e){this.logger("Request: "+this.sanitizer.sanitize(e))},t.prototype.logResponse=function(e){return this.logger("Response status code: "+e.status),this.logger("Headers: "+this.sanitizer.sanitize(e.headers)),e},t}(BaseRequestPolicy);function getPathStringFromParameter(e){return getPathStringFromParameterPath(e.parameterPath,e.mapper)}function getPathStringFromParameterPath(e,t){return"string"==typeof e?e:Array.isArray(e)?e.join("."):t.serializedName}function isStreamOperation(e){var t=!1;for(var r in e.responses){var n=e.responses[r];if(n.bodyMapper&&n.bodyMapper.type.name===MapperType.Stream){t=!0;break}}return t}var doc=document.implementation.createDocument(null,null,null),parser=new DOMParser;function parseXML(e,t){try{var r=parser.parseFromString(e,"application/xml");throwIfError(r);var n;return n=t&&t.includeRoot?domToObject(r):domToObject(r.childNodes[0]),Promise.resolve(n)}catch(e){return Promise.reject(e)}}var errorNS="";try{errorNS=parser.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(e){}function throwIfError(e){if(errorNS){var t=e.getElementsByTagNameNS(errorNS,"parsererror");if(t.length)throw new Error(t.item(0).innerHTML)}}function isElement(e){return!!e.attributes}function asElementWithAttributes(e){return isElement(e)&&e.hasAttributes()?e:void 0}function domToObject(e){var t={},r=e.childNodes.length,n=e.childNodes[0],o=n&&1===r&&n.nodeType===Node.TEXT_NODE&&n.nodeValue||void 0,i=asElementWithAttributes(e);if(i){t.$={};for(var s=0;s<i.attributes.length;s++){var a=i.attributes[s];t.$[a.nodeName]=a.nodeValue}o&&(t._=o)}else 0===r?t="":o&&(t=o);if(!o)for(s=0;s<r;s++){var c=e.childNodes[s];if(c.nodeType!==Node.TEXT_NODE){var u=domToObject(c);t[c.nodeName]?Array.isArray(t[c.nodeName])?t[c.nodeName].push(u):t[c.nodeName]=[t[c.nodeName],u]:t[c.nodeName]=u}}return t}var serializer=new XMLSerializer;function stringifyXML(e,t){var r=buildNode(e,t&&t.rootName||"root")[0];return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+serializer.serializeToString(r)}function buildAttributes(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var o=n[r],i=doc.createAttribute(o);i.value=e[o].toString(),t.push(i)}return t}function buildNode(e,t){if(null==e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return(c=doc.createElement(t)).textContent=null==e?"":e.toString(),[c];if(Array.isArray(e)){for(var r=[],n=0,o=e;n<o.length;n++)for(var i=0,s=buildNode(o[n],t);i<s.length;i++){var a=s[i];r.push(a)}return r}if("object"==typeof e){for(var c=doc.createElement(t),u=0,l=Object.keys(e);u<l.length;u++){var p=l[u];if("$"===p)for(var d=0,h=buildAttributes(e[p]);d<h.length;d++){var f=h[d];c.attributes.setNamedItem(f)}else if("_"===p)c.textContent=e[p].toString();else for(var y=0,g=buildNode(e[p],p);y<g.length;y++)a=g[y],c.appendChild(a)}return[c]}throw new Error("Illegal value passed to buildObject: "+e)}function deserializationPolicy(e){return{create:function(t,r){return new DeserializationPolicy(t,e,r)}}}var defaultJsonContentTypes=["application/json","text/json"],defaultXmlContentTypes=["application/xml","application/atom+xml"],DefaultDeserializationOptions={expectedContentTypes:{json:defaultJsonContentTypes,xml:defaultXmlContentTypes}},DeserializationPolicy=function(e){function t(t,r,n){var o=e.call(this,t,n)||this;return o.jsonContentTypes=r&&r.json||defaultJsonContentTypes,o.xmlContentTypes=r&&r.xml||defaultXmlContentTypes,o}return __extends$1(t,e),t.prototype.sendRequest=function(e){return __awaiter(this,void 0,void 0,(function(){var t=this;return __generator(this,(function(r){return[2,this._nextPolicy.sendRequest(e).then((function(e){return deserializeResponseBody(t.jsonContentTypes,t.xmlContentTypes,e)}))]}))}))},t}(BaseRequestPolicy);function getOperationResponse(e){var t,r=e.request,n=r.operationSpec;if(n){var o=r.operationResponseGetter;t=o?o(n,e):n.responses[e.status]}return t}function shouldDeserializeResponse(e){var t=e.request.shouldDeserialize;return void 0===t||("boolean"==typeof t?t:t(e))}function deserializeResponseBody(e,t,r){return parse(e,t,r).then((function(e){if(!shouldDeserializeResponse(e))return e;var t=e.request.operationSpec;if(!t||!t.responses)return e;var n=getOperationResponse(e),o=Object.keys(t.responses);if(!(0===o.length||1===o.length&&"default"===o[0]?200<=e.status&&e.status<300:n)){var i=t.responses.default;if(!i)return e;var s=i.bodyMapper,a=i.headersMapper,c=isStreamOperation(t)?"Unexpected status code: "+e.status:e.bodyAsText,u=new RestError(c,void 0,e.status,e.request,e);try{if(e.parsedBody){var l=e.parsedBody,p=l.error||l;if(u.code=p.code,p.message&&(u.message=p.message),s){var d=l;t.isXML&&s.type.name===MapperType.Sequence&&(d="object"==typeof l?l[s.xmlElementName]:[]),u.response.parsedBody=t.serializer.deserialize(s,d,"error.response.parsedBody")}}e.headers&&a&&(u.response.parsedHeaders=t.serializer.deserialize(a,e.headers.rawHeaders(),"operationRes.parsedHeaders"))}catch(t){u.message='Error "'+t.message+'" occurred in deserializing the responseBody - "'+e.bodyAsText+'" for the default response.'}throw u}if(n){if(n.bodyMapper){d=e.parsedBody,t.isXML&&n.bodyMapper.type.name===MapperType.Sequence&&(d="object"==typeof d?d[n.bodyMapper.xmlElementName]:[]);try{e.parsedBody=t.serializer.deserialize(n.bodyMapper,d,"operationRes.parsedBody")}catch(u){throw new RestError("Error "+u+" occurred in deserializing the responseBody - "+e.bodyAsText,void 0,e.status,e.request,e)}}else"HEAD"===t.httpMethod&&(e.parsedBody=r.status>=200&&r.status<300);n.headersMapper&&(e.parsedHeaders=t.serializer.deserialize(n.headersMapper,e.headers.rawHeaders(),"operationRes.parsedHeaders"))}return e}))}function parse(e,t,r){var n=function(e){var t='Error "'+e+'" occurred while parsing the response body - '+r.bodyAsText+".",n=e.code||RestError.PARSE_ERROR,o=new RestError(t,n,r.status,r.request,r);return Promise.reject(o)};if(!r.request.streamResponseBody&&r.bodyAsText){var o=r.bodyAsText,i=r.headers.get("Content-Type")||"",s=i?i.split(";").map((function(e){return e.toLowerCase()})):[];if(0===s.length||s.some((function(t){return-1!==e.indexOf(t)})))return new Promise((function(e){r.parsedBody=JSON.parse(o),e(r)})).catch(n);if(s.some((function(e){return-1!==t.indexOf(e)})))return parseXML(o).then((function(e){return r.parsedBody=e,r})).catch(n)}return Promise.resolve(r)}var DEFAULT_CLIENT_RETRY_COUNT=3,DEFAULT_CLIENT_RETRY_INTERVAL=3e4,DEFAULT_CLIENT_MAX_RETRY_INTERVAL=9e4,DEFAULT_CLIENT_MIN_RETRY_INTERVAL=3e3,RetryMode;function isNumber(e){return"number"==typeof e}function shouldRetry(e,t,r,n,o){return!!t(n,o)&&r.retryCount<e}function updateRetryData(e,t,r){void 0===t&&(t={retryCount:0,retryInterval:0}),r&&(t.error&&(r.innerError=t.error),t.error=r),t.retryCount++;var n=Math.pow(2,t.retryCount-1)-1;return n*=.8*e.retryInterval+Math.floor(Math.random()*(.4*e.retryInterval)),t.retryInterval=Math.min(e.minRetryInterval+n,e.maxRetryInterval),t}function exponentialRetryPolicy(e,t,r){return{create:function(n,o){return new ExponentialRetryPolicy(n,o,e,t,r)}}}!function(e){e[e.Exponential=0]="Exponential"}(RetryMode||(RetryMode={}));var DefaultRetryOptions={maxRetries:DEFAULT_CLIENT_RETRY_COUNT,retryDelayInMs:DEFAULT_CLIENT_RETRY_INTERVAL,maxRetryDelayInMs:DEFAULT_CLIENT_MAX_RETRY_INTERVAL},ExponentialRetryPolicy=function(e){function t(t,r,n,o,i){var s=e.call(this,t,r)||this;return s.retryCount=isNumber(n)?n:DEFAULT_CLIENT_RETRY_COUNT,s.retryInterval=isNumber(o)?o:DEFAULT_CLIENT_RETRY_INTERVAL,s.maxRetryInterval=isNumber(i)?i:DEFAULT_CLIENT_MAX_RETRY_INTERVAL,s}return __extends$1(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(r){return retry(t,e,r)})).catch((function(r){return retry(t,e,r.response,void 0,r)}))},t}(BaseRequestPolicy);function retry(e,t,r,n,o){return __awaiter(this,void 0,void 0,(function(){function i(e){var t=null==e?void 0:e.status;return!(void 0===t||t<500&&408!==t||501===t||505===t)}var s,a,c;return __generator(this,(function(u){switch(u.label){case 0:if(n=updateRetryData({retryInterval:e.retryInterval,minRetryInterval:0,maxRetryInterval:e.maxRetryInterval},n,o),(s=t.abortSignal&&t.abortSignal.aborted)||!shouldRetry(e.retryCount,i,n,r))return[3,6];logger.info("Retrying request in "+n.retryInterval),u.label=1;case 1:return u.trys.push([1,4,,5]),[4,delay(n.retryInterval)];case 2:return u.sent(),[4,e._nextPolicy.sendRequest(t.clone())];case 3:return a=u.sent(),[2,retry(e,t,a,n)];case 4:return c=u.sent(),[2,retry(e,t,r,n,c)];case 5:return[3,7];case 6:if(s||o||!r)throw n.error||new RestError("Failed to send the request.",RestError.REQUEST_SEND_ERROR,r&&r.status,r&&r.request,r);return[2,r];case 7:return[2]}}))}))}function generateClientRequestIdPolicy(e){return void 0===e&&(e="x-ms-client-request-id"),{create:function(t,r){return new GenerateClientRequestIdPolicy(t,r,e)}}}var GenerateClientRequestIdPolicy=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o._requestIdHeaderName=n,o}return __extends$1(t,e),t.prototype.sendRequest=function(e){return e.headers.contains(this._requestIdHeaderName)||e.headers.set(this._requestIdHeaderName,e.requestId),this._nextPolicy.sendRequest(e)},t}(BaseRequestPolicy);function getDefaultUserAgentKey(){return"x-ms-useragent"}function getPlatformSpecificData(){var e=window.navigator;return[{key:"OS",value:(e.oscpu||e.platform).replace(" ","")}]}function getRuntimeInfo(){return[{key:"core-http",value:Constants.coreHttpVersion}]}function getUserAgentString(e,t,r){return void 0===t&&(t=" "),void 0===r&&(r="/"),e.map((function(e){var t=e.value?""+r+e.value:"";return""+e.key+t})).join(t)}var getDefaultUserAgentHeaderName=getDefaultUserAgentKey;function getDefaultUserAgentValue(){var e=getRuntimeInfo(),t=getPlatformSpecificData();return getUserAgentString(e.concat(t))}function userAgentPolicy(e){var t=e&&void 0!==e.key&&null!==e.key?e.key:getDefaultUserAgentKey(),r=e&&void 0!==e.value&&null!==e.value?e.value:getDefaultUserAgentValue();return{create:function(e,n){return new UserAgentPolicy(e,n,t,r)}}}var UserAgentPolicy=function(e){function t(t,r,n,o){var i=e.call(this,t,r)||this;return i._nextPolicy=t,i._options=r,i.headerKey=n,i.headerValue=o,i}return __extends$1(t,e),t.prototype.sendRequest=function(e){return this.addUserAgentHeader(e),this._nextPolicy.sendRequest(e)},t.prototype.addUserAgentHeader=function(e){e.headers||(e.headers=new HttpHeaders),!e.headers.get(this.headerKey)&&this.headerValue&&e.headers.set(this.headerKey,this.headerValue)},t}(BaseRequestPolicy),DefaultRedirectOptions={handleRedirects:!0,maxRetries:20};function redirectPolicy(e){return void 0===e&&(e=20),{create:function(t,r){return new RedirectPolicy(t,r,e)}}}var RedirectPolicy=function(e){function t(t,r,n){void 0===n&&(n=20);var o=e.call(this,t,r)||this;return o.maxRetries=n,o}return __extends$1(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e).then((function(e){return handleRedirect(t,e,0)}))},t}(BaseRequestPolicy);function handleRedirect(e,t,r){var n=t.request,o=t.status,i=t.headers.get("location");if(i&&(300===o||307===o||303===o&&"POST"===n.method)&&(!e.maxRetries||r<e.maxRetries)){var s=URLBuilder.parse(n.url);return s.setPath(i),n.url=s.toString(),303===o&&(n.method="GET"),e._nextPolicy.sendRequest(n).then((function(t){return handleRedirect(e,t,r+1)}))}return Promise.resolve(t)}function rpRegistrationPolicy(e){return void 0===e&&(e=30),{create:function(t,r){return new RPRegistrationPolicy(t,r,e)}}}var RPRegistrationPolicy=function(e){function t(t,r,n){void 0===n&&(n=30);var o=e.call(this,t,r)||this;return o._retryTimeout=n,o}return __extends$1(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(r){return registerIfNeeded(t,e,r)}))},t}(BaseRequestPolicy);function registerIfNeeded(e,t,r){if(409===r.status){var n=checkRPNotRegisteredError(r.bodyAsText);if(n){var o=extractSubscriptionUrl(t.url);return registerRP(e,o,n,t).catch((function(){return!1})).then((function(n){return n?(t.headers.set("x-ms-client-request-id",generateUuid()),e._nextPolicy.sendRequest(t.clone())):r}))}}return Promise.resolve(r)}function getRequestEssentials(e,t){void 0===t&&(t=!1);var r=e.clone();return t&&(r.url=e.url),r.headers.set("x-ms-client-request-id",generateUuid()),r.headers.set("Content-Type","application/json; charset=utf-8"),r}function checkRPNotRegisteredError(e){var t,r;if(e){try{r=JSON.parse(e)}catch(e){}if(r&&r.error&&r.error.message&&r.error.code&&"MissingSubscriptionRegistration"===r.error.code){var n=r.error.message.match(/.*'(.*)'/i);n&&(t=n.pop())}}return t}function extractSubscriptionUrl(e){var t=e.match(/.*\/subscriptions\/[a-f0-9-]+\//gi);if(!t||!t[0])throw new Error("Unable to extract subscriptionId from the given url - "+e+".");return t[0]}function registerRP(e,t,r,n){var o=t+"providers/"+r+"/register?api-version=2016-02-01",i=t+"providers/"+r+"?api-version=2016-02-01",s=getRequestEssentials(n);return s.method="POST",s.url=o,e._nextPolicy.sendRequest(s).then((function(t){if(200!==t.status)throw new Error("Autoregistration of "+r+" failed. Please try registering manually.");return getRegistrationStatus(e,i,n)}))}function getRegistrationStatus(e,t,r){var n=getRequestEssentials(r);return n.url=t,n.method="GET",e._nextPolicy.sendRequest(n).then((function(n){var o=n.parsedBody;return!(!n.parsedBody||!o.registrationState||"Registered"!==o.registrationState)||delay(1e3*e._retryTimeout).then((function(){return getRegistrationStatus(e,t,r)}))}))}var TokenRefreshBufferMs=12e4,ExpiringAccessTokenCache=function(){function e(e){void 0===e&&(e=TokenRefreshBufferMs),this.cachedToken=void 0,this.tokenRefreshBufferMs=e}return e.prototype.setCachedToken=function(e){this.cachedToken=e},e.prototype.getCachedToken=function(){return this.cachedToken&&Date.now()+this.tokenRefreshBufferMs>=this.cachedToken.expiresOnTimestamp&&(this.cachedToken=void 0),this.cachedToken},e}();function bearerTokenAuthenticationPolicy(e,t){var r=new ExpiringAccessTokenCache;return{create:function(n,o){return new BearerTokenAuthenticationPolicy(n,o,e,t,r)}}}var BearerTokenAuthenticationPolicy=function(e){function t(t,r,n,o,i){var s=e.call(this,t,r)||this;return s.credential=n,s.scopes=o,s.tokenCache=i,s}return __extends$1(t,e),t.prototype.sendRequest=function(e){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return e.headers||(e.headers=new HttpHeaders),[4,this.getToken({abortSignal:e.abortSignal,tracingOptions:{spanOptions:e.spanOptions}})];case 1:return t=r.sent(),e.headers.set(Constants.HeaderConstants.AUTHORIZATION,"Bearer "+t),[2,this._nextPolicy.sendRequest(e)]}}))}))},t.prototype.getToken=function(e){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return void 0!==(t=this.tokenCache.getCachedToken())?[3,2]:[4,this.credential.getToken(this.scopes,e)];case 1:t=r.sent()||void 0,this.tokenCache.setCachedToken(t),r.label=2;case 2:return[2,t?t.token:void 0]}}))}))},t}(BaseRequestPolicy);function systemErrorRetryPolicy(e,t,r,n){return{create:function(o,i){return new SystemErrorRetryPolicy(o,i,e,t,r,n)}}}var SystemErrorRetryPolicy=function(e){function t(t,r,n,o,i,s){var a=e.call(this,t,r)||this;return a.retryCount=isNumber(n)?n:DEFAULT_CLIENT_RETRY_COUNT,a.retryInterval=isNumber(o)?o:DEFAULT_CLIENT_RETRY_INTERVAL,a.minRetryInterval=isNumber(i)?i:DEFAULT_CLIENT_MIN_RETRY_INTERVAL,a.maxRetryInterval=isNumber(s)?s:DEFAULT_CLIENT_MAX_RETRY_INTERVAL,a}return __extends$1(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).catch((function(r){return retry$1(t,e,r.response,r)}))},t}(BaseRequestPolicy),QueryCollectionFormat;function retry$1(e,t,r,n,o){return __awaiter(this,void 0,void 0,(function(){function i(e,t){return!(!t||!t.code||"ETIMEDOUT"!==t.code&&"ESOCKETTIMEDOUT"!==t.code&&"ECONNREFUSED"!==t.code&&"ECONNRESET"!==t.code&&"ENOENT"!==t.code)}var s;return __generator(this,(function(a){switch(a.label){case 0:if(o=updateRetryData(e,o,n),!shouldRetry(e.retryCount,i,o,r,n))return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,delay(o.retryInterval)];case 2:return a.sent(),[2,e._nextPolicy.sendRequest(t.clone())];case 3:return s=a.sent(),[2,retry$1(e,t,r,s,o)];case 4:return[3,6];case 5:return n?[2,Promise.reject(o.error)]:[2,r];case 6:return[2]}}))}))}!function(e){e.Csv=",",e.Ssv=" ",e.Tsv="\t",e.Pipes="|",e.Multi="Multi"}(QueryCollectionFormat||(QueryCollectionFormat={}));var proxyNotSupportedInBrowser=new Error("ProxyPolicy is not supported in browser environment");function getDefaultProxySettings(e){}function proxyPolicy(e){return{create:function(e,t){throw proxyNotSupportedInBrowser}}}var ProxyPolicy=function(e){function t(t,r){throw e.call(this,t,r),proxyNotSupportedInBrowser}return __extends$1(t,e),t.prototype.sendRequest=function(e){throw proxyNotSupportedInBrowser},t}(BaseRequestPolicy),StatusCodes=Constants.HttpConstants.StatusCodes;function throttlingRetryPolicy(){return{create:function(e,t){return new ThrottlingRetryPolicy(e,t)}}}var ThrottlingRetryPolicy=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o._handleResponse=n||o._defaultResponseHandler,o}return __extends$1(t,e),t.prototype.sendRequest=function(e){return __awaiter(this,void 0,void 0,(function(){var t=this;return __generator(this,(function(r){return[2,this._nextPolicy.sendRequest(e.clone()).then((function(r){return r.status!==StatusCodes.TooManyRequests?r:t._handleResponse(e,r)}))]}))}))},t.prototype._defaultResponseHandler=function(e,r){return __awaiter(this,void 0,void 0,(function(){var n,o,i=this;return __generator(this,(function(s){return(n=r.headers.get(Constants.HeaderConstants.RETRY_AFTER))&&(o=t.parseRetryAfterHeader(n))?[2,delay(o).then((function(t){return i._nextPolicy.sendRequest(e)}))]:[2,r]}))}))},t.parseRetryAfterHeader=function(e){var r=Number(e);return Number.isNaN(r)?t.parseDateRetryAfterHeader(e):1e3*r},t.parseDateRetryAfterHeader=function(e){try{var t=Date.now(),r=Date.parse(e)-t;return Number.isNaN(r)?void 0:r}catch(e){return}},t}(BaseRequestPolicy);function signingPolicy(e){return{create:function(t,r){return new SigningPolicy(t,r,e)}}}var SigningPolicy=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.authenticationProvider=n,o}return __extends$1(t,e),t.prototype.signRequest=function(e){return this.authenticationProvider.signRequest(e)},t.prototype.sendRequest=function(e){var t=this;return this.signRequest(e).then((function(e){return t._nextPolicy.sendRequest(e)}))},t}(BaseRequestPolicy),DefaultKeepAliveOptions={enable:!0};function keepAlivePolicy(e){return{create:function(t,r){return new KeepAlivePolicy(t,r,e||DefaultKeepAliveOptions)}}}var KeepAlivePolicy=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.keepAliveOptions=n,o}return __extends$1(t,e),t.prototype.sendRequest=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return e.keepAlive=this.keepAliveOptions.enable,[2,this._nextPolicy.sendRequest(e)]}))}))},t}(BaseRequestPolicy),getter=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.defaultGetter=function(e,t){return e[t]}}));unwrapExports(getter);var getter_1=getter.defaultGetter,NoopHttpTextPropagator_1=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});class r{inject(e,t,r){}extract(e,t,r){return e}}t.NoopHttpTextPropagator=r,t.NOOP_HTTP_TEXT_PROPAGATOR=new r}));unwrapExports(NoopHttpTextPropagator_1);var NoopHttpTextPropagator_2=NoopHttpTextPropagator_1.NoopHttpTextPropagator,NoopHttpTextPropagator_3=NoopHttpTextPropagator_1.NOOP_HTTP_TEXT_PROPAGATOR,setter=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetter=function(e,t,r){e[t]=r}}));unwrapExports(setter);var setter_1=setter.defaultSetter,EntryValue=createCommonjsModule((function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.EntryTtl||(t.EntryTtl={}))[r.NO_PROPAGATION=0]="NO_PROPAGATION",r[r.UNLIMITED_PROPAGATION=-1]="UNLIMITED_PROPAGATION"}));unwrapExports(EntryValue);var EntryValue_1=EntryValue.EntryTtl,Metric=createCommonjsModule((function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.ValueType||(t.ValueType={}))[r.INT=0]="INT",r[r.DOUBLE=1]="DOUBLE"}));unwrapExports(Metric);var Metric_1=Metric.ValueType,NoopMeter_1=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){}createMeasure(e,r){return t.NOOP_MEASURE_METRIC}createCounter(e,r){return t.NOOP_COUNTER_METRIC}createObserver(e,r){return t.NOOP_OBSERVER_METRIC}}t.NoopMeter=r;class n{constructor(e){this._instrument=e}bind(e){return this._instrument}unbind(e){}clear(){}}t.NoopMetric=n;class o extends n{add(e,t){this.bind(t).add(e)}}t.NoopCounterMetric=o;class i extends n{record(e,t,r,n){void 0===r?this.bind(t).record(e):void 0===n?this.bind(t).record(e,r):this.bind(t).record(e,r,n)}}t.NoopMeasureMetric=i;class s extends n{setCallback(e){}}t.NoopObserverMetric=s;class a{add(e){}}t.NoopBoundCounter=a;class c{record(e,t,r){}}t.NoopBoundMeasure=c;class u{setCallback(e){}}t.NoopBoundObserver=u,t.NOOP_METER=new r,t.NOOP_BOUND_COUNTER=new a,t.NOOP_COUNTER_METRIC=new o(t.NOOP_BOUND_COUNTER),t.NOOP_BOUND_MEASURE=new c,t.NOOP_MEASURE_METRIC=new i(t.NOOP_BOUND_MEASURE),t.NOOP_BOUND_OBSERVER=new u,t.NOOP_OBSERVER_METRIC=new s(t.NOOP_BOUND_OBSERVER)}));unwrapExports(NoopMeter_1);var NoopMeter_2=NoopMeter_1.NoopMeter,NoopMeter_3=NoopMeter_1.NoopMetric,NoopMeter_4=NoopMeter_1.NoopCounterMetric,NoopMeter_5=NoopMeter_1.NoopMeasureMetric,NoopMeter_6=NoopMeter_1.NoopObserverMetric,NoopMeter_7=NoopMeter_1.NoopBoundCounter,NoopMeter_8=NoopMeter_1.NoopBoundMeasure,NoopMeter_9=NoopMeter_1.NoopBoundObserver,NoopMeter_10=NoopMeter_1.NOOP_METER,NoopMeter_11=NoopMeter_1.NOOP_BOUND_COUNTER,NoopMeter_12=NoopMeter_1.NOOP_COUNTER_METRIC,NoopMeter_13=NoopMeter_1.NOOP_BOUND_MEASURE,NoopMeter_14=NoopMeter_1.NOOP_MEASURE_METRIC,NoopMeter_15=NoopMeter_1.NOOP_BOUND_OBSERVER,NoopMeter_16=NoopMeter_1.NOOP_OBSERVER_METRIC,NoopMeterProvider_1=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});class r{getMeter(e,t){return NoopMeter_1.NOOP_METER}}t.NoopMeterProvider=r,t.NOOP_METER_PROVIDER=new r}));unwrapExports(NoopMeterProvider_1);var NoopMeterProvider_2=NoopMeterProvider_1.NoopMeterProvider,NoopMeterProvider_3=NoopMeterProvider_1.NOOP_METER_PROVIDER,trace_flags=createCommonjsModule((function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.TraceFlags||(t.TraceFlags={}))[r.NONE=0]="NONE",r[r.SAMPLED=1]="SAMPLED"}));unwrapExports(trace_flags);var trace_flags_1=trace_flags.TraceFlags,NoopSpan_1=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.INVALID_TRACE_ID="0",t.INVALID_SPAN_ID="0";const r={traceId:t.INVALID_TRACE_ID,spanId:t.INVALID_SPAN_ID,traceFlags:trace_flags.TraceFlags.NONE};class n{constructor(e=r){this._spanContext=e}context(){return this._spanContext}setAttribute(e,t){return this}setAttributes(e){return this}addEvent(e,t){return this}setStatus(e){return this}updateName(e){return this}end(e){}isRecording(){return!1}}t.NoopSpan=n,t.NOOP_SPAN=new n}));unwrapExports(NoopSpan_1);var NoopSpan_2=NoopSpan_1.INVALID_TRACE_ID,NoopSpan_3=NoopSpan_1.INVALID_SPAN_ID,NoopSpan_4=NoopSpan_1.NoopSpan,NoopSpan_5=NoopSpan_1.NOOP_SPAN,NoopTracer_1=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});class r{getCurrentSpan(){return NoopSpan_1.NOOP_SPAN}startSpan(e,t){return NoopSpan_1.NOOP_SPAN}withSpan(e,t){return t()}bind(e,t){return e}}t.NoopTracer=r,t.NOOP_TRACER=new r}));unwrapExports(NoopTracer_1);var NoopTracer_2=NoopTracer_1.NoopTracer,NoopTracer_3=NoopTracer_1.NOOP_TRACER,NoopTracerProvider_1=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});class r{getTracer(e,t){return NoopTracer_1.NOOP_TRACER}}t.NoopTracerProvider=r,t.NOOP_TRACER_PROVIDER=new r}));unwrapExports(NoopTracerProvider_1);var NoopTracerProvider_2=NoopTracerProvider_1.NoopTracerProvider,NoopTracerProvider_3=NoopTracerProvider_1.NOOP_TRACER_PROVIDER,span_kind=createCommonjsModule((function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.SpanKind||(t.SpanKind={}))[r.INTERNAL=0]="INTERNAL",r[r.SERVER=1]="SERVER",r[r.CLIENT=2]="CLIENT",r[r.PRODUCER=3]="PRODUCER",r[r.CONSUMER=4]="CONSUMER"}));unwrapExports(span_kind);var span_kind_1=span_kind.SpanKind,status=createCommonjsModule((function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.CanonicalCode||(t.CanonicalCode={}))[r.OK=0]="OK",r[r.CANCELLED=1]="CANCELLED",r[r.UNKNOWN=2]="UNKNOWN",r[r.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",r[r.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",r[r.NOT_FOUND=5]="NOT_FOUND",r[r.ALREADY_EXISTS=6]="ALREADY_EXISTS",r[r.PERMISSION_DENIED=7]="PERMISSION_DENIED",r[r.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",r[r.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",r[r.ABORTED=10]="ABORTED",r[r.OUT_OF_RANGE=11]="OUT_OF_RANGE",r[r.UNIMPLEMENTED=12]="UNIMPLEMENTED",r[r.INTERNAL=13]="INTERNAL",r[r.UNAVAILABLE=14]="UNAVAILABLE",r[r.DATA_LOSS=15]="DATA_LOSS",r[r.UNAUTHENTICATED=16]="UNAUTHENTICATED"}));unwrapExports(status);var status_1=status.CanonicalCode,context=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e){this._currentContext=e?new Map(e):new Map}static createKey(e){return Symbol(e)}getValue(e){return this._currentContext.get(e)}setValue(e,t){const n=new r(this._currentContext);return n._currentContext.set(e,t),n}deleteValue(e){const t=new r(this._currentContext);return t._currentContext.delete(e),t}}t.Context=r,r.ROOT_CONTEXT=new r,r.TODO=r.ROOT_CONTEXT}));unwrapExports(context);var context_1=context.Context,NoopContextManager_1=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NoopContextManager=class{active(){return context.Context.ROOT_CONTEXT}with(e,t){return t()}bind(e,t){return e}enable(){return this}disable(){return this}}}));unwrapExports(NoopContextManager_1);var NoopContextManager_2=NoopContextManager_1.NoopContextManager,src=createCommonjsModule((function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(context),r(NoopContextManager_1)}));unwrapExports(src);var context$1=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){this._contextManager=new src.NoopContextManager}static getInstance(){return this._instance||(this._instance=new r),this._instance}setGlobalContextManager(e){return this._contextManager=e,e}active(){return this._contextManager.active()}with(e,t){return this._contextManager.with(e,t)}bind(e,t=this.active()){return this._contextManager.bind(e,t)}}t.ContextAPI=r}));unwrapExports(context$1);var context_1$1=context$1.ContextAPI,trace=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){this._tracerProvider=NoopTracerProvider_1.NOOP_TRACER_PROVIDER}static getInstance(){return this._instance||(this._instance=new r),this._instance}setGlobalTracerProvider(e){return this._tracerProvider=e,e}getTracerProvider(){return this._tracerProvider}getTracer(e,t){return this.getTracerProvider().getTracer(e,t)}}t.TraceAPI=r}));unwrapExports(trace);var trace_1=trace.TraceAPI,metrics=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){this._meterProvider=NoopMeterProvider_1.NOOP_METER_PROVIDER}static getInstance(){return this._instance||(this._instance=new r),this._instance}setGlobalMeterProvider(e){return this._meterProvider=e,e}getMeterProvider(){return this._meterProvider}getMeter(e,t){return this.getMeterProvider().getMeter(e,t)}}t.MetricsAPI=r}));unwrapExports(metrics);var metrics_1=metrics.MetricsAPI,propagation=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=context$1.ContextAPI.getInstance();class n{constructor(){this._propagator=NoopHttpTextPropagator_1.NOOP_HTTP_TEXT_PROPAGATOR}static getInstance(){return this._instance||(this._instance=new n),this._instance}setGlobalPropagator(e){return this._propagator=e,e}inject(e,t=setter.defaultSetter,n=r.active()){return this._propagator.inject(n,e,t)}extract(e,t=getter.defaultGetter,n=r.active()){return this._propagator.extract(n,e,t)}}t.PropagationAPI=n}));unwrapExports(propagation);var propagation_1=propagation.PropagationAPI,src$1=createCommonjsModule((function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(getter),r(NoopHttpTextPropagator_1),r(setter),r(EntryValue),r(Metric),r(NoopMeter_1),r(NoopMeterProvider_1),r(NoopSpan_1),r(NoopTracer_1),r(NoopTracerProvider_1),r(span_kind),r(status),r(trace_flags),t.Context=src.Context,t.context=context$1.ContextAPI.getInstance(),t.trace=trace.TraceAPI.getInstance(),t.metrics=metrics.MetricsAPI.getInstance(),t.propagation=propagation.PropagationAPI.getInstance(),t.default={trace:t.trace,metrics:t.metrics,context:t.context,propagation:t.propagation}}));unwrapExports(src$1);var src_1=src$1.CanonicalCode,src_2=src$1.SpanKind,src_3=src$1.TraceFlags,src_4=src$1.Context,src_5=src$1.context,src_6=src$1.trace,src_7=src$1.metrics,src_8=src$1.propagation,NoOpSpan=function(){function e(){}return e.prototype.context=function(){return{spanId:"",traceId:"",traceFlags:src_3.NONE}},e.prototype.end=function(e){},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.isRecording=function(){return!1},e}(),NoOpTracer=function(){function e(){}return e.prototype.startSpan=function(e,t){return new NoOpSpan},e.prototype.getCurrentSpan=function(){return new NoOpSpan},e.prototype.withSpan=function(e,t){return t()},e.prototype.bind=function(e,t){return e},e}();function getGlobalObject(){return self}var GLOBAL_TRACER_VERSION=3,GLOBAL_TRACER_SYMBOL=Symbol.for("@azure/core-tracing.tracerCache2"),cache,defaultTracer;function loadTracerCache(){var e=getGlobalObject(),t=e[GLOBAL_TRACER_SYMBOL],r=!0;if(t)if(t.version===GLOBAL_TRACER_VERSION)cache=t;else if(r=!1,t.tracer)throw new Error("Two incompatible versions of @azure/core-tracing have been loaded.\n          This library is "+GLOBAL_TRACER_VERSION+", existing is "+t.version+".");cache||(cache={tracer:void 0,version:GLOBAL_TRACER_VERSION}),r&&(e[GLOBAL_TRACER_SYMBOL]=cache)}function getCache(){return cache||loadTracerCache(),cache}function getDefaultTracer(){return defaultTracer||(defaultTracer=new NoOpTracer),defaultTracer}function getTracer(){var e=getCache();return e.tracer?e.tracer:getDefaultTracer()}var VERSION="00";function getTraceParentHeader(e){var t=[];if(e.traceId||t.push("traceId"),e.spanId||t.push("spanId"),!t.length){var r=(e.traceFlags||0).toString(16),n=1===r.length?"0"+r:r;return VERSION+"-"+e.traceId+"-"+e.spanId+"-"+n}}function tracingPolicy(e){return void 0===e&&(e={}),{create:function(t,r){return new TracingPolicy(t,r,e)}}}var TracingPolicy=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.userAgent=n.userAgent,o}return __extends$1(t,e),t.prototype.sendRequest=function(e){return __awaiter(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,u,l;return __generator(this,(function(p){switch(p.label){case 0:if(!e.spanOptions||!e.spanOptions.parent)return[2,this._nextPolicy.sendRequest(e)];t=getTracer(),r=__assign(__assign({},e.spanOptions),{kind:src_2.CLIENT}),n=URLBuilder.parse(e.url).getPath()||"/",(o=t.startSpan(n,r)).setAttributes({"http.method":e.method,"http.url":e.url,requestId:e.requestId}),this.userAgent&&o.setAttribute("http.user_agent",this.userAgent),p.label=1;case 1:return p.trys.push([1,3,,4]),i=o.context(),(s=getTraceParentHeader(i))&&(e.headers.set("traceparent",s),(a=i.traceState&&i.traceState.serialize())&&e.headers.set("tracestate",a)),[4,this._nextPolicy.sendRequest(e)];case 2:return c=p.sent(),o.setAttribute("http.status_code",c.status),(u=c.headers.get("x-ms-request-id"))&&o.setAttribute("serviceRequestId",u),o.end(),[2,c];case 3:throw l=p.sent(),o.end(),l;case 4:return[2]}}))}))},t}(BaseRequestPolicy),DisbleResponseDecompressionNotSupportedInBrowser=new Error("DisableResponseDecompressionPolicy is not supported in browser environment");function disableResponseDecompressionPolicy(){return{create:function(e,t){throw DisbleResponseDecompressionNotSupportedInBrowser}}}var DisableResponseDecompressionPolicy=function(e){function t(t,r){throw e.call(this,t,r),DisbleResponseDecompressionNotSupportedInBrowser}return __extends$1(t,e),t.prototype.sendRequest=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){throw DisbleResponseDecompressionNotSupportedInBrowser}))}))},t}(BaseRequestPolicy),ServiceClient=function(){function e(e,t){var r,n,o;if(t||(t={}),this._withCredentials=t.withCredentials||!1,this._httpClient=t.httpClient||new XhrHttpClient,this._requestPolicyOptions=new RequestPolicyOptions(t.httpPipelineLogger),Array.isArray(t.requestPolicyFactories))logger.info("ServiceClient: using custom request policies"),r=t.requestPolicyFactories;else{var i=void 0;if(isTokenCredential(e))logger.info("ServiceClient: creating bearer token authentication policy from provided credentials"),n=void 0,o=this,i={create:function(t,r){return null==n&&(n=bearerTokenAuthenticationPolicy(e,(o.baseUri||"")+"/.default")),n.create(t,r)}};else if(e&&"function"==typeof e.signRequest)logger.info("ServiceClient: creating signing policy from provided credentials"),i=signingPolicy(e);else if(null!=e)throw new Error("The credentials argument must implement the TokenCredential interface");if(logger.info("ServiceClient: using default request policies"),r=createDefaultRequestPolicyFactories(i,t),t.requestPolicyFactories){var s=t.requestPolicyFactories(r);s&&(r=s)}}this._requestPolicyFactories=r}return e.prototype.sendRequest=function(e){if(null==e||"object"!=typeof e)throw new Error("options cannot be null or undefined and it must be of type object.");var t;try{isWebResourceLike(e)?(e.validateRequestProperties(),t=e):t=(t=new WebResource).prepare(e)}catch(e){return Promise.reject(e)}var r=this._httpClient;if(this._requestPolicyFactories&&this._requestPolicyFactories.length>0)for(var n=this._requestPolicyFactories.length-1;n>=0;--n)r=this._requestPolicyFactories[n].create(r,this._requestPolicyOptions);return r.sendRequest(t)},e.prototype.sendOperationRequest=function(e,t,r){return __awaiter(this,void 0,void 0,(function(){var n,o,i,s,a,c,u,l,p,d,h,f,y,g,m,v,T,b,_,R,w,O,C,E,P,S,N,k,A,I;return __generator(this,(function(M){switch(M.label){case 0:"function"==typeof e.options&&(r=e.options,e.options=void 0),n=new WebResource,M.label=1;case 1:if(M.trys.push([1,6,,7]),!(i=t.baseUrl||this.baseUri))throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a baseUri string property that contains the base URL to use.");if(n.method=t.httpMethod,n.operationSpec=t,s=URLBuilder.parse(i),t.path&&s.appendPath(t.path),t.urlParameters&&t.urlParameters.length>0)for(a=0,c=t.urlParameters;a<c.length;a++)u=c[a],l=getOperationArgumentValueFromParameter(this,e,u,t.serializer),l=t.serializer.serialize(u.mapper,l,getPathStringFromParameter(u)),u.skipEncoding||(l=encodeURIComponent(l)),s.replaceAll("{"+(u.mapper.serializedName||getPathStringFromParameter(u))+"}",l);if(t.queryParameters&&t.queryParameters.length>0)for(p=0,d=t.queryParameters;p<d.length;p++)if(h=d[p],null!=(f=getOperationArgumentValueFromParameter(this,e,h,t.serializer))){if(f=t.serializer.serialize(h.mapper,f,getPathStringFromParameter(h)),void 0!==h.collectionFormat&&null!==h.collectionFormat)if(h.collectionFormat===QueryCollectionFormat.Multi)if(0===f.length)f="";else for(g in f)y=f[g],f[g]=null==y?"":y.toString();else h.collectionFormat!==QueryCollectionFormat.Ssv&&h.collectionFormat!==QueryCollectionFormat.Tsv||(f=f.join(h.collectionFormat));if(!h.skipEncoding)if(Array.isArray(f))for(g in f)void 0!==f[g]&&null!==f[g]&&(f[g]=encodeURIComponent(f[g]));else f=encodeURIComponent(f);void 0!==h.collectionFormat&&null!==h.collectionFormat&&h.collectionFormat!==QueryCollectionFormat.Multi&&h.collectionFormat!==QueryCollectionFormat.Ssv&&h.collectionFormat!==QueryCollectionFormat.Tsv&&(f=f.join(h.collectionFormat)),s.setQueryParameter(h.mapper.serializedName||getPathStringFromParameter(h),f)}if(n.url=s.toString(),(m=t.contentType||this.requestContentType)&&n.headers.set("Content-Type",m),t.headerParameters)for(v=0,T=t.headerParameters;v<T.length;v++)if(b=T[v],null!=(_=getOperationArgumentValueFromParameter(this,e,b,t.serializer)))if(_=t.serializer.serialize(b.mapper,_,getPathStringFromParameter(b)),R=b.mapper.headerCollectionPrefix)for(w=0,O=Object.keys(_);w<O.length;w++)C=O[w],n.headers.set(R+C,_[C]);else n.headers.set(b.mapper.serializedName||getPathStringFromParameter(b),_);if(E=e.options){if(E.customHeaders)for(P in E.customHeaders)n.headers.set(P,E.customHeaders[P]);E.abortSignal&&(n.abortSignal=E.abortSignal),E.timeout&&(n.timeout=E.timeout),E.onUploadProgress&&(n.onUploadProgress=E.onUploadProgress),E.onDownloadProgress&&(n.onDownloadProgress=E.onDownloadProgress),E.spanOptions&&(n.spanOptions=E.spanOptions),void 0!==E.shouldDeserialize&&null!==E.shouldDeserialize&&(n.shouldDeserialize=E.shouldDeserialize)}n.withCredentials=this._withCredentials,serializeRequestBody(this,n,e,t),void 0!==n.streamResponseBody&&null!==n.streamResponseBody||(n.streamResponseBody=isStreamOperation(t)),S=void 0,N=void 0,M.label=2;case 2:return M.trys.push([2,4,,5]),[4,this.sendRequest(n)];case 3:return S=M.sent(),[3,5];case 4:return k=M.sent(),N=k,[3,5];case 5:return N?(N.response&&(N.details=flattenResponse(N.response,t.responses[N.statusCode]||t.responses.default)),o=Promise.reject(N)):o=Promise.resolve(flattenResponse(S,t.responses[S.status])),[3,7];case 6:return A=M.sent(),o=Promise.reject(A),[3,7];case 7:return(I=r)&&o.then((function(e){return I(null,e._response.parsedBody,e._response.request,e._response)})).catch((function(e){return I(e)})),[2,o]}}))}))},e}();function serializeRequestBody(e,t,r,n){var o;if(n.requestBody&&n.requestBody.mapper){t.body=getOperationArgumentValueFromParameter(e,r,n.requestBody,n.serializer);var i=n.requestBody.mapper,s=i.required,a=i.xmlName,c=i.xmlElementName,u=i.serializedName,l=i.type.name;try{if(void 0!==t.body&&null!==t.body||s){var p=getPathStringFromParameter(n.requestBody);t.body=n.serializer.serialize(i,t.body,p);var d=l===MapperType.Stream;if(n.isXML)l===MapperType.Sequence?t.body=stringifyXML(prepareXMLRootList(t.body,c||a||u),{rootName:a||u}):d||(t.body=stringifyXML(t.body,{rootName:a||u}));else{if(l===MapperType.String&&((null===(o=n.contentType)||void 0===o?void 0:o.match("text/plain"))||"text"===n.mediaType))return;d||(t.body=JSON.stringify(t.body))}}}catch(e){throw new Error('Error "'+e.message+'" occurred in serializing the payload - '+JSON.stringify(u,void 0,"  ")+".")}}else if(n.formDataParameters&&n.formDataParameters.length>0){t.formData={};for(var h=0,f=n.formDataParameters;h<f.length;h++){var y=f[h],g=getOperationArgumentValueFromParameter(e,r,y,n.serializer);if(null!=g){var m=y.mapper.serializedName||getPathStringFromParameter(y);t.formData[m]=n.serializer.serialize(y.mapper,g,getPathStringFromParameter(y))}}}}function getValueOrFunctionResult(e,t){var r;return"string"==typeof e?r=e:(r=t(),"function"==typeof e&&(r=e(r))),r}function createDefaultRequestPolicyFactories(e,t){var r=[];t.generateClientRequestIdHeader&&r.push(generateClientRequestIdPolicy(t.clientRequestIdHeaderName)),e&&r.push(e);var n=getValueOrFunctionResult(t.userAgentHeaderName,getDefaultUserAgentHeaderName),o=getValueOrFunctionResult(t.userAgent,getDefaultUserAgentValue);return n&&o&&r.push(userAgentPolicy({key:n,value:o})),r.push(redirectPolicy()),r.push(rpRegistrationPolicy(t.rpRegistrationRetryTimeout)),t.noRetryPolicy||(r.push(exponentialRetryPolicy()),r.push(systemErrorRetryPolicy()),r.push(throttlingRetryPolicy())),r.push(deserializationPolicy(t.deserializationContentTypes)),r.push(logPolicy({logger:logger.info})),r}function createPipelineFromOptions(e,t){var r=[],n=void 0;if(e.userAgentOptions&&e.userAgentOptions.userAgentPrefix){var o=[];o.push(e.userAgentOptions.userAgentPrefix);var i=getDefaultUserAgentValue();-1===o.indexOf(i)&&o.push(i),n=o.join(" ")}var s=__assign(__assign({},DefaultKeepAliveOptions),e.keepAliveOptions),a=__assign(__assign({},DefaultRetryOptions),e.retryOptions),c=__assign(__assign({},DefaultRedirectOptions),e.redirectOptions),u=__assign(__assign({},DefaultDeserializationOptions),e.deserializationOptions),l=__assign({},e.loggingOptions);return r.push(tracingPolicy({userAgent:n}),keepAlivePolicy(s),userAgentPolicy({value:n}),generateClientRequestIdPolicy(),deserializationPolicy(u.expectedContentTypes),throttlingRetryPolicy(),systemErrorRetryPolicy(),exponentialRetryPolicy(a.maxRetries,a.retryDelayInMs,a.maxRetryDelayInMs)),c.handleRedirects&&r.push(redirectPolicy(c.maxRetries)),t&&r.push(t),r.push(logPolicy(l)),isNode&&!1===e.decompressResponse&&r.push(disableResponseDecompressionPolicy()),{httpClient:e.httpClient,requestPolicyFactories:r}}function getOperationArgumentValueFromParameter(e,t,r,n){return getOperationArgumentValueFromParameterPath(e,t,r.parameterPath,r.mapper,n)}function getOperationArgumentValueFromParameterPath(e,t,r,n,o){var i;if("string"==typeof r&&(r=[r]),Array.isArray(r)){if(r.length>0){if(n.isConstant)i=n.defaultValue;else{var s=getPropertyFromParameterPath(t,r);s.propertyFound||(s=getPropertyFromParameterPath(e,r));var a=!1;s.propertyFound||(a=n.required||"options"===r[0]&&2===r.length),i=a?n.defaultValue:s.propertyValue}var c=getPathStringFromParameterPath(r,n);o.serialize(n,i,c)}}else for(var u in n.required&&(i={}),r){var l=n.type.modelProperties[u],p=r[u],d=getOperationArgumentValueFromParameterPath(e,t,p,l,o),h=getPathStringFromParameterPath(p,l);o.serialize(l,d,h),null!=d&&(i||(i={}),i[u]=d)}return i}function getPropertyFromParameterPath(e,t){for(var r={propertyFound:!1},n=0;n<t.length;++n){var o=t[n];if(null==e||!(o in e))break;e=e[o]}return n===t.length&&(r.propertyValue=e,r.propertyFound=!0),r}function flattenResponse(e,t){var r=e.parsedHeaders,n=t&&t.bodyMapper,o=function(t){return Object.defineProperty(t,"_response",{value:e})};if(n){var i=n.type.name;if("Stream"===i)return o(__assign(__assign({},r),{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody}));var s="Composite"===i&&n.type.modelProperties||{},a=Object.keys(s).some((function(e){return""===s[e].serializedName}));if("Sequence"===i||a){for(var c=__spreadArrays(e.parsedBody||[]),u=0,l=Object.keys(s);u<l.length;u++){var p=l[u];s[p].serializedName&&(c[p]=e.parsedBody[p])}if(r)for(var d=0,h=Object.keys(r);d<h.length;d++)c[p=h[d]]=r[p];return o(c),c}if("Composite"===i||"Dictionary"===i)return o(__assign(__assign({},r),e.parsedBody))}return n||"HEAD"===e.request.method||isPrimitiveType(e.parsedBody)?o(__assign(__assign({},r),{body:e.parsedBody})):o(__assign(__assign({},r),e.parsedBody))}var HeaderConstants=Constants.HeaderConstants,DEFAULT_AUTHORIZATION_SCHEME="Basic",BasicAuthenticationCredentials=function(){function e(e,t,r){if(void 0===r&&(r=DEFAULT_AUTHORIZATION_SCHEME),this.authorizationScheme=DEFAULT_AUTHORIZATION_SCHEME,null==e||"string"!=typeof e.valueOf())throw new Error("userName cannot be null or undefined and must be of type string.");if(null==t||"string"!=typeof t.valueOf())throw new Error("password cannot be null or undefined and must be of type string.");this.userName=e,this.password=t,this.authorizationScheme=r}return e.prototype.signRequest=function(e){var t=this.userName+":"+this.password,r=this.authorizationScheme+" "+encodeString(t);return e.headers||(e.headers=new HttpHeaders),e.headers.set(HeaderConstants.AUTHORIZATION,r),Promise.resolve(e)},e}(),ApiKeyCredentials=function(){function e(e){if(!e||e&&!e.inHeader&&!e.inQuery)throw new Error('options cannot be null or undefined. Either "inHeader" or "inQuery" property of the options object needs to be provided.');this.inHeader=e.inHeader,this.inQuery=e.inQuery}return e.prototype.signRequest=function(e){if(!e)return Promise.reject(new Error('webResource cannot be null or undefined and must be of type "object".'));if(this.inHeader)for(var t in e.headers||(e.headers=new HttpHeaders),this.inHeader)e.headers.set(t,this.inHeader[t]);if(this.inQuery){if(!e.url)return Promise.reject(new Error("url cannot be null in the request object."));for(var r in e.url.indexOf("?")<0&&(e.url+="?"),this.inQuery)e.url.endsWith("?")||(e.url+="&"),e.url+=r+"="+this.inQuery[r]}return Promise.resolve(e)},e}(),TopicCredentials=function(e){function t(t){if(!t||t&&"string"!=typeof t)throw new Error("topicKey cannot be null or undefined and must be of type string.");var r={inHeader:{"aeg-sas-key":t}};return e.call(this,r)||this}return __extends$1(t,e),t}(ApiKeyCredentials),coreHttp=Object.freeze({__proto__:null,WebResource,DefaultHttpClient:XhrHttpClient,HttpHeaders,get HttpPipelineLogLevel(){return HttpPipelineLogLevel},RestError,operationOptionsToRequestOptionsBase,ServiceClient,flattenResponse,createPipelineFromOptions,get QueryCollectionFormat(){return QueryCollectionFormat},Constants,BearerTokenAuthenticationPolicy,bearerTokenAuthenticationPolicy,logPolicy,BaseRequestPolicy,RequestPolicyOptions,generateClientRequestIdPolicy,exponentialRetryPolicy,get RetryMode(){return RetryMode},systemErrorRetryPolicy,throttlingRetryPolicy,getDefaultProxySettings,proxyPolicy,redirectPolicy,keepAlivePolicy,KeepAlivePolicy,DisableResponseDecompressionPolicy,disableResponseDecompressionPolicy,signingPolicy,userAgentPolicy,getDefaultUserAgentValue,deserializationPolicy,deserializeResponseBody,tracingPolicy,MapperType,Serializer,serializeObject,stripRequest,stripResponse,delay,executePromisesSequentially,generateUuid,encodeUri,promiseToCallback,promiseToServiceCallback,isValidUuid,applyMixins,isNode,isDuration,URLBuilder,URLQuery,isTokenCredential,ExpiringAccessTokenCache,BasicAuthenticationCredentials,ApiKeyCredentials,TopicCredentials,parseXML,stringifyXML}),TrouterSettings=createCommonjsModule((function(e,t){t.__esModule=!0;var r={version:"1.0.0",registrationId:"",sessionId:"",pnhAppId:"AcsWeb",pnhTemplate:"AcsWeb_Chat_1.0",platform:"SPOOL",platformUIVersion:"0.0.0",environment:"",productName:"acs-chat-web",trouterServiceUrl:"https://go.trouter.skype.com/v4/a",registrarServiceUrl:"https://edge.skype.com/registrar/prod/v3/registrations",registrarRefreshTimeoutInMs:35e4,timeoutOptions:{connectionTimeoutMs:2e4,fetchTimeoutMs:1e4,pingTimeoutMs:4e4,pongTimeoutMs:5e3,maxBackoffMs:5e4,requestTimeoutMs:5e3},maxRegistrationTimeInMs:72e5};t.createSettings=function(e){var t,n=r;return n.registrationId=coreHttp.generateUuid(),n.sessionId=coreHttp.generateUuid(),n.maxRegistrationTimeInMs=null!==(t=null==e?void 0:e.registrationTimeInMs)&&void 0!==t?t:r.maxRegistrationTimeInMs,n},t.defaultTelemetrySettings={enabled:!1}}));unwrapExports(TrouterSettings);var TrouterSettings_1=TrouterSettings.createSettings,TrouterSettings_2=TrouterSettings.defaultTelemetrySettings,SignalingClient=createCommonjsModule((function(e,t){var r,n=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=commonjsGlobal&&commonjsGlobal.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};t.__esModule=!0,(r=t.ConnectionState||(t.ConnectionState={}))[r.Unknown=0]="Unknown",r[r.Connected=2]="Connected",r[r.Disconnected=3]="Disconnected",r[r.Switching=9]="Switching";var i=function(){function e(e,t,r){var i=this;this.logger=t,this.stateChangedListener=null,this.trouter=tstrouter.createTrouterService(TrouterUtils.toLogProvider(t)),this.config={trouterSettings:TrouterSettings.createSettings(r),skypeTokenProvider:function(){return n(i,void 0,void 0,(function(){var t,r;return o(this,(function(n){switch(n.label){case 0:return r=(t=Promise).resolve,[4,e.getToken()];case 1:return[2,r.apply(t,[n.sent().token])]}}))}))},telemetryConfig:{eventLogger:TrouterUtils.toTelemetrySender(t),settings:TrouterSettings.defaultTelemetrySettings}}}return e.prototype.start=function(){this.trouter.start(this.config)},e.prototype.stop=function(){this.trouter.offStateChanged(this.stateChangedListener),this.trouter.clearMessageHandlers(),this.trouter.stop()},e.prototype.on=function(e,t){if("connectionChanged"===e)return this.trouter.offStateChanged(this.stateChangedListener),this.stateChangedListener=function(e,r){return t(e)},void this.trouter.onStateChanged(this.stateChangedListener);this.trouter.registerMessageHandler(TrouterUtils.toMessageHandler(e,t))},e}();t.CommunicationSignalingClient=i}));unwrapExports(SignalingClient);var SignalingClient_1=SignalingClient.ConnectionState,SignalingClient_2=SignalingClient.CommunicationSignalingClient,src$2=createCommonjsModule((function(e,t){t.__esModule=!0,function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(SignalingClient)})),index=unwrapExports(src$2);return index},module.exports=factory()},2444:()=>{"use strict";void 0!==typeof Symbol&&Symbol.asyncIterator||(Symbol.asyncIterator=Symbol.for("Symbol.asyncIterator"))},2065:(e,t,r)=>{"use strict";function n(e){return e.toLowerCase()}function o(e){return!(!e||"object"!=typeof e)&&"function"==typeof e.rawHeaders&&"function"==typeof e.clone&&"function"==typeof e.get&&"function"==typeof e.set&&"function"==typeof e.contains&&"function"==typeof e.remove&&"function"==typeof e.headersArray&&"function"==typeof e.headerValues&&"function"==typeof e.headerNames&&"function"==typeof e.toJson}r.d(t,{d:()=>o,W:()=>i});var i=function(){function e(e){if(this._headersMap={},e)for(var t in e)this.set(t,e[t])}return e.prototype.set=function(e,t){this._headersMap[n(e)]={name:e,value:t.toString()}},e.prototype.get=function(e){var t=this._headersMap[n(e)];return t?t.value:void 0},e.prototype.contains=function(e){return!!this._headersMap[n(e)]},e.prototype.remove=function(e){var t=this.contains(e);return delete this._headersMap[n(e)],t},e.prototype.rawHeaders=function(){var e={};for(var t in this._headersMap){var r=this._headersMap[t];e[r.name.toLowerCase()]=r.value}return e},e.prototype.headersArray=function(){var e=[];for(var t in this._headersMap)e.push(this._headersMap[t]);return e},e.prototype.headerNames=function(){for(var e=[],t=this.headersArray(),r=0;r<t.length;++r)e.push(t[r].name);return e},e.prototype.headerValues=function(){for(var e=[],t=this.headersArray(),r=0;r<t.length;++r)e.push(t[r].value);return e},e.prototype.toJson=function(){return this.rawHeaders()},e.prototype.toString=function(){return JSON.stringify(this.toJson())},e.prototype.clone=function(){return new e(this.rawHeaders())},e}()},5383:(e,t,r)=>{"use strict";r.d(t,{t:()=>o});var n=r(1230);function o(e){var t=e.requestOptions,r=e.tracingOptions,o=(0,n._T)(e,["requestOptions","tracingOptions"]);return t&&(o=(0,n.pi)((0,n.pi)({},o),t)),r&&(o.spanOptions=r.spanOptions),o}},72:(e,t,r)=>{"use strict";var n;r.d(t,{U:()=>o,_:()=>i}),function(e){e[e.OFF=0]="OFF",e[e.ERROR=1]="ERROR",e[e.WARNING=2]="WARNING",e[e.INFO=3]="INFO"}(n||(n={}));var o=function(){function e(e,t){this._nextPolicy=e,this._options=t}return e.prototype.shouldLog=function(e){return this._options.shouldLog(e)},e.prototype.log=function(e,t){this._options.log(e,t)},e}(),i=function(){function e(e){this._logger=e}return e.prototype.shouldLog=function(e){return!!this._logger&&e!==n.OFF&&e<=this._logger.minimumLogLevel},e.prototype.log=function(e,t){this._logger&&this.shouldLog(e)&&this._logger.log(e,t)},e}()},9344:(e,t,r)=>{"use strict";r.d(t,{a2:()=>a,IM:()=>c,oO:()=>u});var n=r(1230),o=r(2065),i=r(4809);var s=r(72),a=function(){return"x-ms-useragent"};function c(){var e,t,r,n=[{key:"core-http",value:i.g.coreHttpVersion}],o=function(){var e=window.navigator;return[{key:"OS",value:(e.oscpu||e.platform).replace(" ","")}]}();return e=n.concat(o),void 0===t&&(t=" "),void 0===r&&(r="/"),e.map((function(e){var t=e.value?""+r+e.value:"";return""+e.key+t})).join(t)}function u(e){var t=e&&void 0!==e.key&&null!==e.key?e.key:"x-ms-useragent",r=e&&void 0!==e.value&&null!==e.value?e.value:c();return{create:function(e,n){return new l(e,n,t,r)}}}var l=function(e){function t(t,r,n,o){var i=e.call(this,t,r)||this;return i._nextPolicy=t,i._options=r,i.headerKey=n,i.headerValue=o,i}return(0,n.ZT)(t,e),t.prototype.sendRequest=function(e){return this.addUserAgentHeader(e),this._nextPolicy.sendRequest(e)},t.prototype.addUserAgentHeader=function(e){e.headers||(e.headers=new o.W),!e.headers.get(this.headerKey)&&this.headerValue&&e.headers.set(this.headerKey,this.headerValue)},t}(s.U)},3422:(e,t,r)=>{"use strict";r.d(t,{lX:()=>m,ei:()=>c});var n=r(1230);function o(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function i(e){for(var t=atob(e),r=new Uint8Array(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r}var s=r(7564),a=r(1035),c=function(){function e(e,t){void 0===e&&(e={}),this.modelMappers=e,this.isXML=t}return e.prototype.validateConstraints=function(e,t,r){var n=function(e,n){throw new Error('"'+r+'" with value "'+t+'" should satisfy the constraint "'+e+'": '+n+".")};if(e.constraints&&null!=t){var o=e.constraints,i=o.ExclusiveMaximum,s=o.ExclusiveMinimum,a=o.InclusiveMaximum,c=o.InclusiveMinimum,u=o.MaxItems,l=o.MaxLength,p=o.MinItems,d=o.MinLength,h=o.MultipleOf,f=o.Pattern,y=o.UniqueItems;if(null!=i&&t>=i&&n("ExclusiveMaximum",i),null!=s&&t<=s&&n("ExclusiveMinimum",s),null!=a&&t>a&&n("InclusiveMaximum",a),null!=c&&t<c&&n("InclusiveMinimum",c),null!=u&&t.length>u&&n("MaxItems",u),null!=l&&t.length>l&&n("MaxLength",l),null!=p&&t.length<p&&n("MinItems",p),null!=d&&t.length<d&&n("MinLength",d),null!=h&&t%h!=0&&n("MultipleOf",h),f){var g="string"==typeof f?new RegExp(f):f;"string"==typeof t&&null!==t.match(g)||n("Pattern",f)}y&&t.some((function(e,t,r){return r.indexOf(e)!==t}))&&n("UniqueItems",y)}},e.prototype.serialize=function(e,t,r,i){var c,h,g;void 0===i&&(i={});var m={rootName:null!==(c=i.rootName)&&void 0!==c?c:"",includeRoot:null!==(h=i.includeRoot)&&void 0!==h&&h,xmlCharKey:null!==(g=i.xmlCharKey)&&void 0!==g?g:a.I},v={},T=e.type.name;r||(r=e.serializedName),null!==T.match(/^Sequence$/i)&&(v=[]),e.isConstant&&(t=e.defaultValue);var b=e.required,_=e.nullable;if(b&&_&&void 0===t)throw new Error(r+" cannot be undefined.");if(b&&!_&&null==t)throw new Error(r+" cannot be null or undefined.");if(!b&&!1===_&&null===t)throw new Error(r+" cannot be null.");return null==t?v=t:(this.validateConstraints(e,t,r),null!==T.match(/^any$/i)?v=t:null!==T.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)?v=function(e,t,r){if(null!=r)if(null!==e.match(/^Number$/i)){if("number"!=typeof r)throw new Error(t+" with value "+r+" must be of type number.")}else if(null!==e.match(/^String$/i)){if("string"!=typeof r.valueOf())throw new Error(t+' with value "'+r+'" must be of type string.')}else if(null!==e.match(/^Uuid$/i)){if("string"!=typeof r.valueOf()||!s.TP(r))throw new Error(t+' with value "'+r+'" must be of type string and a valid uuid.')}else if(null!==e.match(/^Boolean$/i)){if("boolean"!=typeof r)throw new Error(t+" with value "+r+" must be of type boolean.")}else if(null!==e.match(/^Stream$/i)){var n=typeof r;if(!("string"===n||"function"===n||r instanceof ArrayBuffer||ArrayBuffer.isView(r)||("function"==typeof Blob||"object"==typeof Blob)&&r instanceof Blob))throw new Error(t+" must be a string, Blob, ArrayBuffer, ArrayBufferView, or a function returning NodeJS.ReadableStream.")}return r}(T,r,t):null!==T.match(/^Enum$/i)?v=function(e,t,r){if(!t)throw new Error("Please provide a set of allowedValues to validate "+e+" as an Enum Type.");if(!t.some((function(e){return"string"==typeof e.valueOf()?e.toLowerCase()===r.toLowerCase():e===r})))throw new Error(r+" is not a valid value for "+e+". The valid values are: "+JSON.stringify(t)+".");return r}(r,e.type.allowedValues,t):null!==T.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?v=function(e,t,r){if(null!=t)if(null!==e.match(/^Date$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in RFC-1123 format.");t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.");t=function(e){if(e)return"string"==typeof e.valueOf()&&(e=new Date(e)),Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/i)&&!s._9(t))throw new Error(r+' must be a string in ISO 8601 format. Instead was "'+t+'".');return t}(T,t,r):null!==T.match(/^ByteArray$/i)?v=function(e,t){var r="";if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");r=o(t)}return r}(r,t):null!==T.match(/^Base64Url$/i)?v=function(e,t){var r="";if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");r=function(e){if(e){if(!(e instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(e,t){for(var r=e.length;r-1>=0&&"="===e[r-1];)--r;return e.substr(0,r)}(o(e)).replace(/\+/g,"-").replace(/\//g,"_")}}(t)||""}return r}(r,t):null!==T.match(/^Sequence$/i)?v=function(e,t,r,o,i,s){var c,u;if(!Array.isArray(r))throw new Error(o+" must be of type Array.");var l=t.type.element;if(!l||"object"!=typeof l)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+o+".");for(var p=[],d=0;d<r.length;d++){var h=e.serialize(l,r[d],o,s);if(i&&l.xmlNamespace){var f=l.xmlNamespacePrefix?"xmlns:"+l.xmlNamespacePrefix:"xmlns";"Composite"===l.type.name?(p[d]=(0,n.pi)({},h),p[d][a.c]=((c={})[f]=l.xmlNamespace,c)):(p[d]={},p[d][s.xmlCharKey]=h,p[d][a.c]=((u={})[f]=l.xmlNamespace,u))}else p[d]=h}return p}(this,e,t,r,Boolean(this.isXML),m):null!==T.match(/^Dictionary$/i)?v=function(e,t,r,n,o,i){var s;if("object"!=typeof r)throw new Error(n+" must be of type object.");var c=t.type.value;if(!c||"object"!=typeof c)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+n+".");for(var u={},l=0,p=Object.keys(r);l<p.length;l++){var h=p[l],f=e.serialize(c,r[h],n,i);u[h]=d(c,f,o,i)}if(o&&t.xmlNamespace){var y=t.xmlNamespacePrefix?"xmlns:"+t.xmlNamespacePrefix:"xmlns",g=u;return g[a.c]=((s={})[y]=t.xmlNamespace,s),g}return u}(this,e,t,r,Boolean(this.isXML),m):null!==T.match(/^Composite$/i)&&(v=function(e,t,r,o,i,s){var c,h;if(y(e,t)&&(t=f(e,t,r,"clientName")),null!=r){for(var g={},m=p(e,t,o),v=0,T=Object.keys(m);v<T.length;v++){var b=T[v],_=m[b];if(!_.readOnly){var R=void 0,w=g;if(e.isXML)R=_.xmlIsWrapped?_.xmlName:_.xmlElementName||_.xmlName;else{var O=u(_.serializedName);R=O.pop();for(var C=0,E=O;C<E.length;C++){var P=E[C];null!=w[P]||null==r[b]&&void 0===_.defaultValue||(w[P]={}),w=w[P]}}if(null!=w){if(i&&t.xmlNamespace){var S=t.xmlNamespacePrefix?"xmlns:"+t.xmlNamespacePrefix:"xmlns";w[a.c]=(0,n.pi)((0,n.pi)({},w[a.c]),((c={})[S]=t.xmlNamespace,c))}var N=""!==_.serializedName?o+"."+_.serializedName:o,k=r[b],A=y(e,t);A&&A.clientName===b&&null==k&&(k=t.serializedName);var I=e.serialize(_,k,N,s);if(void 0!==I&&null!=R){var M=d(_,I,i,s);i&&_.xmlIsAttribute?(w[a.c]=w[a.c]||{},w[a.c][R]=I):i&&_.xmlIsWrapped?w[R]=((h={})[_.xmlElementName]=M,h):w[R]=M}}}}var x=function(e,t,r){var n=t.type.additionalProperties;if(!n&&t.type.className){var o=l(e,t,r);return null==o?void 0:o.type.additionalProperties}return n}(e,t,o);if(x){var D=Object.keys(m),U=function(t){D.every((function(e){return e!==t}))&&(g[t]=e.serialize(x,r[t],o+'["'+t+'"]',s))};for(var q in r)U(q)}return g}return r}(this,e,t,r,Boolean(this.isXML),m))),v},e.prototype.deserialize=function(e,t,r,n){var o,s,c;void 0===n&&(n={});var l,d={rootName:null!==(o=n.rootName)&&void 0!==o?o:"",includeRoot:null!==(s=n.includeRoot)&&void 0!==s&&s,xmlCharKey:null!==(c=n.xmlCharKey)&&void 0!==c?c:a.I};if(null==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),void 0!==e.defaultValue&&(t=e.defaultValue),t;var g=e.type.name;if(r||(r=e.serializedName),null!==g.match(/^Composite$/i))l=function(e,t,r,n,o){var i;y(e,t)&&(t=f(e,t,r,"serializedName"));for(var s=p(e,t,n),c={},l=[],d=0,g=Object.keys(s);d<g.length;d++){var m=g[d],v=s[m],T=u(s[m].serializedName);l.push(T[0]);var b=v.serializedName,_=v.xmlName,R=v.xmlElementName,w=n;""!==b&&void 0!==b&&(w=n+"."+b);var O=v.headerCollectionPrefix;if(O){for(var C={},E=0,P=Object.keys(r);E<P.length;E++){var S=P[E];S.startsWith(O)&&(C[S.substring(O.length)]=e.deserialize(v.type.value,r[S],w,o)),l.push(S)}c[m]=C}else if(e.isXML)if(v.xmlIsAttribute&&r[a.c])c[m]=e.deserialize(v,r[a.c][_],w,o);else{var N=R||_||b;if(v.xmlIsWrapped){var k=r[_],A=null!==(i=null==k?void 0:k[R])&&void 0!==i?i:[];c[m]=e.deserialize(v,A,w,o)}else{var I=r[N];c[m]=e.deserialize(v,I,w,o)}}else{for(var M=void 0,x=r,D=0,U=T;D<U.length;D++){var q=U[D];if(!x)break;x=x[q]}M=x;var L=t.type.polymorphicDiscriminator;L&&m===L.clientName&&null==M&&(M=t.serializedName);var j=void 0;Array.isArray(r[m])&&""===s[m].serializedName?(M=r[m],c=e.deserialize(v,M,w,o)):void 0===M&&void 0===v.defaultValue||(j=e.deserialize(v,M,w,o),c[m]=j)}}var B=t.type.additionalProperties;if(B){var H=function(e){for(var t in s)if(u(s[t].serializedName)[0]===e)return!1;return!0};for(var z in r)H(z)&&(c[z]=e.deserialize(B,r[z],n+'["'+z+'"]',o))}else if(r)for(var F=0,V=Object.keys(r);F<V.length;F++)void 0!==c[m=V[F]]||l.includes(m)||h(m,o)||(c[m]=r[m]);return c}(this,e,t,r,d);else{if(this.isXML){var m=d.xmlCharKey;null!=t[a.c]&&null!=t[m]&&(t=t[m])}null!==g.match(/^Number$/i)?(l=parseFloat(t),isNaN(l)&&(l=t)):null!==g.match(/^Boolean$/i)?l="true"===t||"false"!==t&&t:null!==g.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?l=t:null!==g.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?l=new Date(t):null!==g.match(/^UnixTime$/i)?l=function(e){if(e)return new Date(1e3*e)}(t):null!==g.match(/^ByteArray$/i)?l=i(t):null!==g.match(/^Base64Url$/i)?l=function(e){if(e){if(e&&"string"!=typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return i(e=e.replace(/-/g,"+").replace(/_/g,"/"))}}(t):null!==g.match(/^Sequence$/i)?l=function(e,t,r,n,o){var i=t.type.element;if(!i||"object"!=typeof i)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+n);if(r){Array.isArray(r)||(r=[r]);for(var s=[],a=0;a<r.length;a++)s[a]=e.deserialize(i,r[a],n+"["+a+"]",o);return s}return r}(this,e,t,r,d):null!==g.match(/^Dictionary$/i)&&(l=function(e,t,r,n,o){var i=t.type.value;if(!i||"object"!=typeof i)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+n);if(r){for(var s={},a=0,c=Object.keys(r);a<c.length;a++){var u=c[a];s[u]=e.deserialize(i,r[u],n,o)}return s}return r}(this,e,t,r,d))}return e.isConstant&&(l=e.defaultValue),l},e}();function u(e){var t=[],r="";if(e)for(var n=0,o=e.split(".");n<o.length;n++){var i=o[n];"\\"===i.charAt(i.length-1)?r+=i.substr(0,i.length-1)+".":(r+=i,t.push(r),r="")}return t}function l(e,t,r){var n=t.type.className;if(!n)throw new Error('Class name for model "'+r+'" is not provided in the mapper "'+JSON.stringify(t,void 0,2)+'".');return e.modelMappers[n]}function p(e,t,r){var n=t.type.modelProperties;if(!n){var o=l(e,t,r);if(!o)throw new Error('mapper() cannot be null or undefined for model "'+t.type.className+'".');if(!(n=null==o?void 0:o.type.modelProperties))throw new Error('modelProperties cannot be null or undefined in the mapper "'+JSON.stringify(o)+'" of type "'+t.type.className+'" for object "'+r+'".')}return n}function d(e,t,r,o){var i;if(!r||!e.xmlNamespace)return t;var s=((i={})[e.xmlNamespacePrefix?"xmlns:"+e.xmlNamespacePrefix:"xmlns"]=e.xmlNamespace,i);if(["Composite"].includes(e.type.name)){if(t[a.c])return t;var c=(0,n.pi)({},t);return c[a.c]=s,c}var u={};return u[o.xmlCharKey]=t,u[a.c]=s,u}function h(e,t){return[a.c,t.xmlCharKey].includes(e)}function f(e,t,r,n){var o=y(e,t);if(o){var i=o[n];if(null!=i){var s=r[i];if(null!=s){var a=t.type.uberParent||t.type.className,c=s===a?s:a+"."+s,u=e.modelMappers.discriminators[c];u&&(t=u)}}}return t}function y(e,t){return t.type.polymorphicDiscriminator||g(e,t.type.uberParent)||g(e,t.type.className)}function g(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}var m=function(e){for(var t={},r=0,n=["Base64Url","Boolean","ByteArray","Composite","Date","DateTime","DateTimeRfc1123","Dictionary","Enum","Number","Object","Sequence","String","Stream","TimeSpan","UnixTime"];r<n.length;r++){var o=n[r];t[o]=o}return t}()},9789:(e,t,r)=>{"use strict";r.d(t,{St:()=>$e,WA:()=>Xe});var n=r(1230),o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},i=new WeakMap,s=new WeakMap,a=function(){function e(){this.onabort=null,i.set(this,[]),s.set(this,!1)}return Object.defineProperty(e.prototype,"aborted",{get:function(){if(!s.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");return s.get(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"none",{get:function(){return new e},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(e,t){if(!i.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");i.get(this).push(t)},e.prototype.removeEventListener=function(e,t){if(!i.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");var r=i.get(this),n=r.indexOf(t);n>-1&&r.splice(n,1)},e.prototype.dispatchEvent=function(e){throw new Error("This is a stub dispatchEvent implementation that should not be used.  It only exists for type-checking purposes.")},e}();function c(e){if(!e.aborted){e.onabort&&e.onabort.call(e);var t=i.get(e);t&&t.forEach((function(t){t.call(e,{type:"abort"})})),s.set(e,!0)}}var u=function(e){function t(t){var r=e.call(this,t)||this;return r.name="AbortError",r}return function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t}(Error),l=(function(){function e(e){var t=this;if(this._signal=new a,e){Array.isArray(e)||(e=arguments);for(var r=0,n=e;r<n.length;r++){var o=n[r];o.aborted?this.abort():o.addEventListener("abort",(function(){t.abort()}))}}}Object.defineProperty(e.prototype,"signal",{get:function(){return this._signal},enumerable:!0,configurable:!0}),e.prototype.abort=function(){c(this._signal)},e.timeout=function(e){var t=new a,r=setTimeout(c,e,t);return"function"==typeof r.unref&&r.unref(),t}}(),r(2065)),p={},d=r(7564),h=function(){function e(){this._rawQuery={}}return e.prototype.any=function(){return Object.keys(this._rawQuery).length>0},e.prototype.keys=function(){return Object.keys(this._rawQuery)},e.prototype.set=function(e,t){if(e)if(null!=t){var r=Array.isArray(t)?t:t.toString();this._rawQuery[e]=r}else delete this._rawQuery[e]},e.prototype.get=function(e){return e?this._rawQuery[e]:void 0},e.prototype.toString=function(){var e="";for(var t in this._rawQuery){e&&(e+="&");var r=this._rawQuery[t];if(Array.isArray(r)){for(var n=[],o=0,i=r;o<i.length;o++){var s=i[o];n.push(t+"="+s)}e+=n.join("&")}else e+=t+"="+r}return e},e.parse=function(t){var r=new e;if(t){t.startsWith("?")&&(t=t.substring(1));for(var n="ParameterName",o="",i="",s=0;s<t.length;++s){var a=t[s];switch(n){case"ParameterName":switch(a){case"=":n="ParameterValue";break;case"&":o="",i="";break;default:o+=a}break;case"ParameterValue":switch(a){case"&":r.set(o,i),o="",i="",n="ParameterName";break;default:i+=a}break;default:throw new Error("Unrecognized URLQuery parse state: "+n)}}"ParameterValue"===n&&r.set(o,i)}return r},e}(),f=function(){function e(){}return e.prototype.setScheme=function(e){e?this.set(e,"SCHEME"):this._scheme=void 0},e.prototype.getScheme=function(){return this._scheme},e.prototype.setHost=function(e){e?this.set(e,"SCHEME_OR_HOST"):this._host=void 0},e.prototype.getHost=function(){return this._host},e.prototype.setPort=function(e){null==e||""===e?this._port=void 0:this.set(e.toString(),"PORT")},e.prototype.getPort=function(){return this._port},e.prototype.setPath=function(e){if(e){var t=e.indexOf("://");if(-1!==t){var r=e.lastIndexOf("/",t);this.set(-1===r?e:e.substr(r+1),"SCHEME")}else this.set(e,"PATH")}else this._path=void 0},e.prototype.appendPath=function(e){if(e){var t=this.getPath();t&&(t.endsWith("/")||(t+="/"),e.startsWith("/")&&(e=e.substring(1)),e=t+e),this.set(e,"PATH")}},e.prototype.getPath=function(){return this._path},e.prototype.setQuery=function(e){this._query=e?h.parse(e):void 0},e.prototype.setQueryParameter=function(e,t){e&&(this._query||(this._query=new h),this._query.set(e,t))},e.prototype.getQueryParameterValue=function(e){return this._query?this._query.get(e):void 0},e.prototype.getQuery=function(){return this._query?this._query.toString():void 0},e.prototype.set=function(e,t){for(var r=new g(e,t);r.next();){var n=r.current(),o=void 0;if(n)switch(n.type){case"SCHEME":this._scheme=n.text||void 0;break;case"HOST":this._host=n.text||void 0;break;case"PORT":this._port=n.text||void 0;break;case"PATH":o=n.text||void 0,this._path&&"/"!==this._path&&"/"===o||(this._path=o);break;case"QUERY":this._query=h.parse(n.text);break;default:throw new Error("Unrecognized URLTokenType: "+n.type)}}},e.prototype.toString=function(){var e="";return this._scheme&&(e+=this._scheme+"://"),this._host&&(e+=this._host),this._port&&(e+=":"+this._port),this._path&&(this._path.startsWith("/")||(e+="/"),e+=this._path),this._query&&this._query.any()&&(e+="?"+this._query.toString()),e},e.prototype.replaceAll=function(e,t){e&&(this.setScheme((0,d.ko)(this.getScheme(),e,t)),this.setHost((0,d.ko)(this.getHost(),e,t)),this.setPort((0,d.ko)(this.getPort(),e,t)),this.setPath((0,d.ko)(this.getPath(),e,t)),this.setQuery((0,d.ko)(this.getQuery(),e,t)))},e.parse=function(t){var r=new e;return r.set(t,"SCHEME_OR_HOST"),r},e}(),y=function(){function e(e,t){this.text=e,this.type=t}return e.scheme=function(t){return new e(t,"SCHEME")},e.host=function(t){return new e(t,"HOST")},e.port=function(t){return new e(t,"PORT")},e.path=function(t){return new e(t,"PATH")},e.query=function(t){return new e(t,"QUERY")},e}(),g=function(){function e(e,t){this._text=e,this._textLength=e?e.length:0,this._currentState=null!=t?t:"SCHEME_OR_HOST",this._currentIndex=0}return e.prototype.current=function(){return this._currentToken},e.prototype.next=function(){if(m(this))switch(this._currentState){case"SCHEME":t=function(e){return _(e,(function(e){return function(e){var t=e.charCodeAt(0);return 48<=t&&t<=57||65<=t&&t<=90||97<=t&&t<=122}(e)}))}(e=this),e._currentToken=y.scheme(t),m(e)?e._currentState="HOST":e._currentState="DONE";break;case"SCHEME_OR_HOST":!function(e){var t=R(e,":","/","?");m(e)?":"===v(e)?"://"===b(e,3)?(e._currentToken=y.scheme(t),e._currentState="HOST"):(e._currentToken=y.host(t),e._currentState="PORT"):(e._currentToken=y.host(t),"/"===v(e)?e._currentState="PATH":e._currentState="QUERY"):(e._currentToken=y.host(t),e._currentState="DONE")}(this);break;case"HOST":!function(e){"://"===b(e,3)&&T(e,3);var t=R(e,":","/","?");e._currentToken=y.host(t),m(e)?":"===v(e)?e._currentState="PORT":"/"===v(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}(this);break;case"PORT":!function(e){":"===v(e)&&T(e);var t=R(e,"/","?");e._currentToken=y.port(t),m(e)?"/"===v(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}(this);break;case"PATH":!function(e){var t=R(e,"?");e._currentToken=y.path(t),m(e)?e._currentState="QUERY":e._currentState="DONE"}(this);break;case"QUERY":!function(e){"?"===v(e)&&T(e);var t=function(e){var t="";return e._currentIndex<e._textLength&&(t=e._text.substring(e._currentIndex),e._currentIndex=e._textLength),t}(e);e._currentToken=y.query(t),e._currentState="DONE"}(this);break;default:throw new Error("Unrecognized URLTokenizerState: "+this._currentState)}else this._currentToken=void 0;var e,t;return!!this._currentToken},e}();function m(e){return e._currentIndex<e._textLength}function v(e){return e._text[e._currentIndex]}function T(e,t){m(e)&&(t||(t=1),e._currentIndex+=t)}function b(e,t){var r=e._currentIndex+t;return e._textLength<r&&(r=e._textLength),e._text.substring(e._currentIndex,r)}function _(e,t){for(var r="";m(e);){var n=v(e);if(!t(n))break;r+=n,T(e)}return r}function R(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return _(e,(function(e){return-1===t.indexOf(e)}))}var w="REDACTED",O=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent"],C=["api-version"],E=function(){function e(e){var t=void 0===e?{}:e,r=t.allowedHeaderNames,n=void 0===r?[]:r,o=t.allowedQueryParameters,i=void 0===o?[]:o;n=Array.isArray(n)?O.concat(n):O,i=Array.isArray(i)?C.concat(i):C,this.allowedHeaderNames=new Set(n.map((function(e){return e.toLowerCase()}))),this.allowedQueryParameters=new Set(i.map((function(e){return e.toLowerCase()})))}return e.prototype.sanitize=function(e){return JSON.stringify(e,this.replacer.bind(this),2)},e.prototype.replacer=function(e,t){return t instanceof Error?(0,n.pi)((0,n.pi)({},t),{name:t.name,message:t.message}):"_headersMap"===e?this.sanitizeHeaders(e,t):"url"===e?this.sanitizeUrl(t):"query"===e?this.sanitizeQuery(t):"body"!==e&&"response"!==e&&"operationSpec"!==e?t:void 0},e.prototype.sanitizeHeaders=function(e,t){return this.sanitizeObject(t,this.allowedHeaderNames,(function(e,t){return e[t].value}))},e.prototype.sanitizeQuery=function(e){return this.sanitizeObject(e,this.allowedQueryParameters,(function(e,t){return e[t]}))},e.prototype.sanitizeObject=function(e,t,r){if("object"!=typeof e||null===e)return e;for(var n={},o=0,i=Object.keys(e);o<i.length;o++){var s=i[o];t.has(s.toLowerCase())?n[s]=r(e,s):n[s]=w}return n},e.prototype.sanitizeUrl=function(e){if("string"!=typeof e||null===e)return e;var t=f.parse(e),r=t.getQuery();if(!r)return e;for(var n=h.parse(r),o=0,i=n.keys();o<i.length;o++){var s=i[o];this.allowedQueryParameters.has(s.toLowerCase())||n.set(s,w)}return t.setQuery(n.toString()),t.toString()},e}(),P=new E,S=function(e){function t(r,n,o,i,s){var a=e.call(this,r)||this;return a.name="RestError",a.code=n,a.statusCode=o,a.request=i,a.response=s,Object.setPrototypeOf(a,t.prototype),a}return(0,n.ZT)(t,e),t.prototype[p]=function(){return"RestError: "+this.message+" \n "+P.sanitize(this)},t.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",t.PARSE_ERROR="PARSE_ERROR",t}(Error),N=function(){function e(){}return e.prototype.sendRequest=function(e){var t=new XMLHttpRequest;if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");var r=e.abortSignal;if(r){if(r.aborted)return Promise.reject(new u("The operation was aborted."));var n=function(){t.abort()};r.addEventListener("abort",n),t.addEventListener("readystatechange",(function(){t.readyState===XMLHttpRequest.DONE&&r.removeEventListener("abort",n)}))}if(k(t.upload,e.onUploadProgress),k(t,e.onDownloadProgress),e.formData){for(var o=e.formData,i=new FormData,s=function(e,t){t&&Object.prototype.hasOwnProperty.call(t,"value")&&Object.prototype.hasOwnProperty.call(t,"options")?i.append(e,t.value,t.options):i.append(e,t)},a=0,c=Object.keys(o);a<c.length;a++){var l=c[a],p=o[l];if(Array.isArray(p))for(var d=0;d<p.length;d++)s(l,p[d]);else s(l,p)}e.body=i,e.formData=void 0;var h=e.headers.get("Content-Type");h&&-1!==h.indexOf("multipart/form-data")&&e.headers.remove("Content-Type")}t.open(e.method,e.url),t.timeout=e.timeout,t.withCredentials=e.withCredentials;for(var f=0,y=e.headers.headersArray();f<y.length;f++){var g=y[f];t.setRequestHeader(g.name,g.value)}return t.responseType=e.streamResponseBody?"blob":"text",t.send(void 0===e.body?null:e.body),e.streamResponseBody?new Promise((function(r,n){t.addEventListener("readystatechange",(function(){if(t.readyState===XMLHttpRequest.HEADERS_RECEIVED){var n=new Promise((function(r,n){t.addEventListener("load",(function(){r(t.response)})),I(e,t,n)}));r({request:e,status:t.status,headers:A(t),blobBody:n})}})),I(e,t,n)})):new Promise((function(r,n){t.addEventListener("load",(function(){return r({request:e,status:t.status,headers:A(t),bodyAsText:t.responseText})})),I(e,t,n)}))},e}();function k(e,t){t&&e.addEventListener("progress",(function(e){return t({loadedBytes:e.loaded})}))}function A(e){for(var t=new l.W,r=0,n=e.getAllResponseHeaders().trim().split(/[\r\n]+/);r<n.length;r++){var o=n[r],i=o.indexOf(":"),s=o.slice(0,i),a=o.slice(i+2);t.set(s,a)}return t}function I(e,t,r){t.addEventListener("error",(function(){return r(new S("Failed to send request to "+e.url,S.REQUEST_SEND_ERROR,void 0,e))}));var n=new u("The operation was aborted.");t.addEventListener("abort",(function(){return r(n)})),t.addEventListener("timeout",(function(){return r(n)}))}var M=r(72),x=(0,r(860).YR)("core-http");function D(e){return void 0===e&&(e={}),{create:function(t,r){return new U(t,r,e)}}}var U=function(e){function t(t,r,n){var o=void 0===n?{}:n,i=o.logger,s=void 0===i?x.info:i,a=o.allowedHeaderNames,c=void 0===a?[]:a,u=o.allowedQueryParameters,l=void 0===u?[]:u,p=e.call(this,t,r)||this;return p.logger=s,p.sanitizer=new E({allowedHeaderNames:c,allowedQueryParameters:l}),p}return(0,n.ZT)(t,e),Object.defineProperty(t.prototype,"allowedHeaderNames",{get:function(){return this.sanitizer.allowedHeaderNames},set:function(e){this.sanitizer.allowedHeaderNames=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowedQueryParameters",{get:function(){return this.sanitizer.allowedQueryParameters},set:function(e){this.sanitizer.allowedQueryParameters=e},enumerable:!1,configurable:!0}),t.prototype.sendRequest=function(e){var t=this;return this.logger.enabled?(this.logRequest(e),this._nextPolicy.sendRequest(e).then((function(e){return t.logResponse(e)}))):this._nextPolicy.sendRequest(e)},t.prototype.logRequest=function(e){this.logger("Request: "+this.sanitizer.sanitize(e))},t.prototype.logResponse=function(e){return this.logger("Response status code: "+e.status),this.logger("Headers: "+this.sanitizer.sanitize(e.headers)),e},t}(M.U);function q(e){return L(e.parameterPath,e.mapper)}function L(e,t){return"string"==typeof e?e:Array.isArray(e)?e.join("."):t.serializedName}var j=r(3422);function B(e){var t=!1;for(var r in e.responses){var n=e.responses[r];if(n.bodyMapper&&n.bodyMapper.type.name===j.lX.Stream){t=!0;break}}return t}var H=r(1035),z=document.implementation.createDocument(null,null,null),F=new DOMParser;function V(e,t){var r,n,o;void 0===t&&(t={});try{var i={rootName:null!==(r=t.rootName)&&void 0!==r?r:"",includeRoot:null!==(n=t.includeRoot)&&void 0!==n&&n,xmlCharKey:null!==(o=t.xmlCharKey)&&void 0!==o?o:H.I},s=F.parseFromString(e,"application/xml");!function(e){if(G){var t=e.getElementsByTagNameNS(G,"parsererror");if(t.length)throw new Error(t.item(0).innerHTML)}}(s);var a;return a=$(i.includeRoot?s:s.childNodes[0],i),Promise.resolve(a)}catch(e){return Promise.reject(e)}}var G="";try{G=F.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(e){}function $(e,t){var r={},n=e.childNodes.length,o=e.childNodes[0],i=o&&1===n&&o.nodeType===Node.TEXT_NODE&&o.nodeValue||void 0,s=function(e){return function(e){return!!e.attributes}(e)&&e.hasAttributes()?e:void 0}(e);if(s){r[H.c]={};for(var a=0;a<s.attributes.length;a++){var c=s.attributes[a];r[H.c][c.nodeName]=c.nodeValue}i&&(r[t.xmlCharKey]=i)}else 0===n?r="":i&&(r=i);if(!i)for(a=0;a<n;a++){var u=e.childNodes[a];if(u.nodeType!==Node.TEXT_NODE){var l=$(u,t);r[u.nodeName]?Array.isArray(r[u.nodeName])?r[u.nodeName].push(l):r[u.nodeName]=[r[u.nodeName],l]:r[u.nodeName]=l}}return r}var K=new XMLSerializer;function X(e,t){var r,n,o;void 0===t&&(t={});var i={rootName:null!==(r=t.rootName)&&void 0!==r?r:"root",includeRoot:null!==(n=t.includeRoot)&&void 0!==n&&n,xmlCharKey:null!==(o=t.xmlCharKey)&&void 0!==o?o:H.I},s=W(e,i.rootName,i)[0];return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+K.serializeToString(s)}function Q(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var o=n[r],i=z.createAttribute(o);i.value=e[o].toString(),t.push(i)}return t}function W(e,t,r){if(null==e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return(u=z.createElement(t)).textContent=null==e?"":e.toString(),[u];if(Array.isArray(e)){for(var n=[],o=0,i=e;o<i.length;o++)for(var s=0,a=W(i[o],t,r);s<a.length;s++){var c=a[s];n.push(c)}return n}if("object"==typeof e){for(var u=z.createElement(t),l=0,p=Object.keys(e);l<p.length;l++){var d=p[l];if(d===H.c)for(var h=0,f=Q(e[d]);h<f.length;h++){var y=f[h];u.attributes.setNamedItem(y)}else if(d===r.xmlCharKey)u.textContent=e[d].toString();else for(var g=0,m=W(e[d],d,r);g<m.length;g++)c=m[g],u.appendChild(c)}return[u]}throw new Error("Illegal value passed to buildObject: "+e)}function J(e,t){return{create:function(r,n){return new re(r,n,e,t)}}}var Y,Z=["application/json","text/json"],ee=["application/xml","application/atom+xml"],te={expectedContentTypes:{json:Z,xml:ee}},re=function(e){function t(t,r,n,o){var i;void 0===o&&(o={});var s=e.call(this,t,r)||this;return s.jsonContentTypes=n&&n.json||Z,s.xmlContentTypes=n&&n.xml||ee,s.xmlCharKey=null!==(i=o.xmlCharKey)&&void 0!==i?i:H.I,s}return(0,n.ZT)(t,e),t.prototype.sendRequest=function(e){return(0,n.mG)(this,void 0,void 0,(function(){var t=this;return(0,n.Jh)(this,(function(r){return[2,this._nextPolicy.sendRequest(e).then((function(e){return function(e,t,r,n){var o,i,s;void 0===n&&(n={});var a={rootName:null!==(o=n.rootName)&&void 0!==o?o:"",includeRoot:null!==(i=n.includeRoot)&&void 0!==i&&i,xmlCharKey:null!==(s=n.xmlCharKey)&&void 0!==s?s:H.I};return function(e,t,r,n){var o=function(e){var t='Error "'+e+'" occurred while parsing the response body - '+r.bodyAsText+".",n=e.code||S.PARSE_ERROR,o=new S(t,n,r.status,r.request,r);return Promise.reject(o)};if(!r.request.streamResponseBody&&r.bodyAsText){var i=r.bodyAsText,s=r.headers.get("Content-Type")||"",a=s?s.split(";").map((function(e){return e.toLowerCase()})):[];if(0===a.length||a.some((function(t){return-1!==e.indexOf(t)})))return new Promise((function(e){r.parsedBody=JSON.parse(i),e(r)})).catch(o);if(a.some((function(e){return-1!==t.indexOf(e)})))return V(i,n).then((function(e){return r.parsedBody=e,r})).catch(o)}return Promise.resolve(r)}(e,t,r,a).then((function(e){if(!function(e){var t=e.request.shouldDeserialize;return void 0===t||("boolean"==typeof t?t:t(e))}(e))return e;var t=e.request.operationSpec;if(!t||!t.responses)return e;var o=function(e){var t,r=e.request,n=r.operationSpec;if(n){var o=r.operationResponseGetter;t=o?o(n,e):n.responses[e.status]}return t}(e),i=function(e,t,r){var n=200<=e.status&&e.status<300;if(function(e){var t=Object.keys(e.responses);return 0===t.length||1===t.length&&"default"===t[0]}(t)?n:r){if(!r)return{error:null,shouldReturnResponse:!1};if(!r.isError)return{error:null,shouldReturnResponse:!1}}var o=null!=r?r:t.responses.default,i=B(t)?"Unexpected status code: "+e.status:e.bodyAsText,s=new S(i,void 0,e.status,e.request,e);if(!o)throw s;var a=o.bodyMapper,c=o.headersMapper;try{if(e.parsedBody){var u=e.parsedBody,l=void 0;if(a){var p=u;t.isXML&&a.type.name===j.lX.Sequence&&(p="object"==typeof u?u[a.xmlElementName]:[]),l=t.serializer.deserialize(a,p,"error.response.parsedBody")}var d=u.error||l||u;s.code=d.code,d.message&&(s.message=d.message),a&&(s.response.parsedBody=l)}e.headers&&c&&(s.response.parsedHeaders=t.serializer.deserialize(c,e.headers.rawHeaders(),"operationRes.parsedHeaders"))}catch(t){s.message='Error "'+t.message+'" occurred in deserializing the responseBody - "'+e.bodyAsText+'" for the default response.'}return{error:s,shouldReturnResponse:!1}}(e,t,o),s=i.error,a=i.shouldReturnResponse;if(s)throw s;if(a)return e;if(o){if(o.bodyMapper){var c=e.parsedBody;t.isXML&&o.bodyMapper.type.name===j.lX.Sequence&&(c="object"==typeof c?c[o.bodyMapper.xmlElementName]:[]);try{e.parsedBody=t.serializer.deserialize(o.bodyMapper,c,"operationRes.parsedBody",n)}catch(s){throw new S("Error "+s+" occurred in deserializing the responseBody - "+e.bodyAsText,void 0,e.status,e.request,e)}}else"HEAD"===t.httpMethod&&(e.parsedBody=r.status>=200&&r.status<300);o.headersMapper&&(e.parsedHeaders=t.serializer.deserialize(o.headersMapper,e.headers.rawHeaders(),"operationRes.parsedHeaders",n))}return e}))}(t.jsonContentTypes,t.xmlContentTypes,e,{xmlCharKey:t.xmlCharKey})}))]}))}))},t}(M.U),ne=3e4,oe=9e4;function ie(e){return"number"==typeof e}function se(e,t,r,n,o){return!!t(n,o)&&r.retryCount<e}function ae(e,t,r){void 0===t&&(t={retryCount:0,retryInterval:0}),r&&(t.error&&(r.innerError=t.error),t.error=r),t.retryCount++;var n=Math.pow(2,t.retryCount-1)-1;return n*=.8*e.retryInterval+Math.floor(Math.random()*(.4*e.retryInterval)),t.retryInterval=Math.min(e.minRetryInterval+n,e.maxRetryInterval),t}function ce(e,t,r){return{create:function(n,o){return new le(n,o,e,t,r)}}}!function(e){e[e.Exponential=0]="Exponential"}(Y||(Y={}));var ue={maxRetries:3,retryDelayInMs:ne,maxRetryDelayInMs:oe},le=function(e){function t(t,r,n,o,i){var s=e.call(this,t,r)||this;return s.retryCount=ie(n)?n:3,s.retryInterval=ie(o)?o:ne,s.maxRetryInterval=ie(i)?i:oe,s}return(0,n.ZT)(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(r){return pe(t,e,r)})).catch((function(r){return pe(t,e,r.response,void 0,r)}))},t}(M.U);function pe(e,t,r,o,i){return(0,n.mG)(this,void 0,void 0,(function(){function s(e){var t=null==e?void 0:e.status;return!(void 0===t||t<500&&408!==t||501===t||505===t)}var a,c,u;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:if(o=ae({retryInterval:e.retryInterval,minRetryInterval:0,maxRetryInterval:e.maxRetryInterval},o,i),(a=t.abortSignal&&t.abortSignal.aborted)||!se(e.retryCount,s,o,r))return[3,6];x.info("Retrying request in "+o.retryInterval),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,d.gw(o.retryInterval)];case 2:return n.sent(),[4,e._nextPolicy.sendRequest(t.clone())];case 3:return c=n.sent(),[2,pe(e,t,c,o)];case 4:return u=n.sent(),[2,pe(e,t,r,o,u)];case 5:return[3,7];case 6:if(a||i||!r)throw o.error||new S("Failed to send the request.",S.REQUEST_SEND_ERROR,r&&r.status,r&&r.request,r);return[2,r];case 7:return[2]}}))}))}function de(e){return void 0===e&&(e="x-ms-client-request-id"),{create:function(t,r){return new he(t,r,e)}}}var he=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o._requestIdHeaderName=n,o}return(0,n.ZT)(t,e),t.prototype.sendRequest=function(e){return e.headers.contains(this._requestIdHeaderName)||e.headers.set(this._requestIdHeaderName,e.requestId),this._nextPolicy.sendRequest(e)},t}(M.U),fe=r(9344),ye=["GET","HEAD"],ge={handleRedirects:!0,maxRetries:20};function me(e){return void 0===e&&(e=20),{create:function(t,r){return new ve(t,r,e)}}}var ve=function(e){function t(t,r,n){void 0===n&&(n=20);var o=e.call(this,t,r)||this;return o.maxRetries=n,o}return(0,n.ZT)(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e).then((function(e){return Te(t,e,0)}))},t}(M.U);function Te(e,t,r){var n=t.request,o=t.status,i=t.headers.get("location");if(i&&(300===o||301===o&&ye.includes(n.method)||302===o&&ye.includes(n.method)||303===o&&"POST"===n.method||307===o)&&(!e.maxRetries||r<e.maxRetries)){var s=f.parse(n.url);return s.setPath(i),n.url=s.toString(),303===o&&(n.method="GET",delete n.body),e._nextPolicy.sendRequest(n).then((function(t){return Te(e,t,r+1)}))}return Promise.resolve(t)}var be=function(e){function t(t,r,n){void 0===n&&(n=30);var o=e.call(this,t,r)||this;return o._retryTimeout=n,o}return(0,n.ZT)(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(r){return function(e,t,r){if(409===r.status){var n=function(e){var t,r;if(e){try{r=JSON.parse(e)}catch(e){}if(r&&r.error&&r.error.message&&r.error.code&&"MissingSubscriptionRegistration"===r.error.code){var n=r.error.message.match(/.*'(.*)'/i);n&&(t=n.pop())}}return t}(r.bodyAsText);if(n){var o=function(e){var t=e.match(/.*\/subscriptions\/[a-f0-9-]+\//gi);if(!t||!t[0])throw new Error("Unable to extract subscriptionId from the given url - "+e+".");return t[0]}(t.url);return function(e,t,r,n){var o=t+"providers/"+r+"/register?api-version=2016-02-01",i=t+"providers/"+r+"?api-version=2016-02-01",s=_e(n);return s.method="POST",s.url=o,e._nextPolicy.sendRequest(s).then((function(t){if(200!==t.status)throw new Error("Autoregistration of "+r+" failed. Please try registering manually.");return Re(e,i,n)}))}(e,o,n,t).catch((function(){return!1})).then((function(n){return n?(t.headers.set("x-ms-client-request-id",d.Rl()),e._nextPolicy.sendRequest(t.clone())):r}))}}return Promise.resolve(r)}(t,e,r)}))},t}(M.U);function _e(e,t){void 0===t&&(t=!1);var r=e.clone();return t&&(r.url=e.url),r.headers.set("x-ms-client-request-id",d.Rl()),r.headers.set("Content-Type","application/json; charset=utf-8"),r}function Re(e,t,r){var n=_e(r);return n.url=t,n.method="GET",e._nextPolicy.sendRequest(n).then((function(n){var o=n.parsedBody;return!(!n.parsedBody||!o.registrationState||"Registered"!==o.registrationState)||d.gw(1e3*e._retryTimeout).then((function(){return Re(e,t,r)}))}))}var we=r(4809),Oe=function(){function e(e){void 0===e&&(e=12e4),this.cachedToken=void 0,this.tokenRefreshBufferMs=e}return e.prototype.setCachedToken=function(e){this.cachedToken=e},e.prototype.getCachedToken=function(){return this.cachedToken&&Date.now()+this.tokenRefreshBufferMs>=this.cachedToken.expiresOnTimestamp&&(this.cachedToken=void 0),this.cachedToken},e}(),Ce=function(){function e(e,t,r){void 0===r&&(r=3e4),this.credential=e,this.scopes=t,this.requiredMillisecondsBeforeNewRefresh=r,this.lastCalled=0}return e.prototype.isReady=function(){return!this.lastCalled||Date.now()-this.lastCalled>this.requiredMillisecondsBeforeNewRefresh},e.prototype.getToken=function(e){return(0,n.mG)(this,void 0,void 0,(function(){var t;return(0,n.Jh)(this,(function(r){switch(r.label){case 0:return this.lastCalled=Date.now(),[4,this.credential.getToken(this.scopes,e)];case 1:return t=r.sent(),this.promise=void 0,[2,t||void 0]}}))}))},e.prototype.refresh=function(e){return this.promise||(this.promise=this.getToken(e)),this.promise},e}(),Ee=function(e){function t(t,r,n,o){var i=e.call(this,t,r)||this;return i.tokenCache=n,i.tokenRefresher=o,i}return(0,n.ZT)(t,e),t.prototype.sendRequest=function(e){return(0,n.mG)(this,void 0,void 0,(function(){var t;return(0,n.Jh)(this,(function(r){switch(r.label){case 0:return e.headers||(e.headers=new l.W),[4,this.getToken({abortSignal:e.abortSignal,tracingOptions:{spanOptions:e.spanOptions}})];case 1:return t=r.sent(),e.headers.set(we.g.HeaderConstants.AUTHORIZATION,"Bearer "+t),[2,this._nextPolicy.sendRequest(e)]}}))}))},t.prototype.updateTokenIfNeeded=function(e){return(0,n.mG)(this,void 0,void 0,(function(){var t;return(0,n.Jh)(this,(function(r){switch(r.label){case 0:return this.tokenRefresher.isReady()?[4,this.tokenRefresher.refresh(e)]:[3,2];case 1:t=r.sent(),this.tokenCache.setCachedToken(t),r.label=2;case 2:return[2]}}))}))},t.prototype.getToken=function(e){return(0,n.mG)(this,void 0,void 0,(function(){var t;return(0,n.Jh)(this,(function(r){switch(r.label){case 0:return void 0!==(t=this.tokenCache.getCachedToken())?[3,2]:[4,this.tokenRefresher.refresh(e)];case 1:return t=r.sent(),this.tokenCache.setCachedToken(t),[3,3];case 2:this.updateTokenIfNeeded(e),r.label=3;case 3:return[2,t?t.token:void 0]}}))}))},t}(M.U);function Pe(e,t,r,n){return{create:function(o,i){return new Ne(o,i,e,t,r,n)}}}var Se,Ne=function(e){function t(t,r,n,o,i,s){var a=e.call(this,t,r)||this;return a.retryCount=ie(n)?n:3,a.retryInterval=ie(o)?o:ne,a.minRetryInterval=ie(i)?i:3e3,a.maxRetryInterval=ie(s)?s:oe,a}return(0,n.ZT)(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).catch((function(r){return ke(t,e,r.response,r)}))},t}(M.U);function ke(e,t,r,o,i){return(0,n.mG)(this,void 0,void 0,(function(){function s(e,t){return!(!t||!t.code||"ETIMEDOUT"!==t.code&&"ESOCKETTIMEDOUT"!==t.code&&"ECONNREFUSED"!==t.code&&"ECONNRESET"!==t.code&&"ENOENT"!==t.code)}var a;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:if(i=ae(e,i,o),!se(e.retryCount,s,i,r,o))return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,d.gw(i.retryInterval)];case 2:return n.sent(),[2,e._nextPolicy.sendRequest(t.clone())];case 3:return a=n.sent(),[2,ke(e,t,r,a,i)];case 4:return[3,6];case 5:return o?[2,Promise.reject(i.error)]:[2,r];case 6:return[2]}}))}))}!function(e){e.Csv=",",e.Ssv=" ",e.Tsv="\t",e.Pipes="|",e.Multi="Multi"}(Se||(Se={}));var Ae=function(){function e(e,t,r,n,o,i,s,a,c,u,p,h,f,y){this.streamResponseBody=i,this.url=e||"",this.method=t||"GET",this.headers=(0,l.d)(o)?o:new l.W(o),this.body=r,this.query=n,this.formData=void 0,this.withCredentials=s||!1,this.abortSignal=a,this.timeout=c||0,this.onUploadProgress=u,this.onDownloadProgress=p,this.proxySettings=h,this.keepAlive=f,this.decompressResponse=y,this.requestId=this.headers.get("x-ms-client-request-id")||(0,d.Rl)()}return e.prototype.validateRequestProperties=function(){if(!this.method)throw new Error("WebResource.method is required.");if(!this.url)throw new Error("WebResource.url is required.")},e.prototype.prepare=function(e){if(!e)throw new Error("options object is required");if(void 0===e.method||null===e.method||"string"!=typeof e.method.valueOf())throw new Error("options.method must be a string.");if(e.url&&e.pathTemplate)throw new Error("options.url and options.pathTemplate are mutually exclusive. Please provide exactly one of them.");if(!(void 0!==e.pathTemplate&&null!==e.pathTemplate&&"string"==typeof e.pathTemplate.valueOf()||void 0!==e.url&&null!==e.url&&"string"==typeof e.url.valueOf()))throw new Error("Please provide exactly one of options.pathTemplate or options.url.");if(e.url){if("string"!=typeof e.url)throw new Error('options.url must be of type "string".');this.url=e.url}if(e.method){var t=["GET","PUT","HEAD","DELETE","OPTIONS","POST","PATCH","TRACE"];if(-1===t.indexOf(e.method.toUpperCase()))throw new Error('The provided method "'+e.method+'" is invalid. Supported HTTP methods are: '+JSON.stringify(t))}if(this.method=e.method.toUpperCase(),e.pathTemplate){var r=e.pathTemplate,n=e.pathParameters;if("string"!=typeof r)throw new Error('options.pathTemplate must be of type "string".');e.baseUrl||(e.baseUrl="https://management.azure.com");var o=e.baseUrl,i=o+(o.endsWith("/")?"":"/")+(r.startsWith("/")?r.slice(1):r),s=i.match(/({[\w-]*\s*[\w-]*})/gi);if(s&&s.length){if(!n)throw new Error("pathTemplate: "+r+" has been provided. Hence, options.pathParameters must also be provided.");s.forEach((function(e){var t=e.slice(1,-1),o=n[t];if(null==o||"string"!=typeof o&&"object"!=typeof o){var s=JSON.stringify(n,void 0,2);throw new Error("pathTemplate: "+r+" contains the path parameter "+t+" however, it is not present in parameters: "+s+'.The value of the path parameter can either be a "string" of the form { '+t+': "some sample value" } or it can be an "object" of the form { "'+t+'": { value: "some sample value", skipUrlEncoding: true } }.')}if("string"==typeof o.valueOf()&&(i=i.replace(e,encodeURIComponent(o))),"object"==typeof o.valueOf()){if(!o.value)throw new Error("options.pathParameters["+t+'] is of type "object" but it does not contain a "value" property.');i=o.skipUrlEncoding?i.replace(e,o.value):i.replace(e,encodeURIComponent(o.value))}}))}this.url=i}if(e.queryParameters){var a=e.queryParameters;if("object"!=typeof a)throw new Error('options.queryParameters must be of type object. It should be a JSON object of "query-parameter-name" as the key and the "query-parameter-value" as the value. The "query-parameter-value" may be fo type "string" or an "object" of the form { value: "query-parameter-value", skipUrlEncoding: true }.');this.url&&-1===this.url.indexOf("?")&&(this.url+="?");var c=[];for(var u in this.query={},a){var l=a[u];if(l)if("string"==typeof l)c.push(u+"="+encodeURIComponent(l)),this.query[u]=encodeURIComponent(l);else if("object"==typeof l){if(!l.value)throw new Error("options.queryParameters["+u+'] is of type "object" but it does not contain a "value" property.');l.skipUrlEncoding?(c.push(u+"="+l.value),this.query[u]=l.value):(c.push(u+"="+encodeURIComponent(l.value)),this.query[u]=encodeURIComponent(l.value))}}this.url+=c.join("&")}if(e.headers)for(var p=e.headers,d=0,h=Object.keys(e.headers);d<h.length;d++){var f=h[d];this.headers.set(f,p[f])}return this.headers.get("accept-language")||this.headers.set("accept-language","en-US"),this.headers.get("x-ms-client-request-id")||e.disableClientRequestId||this.headers.set("x-ms-client-request-id",this.requestId),this.headers.get("Content-Type")||this.headers.set("Content-Type","application/json; charset=utf-8"),this.body=e.body,void 0!==e.body&&null!==e.body&&(e.bodyIsStream?(this.headers.get("Transfer-Encoding")||this.headers.set("Transfer-Encoding","chunked"),"application/octet-stream"!==this.headers.get("Content-Type")&&this.headers.set("Content-Type","application/octet-stream")):(e.serializationMapper&&(this.body=new j.ei(e.mappers).serialize(e.serializationMapper,e.body,"requestBody")),e.disableJsonStringifyOnBody||(this.body=JSON.stringify(e.body)))),e.spanOptions&&(this.spanOptions=e.spanOptions),this.abortSignal=e.abortSignal,this.onDownloadProgress=e.onDownloadProgress,this.onUploadProgress=e.onUploadProgress,this},e.prototype.clone=function(){var t=new e(this.url,this.method,this.body,this.query,this.headers&&this.headers.clone(),this.streamResponseBody,this.withCredentials,this.abortSignal,this.timeout,this.onUploadProgress,this.onDownloadProgress,this.proxySettings,this.keepAlive,this.decompressResponse);return this.formData&&(t.formData=this.formData),this.operationSpec&&(t.operationSpec=this.operationSpec),this.shouldDeserialize&&(t.shouldDeserialize=this.shouldDeserialize),this.operationResponseGetter&&(t.operationResponseGetter=this.operationResponseGetter),t},e}(),Ie=new Error("ProxyPolicy is not supported in browser environment");function Me(e){return{create:function(e,t){throw Ie}}}!function(e){function t(t,r){throw e.call(this,t,r),Ie}(0,n.ZT)(t,e),t.prototype.sendRequest=function(e){throw Ie}}(M.U);var xe=we.g.HttpConstants.StatusCodes;function De(){return{create:function(e,t){return new Ue(e,t)}}}var Ue=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o._handleResponse=n||o._defaultResponseHandler,o}return(0,n.ZT)(t,e),t.prototype.sendRequest=function(e){return(0,n.mG)(this,void 0,void 0,(function(){var t=this;return(0,n.Jh)(this,(function(r){return[2,this._nextPolicy.sendRequest(e.clone()).then((function(r){return r.status!==xe.TooManyRequests?r:t._handleResponse(e,r)}))]}))}))},t.prototype._defaultResponseHandler=function(e,r){return(0,n.mG)(this,void 0,void 0,(function(){var o,i,s=this;return(0,n.Jh)(this,(function(n){return(o=r.headers.get(we.g.HeaderConstants.RETRY_AFTER))&&(i=t.parseRetryAfterHeader(o))?[2,(0,d.gw)(i).then((function(t){return s._nextPolicy.sendRequest(e)}))]:[2,r]}))}))},t.parseRetryAfterHeader=function(e){var r=Number(e);return Number.isNaN(r)?t.parseDateRetryAfterHeader(e):1e3*r},t.parseDateRetryAfterHeader=function(e){try{var t=Date.now(),r=Date.parse(e)-t;return Number.isNaN(r)?void 0:r}catch(e){return}},t}(M.U),qe=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.authenticationProvider=n,o}return(0,n.ZT)(t,e),t.prototype.signRequest=function(e){return this.authenticationProvider.signRequest(e)},t.prototype.sendRequest=function(e){var t=this;return this.signRequest(e).then((function(e){return t._nextPolicy.sendRequest(e)}))},t}(M.U),Le={enable:!0},je=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.keepAliveOptions=n,o}return(0,n.ZT)(t,e),t.prototype.sendRequest=function(e){return(0,n.mG)(this,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){return e.keepAlive=this.keepAliveOptions.enable,[2,this._nextPolicy.sendRequest(e)]}))}))},t}(M.U),Be=r(7176),He=r(6563),ze=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.userAgent=n.userAgent,o}return(0,n.ZT)(t,e),t.prototype.sendRequest=function(e){return(0,n.mG)(this,void 0,void 0,(function(){var t,r,o,i,s,a,c,u,l,p;return(0,n.Jh)(this,(function(d){switch(d.label){case 0:if(!e.spanOptions||!e.spanOptions.parent)return[2,this._nextPolicy.sendRequest(e)];t=(0,Be.Y)(),r=(0,n.pi)((0,n.pi)({},e.spanOptions),{kind:He.SpanKind.CLIENT}),o=f.parse(e.url).getPath()||"/",(i=t.startSpan(o,r)).setAttributes({"http.method":e.method,"http.url":e.url,requestId:e.requestId}),this.userAgent&&i.setAttribute("http.user_agent",this.userAgent),d.label=1;case 1:return d.trys.push([1,3,,4]),s=i.context(),(a=function(e){var t=[];if(e.traceId||t.push("traceId"),e.spanId||t.push("spanId"),!t.length){var r=(e.traceFlags||0).toString(16),n=1===r.length?"0"+r:r;return"00-"+e.traceId+"-"+e.spanId+"-"+n}}(s))&&(e.headers.set("traceparent",a),(c=s.traceState&&s.traceState.serialize())&&e.headers.set("tracestate",c)),[4,this._nextPolicy.sendRequest(e)];case 2:return u=d.sent(),i.setAttribute("http.status_code",u.status),(l=u.headers.get("x-ms-request-id"))&&i.setAttribute("serviceRequestId",l),i.end(),[2,u];case 3:throw p=d.sent(),i.end(),p;case 4:return[2]}}))}))},t}(M.U),Fe=new Error("DisableResponseDecompressionPolicy is not supported in browser environment");!function(e){function t(t,r){throw e.call(this,t,r),Fe}(0,n.ZT)(t,e),t.prototype.sendRequest=function(e){return(0,n.mG)(this,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){throw Fe}))}))}}(M.U);var Ve=function(e){function t(t,r){return e.call(this,t,r)||this}return(0,n.ZT)(t,e),t.prototype.sendRequest=function(e){return(0,n.mG)(this,void 0,void 0,(function(){var t;return(0,n.Jh)(this,(function(r){return"string"==typeof e.body&&e.body.startsWith("[")&&(t=JSON.parse(e.body),Array.isArray(t)&&(e.body=t.map((function(e){return JSON.stringify(e)+"\n"})).join(""))),[2,this._nextPolicy.sendRequest(e)]}))}))},t}(M.U),Ge=URL,$e=function(){function e(e,t){var r,n,o,i,s,a;if(t||(t={}),this._withCredentials=t.withCredentials||!1,this._httpClient=t.httpClient||new N,this._requestPolicyOptions=new M._(t.httpPipelineLogger),Array.isArray(t.requestPolicyFactories))x.info("ServiceClient: using custom request policies"),r=t.requestPolicyFactories;else{var c=void 0;if((a=e)&&"function"==typeof a.getToken&&(void 0===a.signRequest||a.getToken.length>0))x.info("ServiceClient: creating bearer token authentication policy from provided credentials"),o=void 0,i=this,s=t,c={create:function(t,r){var n=function(e,t){if(null==e?void 0:e.credentialScopes){var r=e.credentialScopes;return Array.isArray(r)?r.map((function(e){return new Ge(e).toString()})):new Ge(r).toString()}if(t)return t+"/.default"}(s,i.baseUri);if(!n)throw new Error("When using credential, the ServiceClient must contain a baseUri or a credentialScopes in ServiceClientOptions. Unable to create a bearerTokenAuthenticationPolicy");return null==o&&(o=function(e,t){var r=new Oe,n=new Ce(e,t,3e4);return{create:function(e,t){return new Ee(e,t,r,n)}}}(e,n)),o.create(t,r)}};else if(e&&"function"==typeof e.signRequest)x.info("ServiceClient: creating signing policy from provided credentials"),n=e,c={create:function(e,t){return new qe(e,t,n)}};else if(null!=e)throw new Error("The credentials argument must implement the TokenCredential interface");if(x.info("ServiceClient: using default request policies"),r=function(e,t){var r=[];t.generateClientRequestIdHeader&&r.push(de(t.clientRequestIdHeaderName)),e&&r.push(e);var n,o=Ke(t.userAgentHeaderName,fe.a2),i=Ke(t.userAgent,fe.IM);return o&&i&&r.push((0,fe.oO)({key:o,value:i})),r.push(me()),r.push((void 0===(n=t.rpRegistrationRetryTimeout)&&(n=30),{create:function(e,t){return new be(e,t,n)}})),t.noRetryPolicy||(r.push(ce()),r.push(Pe()),r.push(De())),r.push(J(t.deserializationContentTypes)),d.UG&&r.push(Me(t.proxySettings)),r.push(D({logger:x.info})),r}(c,t),t.requestPolicyFactories){var u=t.requestPolicyFactories(r);u&&(r=u)}}this._requestPolicyFactories=r}return e.prototype.sendRequest=function(e){if(null==e||"object"!=typeof e)throw new Error("options cannot be null or undefined and it must be of type object.");var t,r;try{"object"==typeof(r=e)&&"string"==typeof r.url&&"string"==typeof r.method&&"object"==typeof r.headers&&(0,l.d)(r.headers)&&"function"==typeof r.validateRequestProperties&&"function"==typeof r.prepare&&"function"==typeof r.clone?(e.validateRequestProperties(),t=e):t=(t=new Ae).prepare(e)}catch(e){return Promise.reject(e)}var n=this._httpClient;if(this._requestPolicyFactories&&this._requestPolicyFactories.length>0)for(var o=this._requestPolicyFactories.length-1;o>=0;--o)n=this._requestPolicyFactories[o].create(n,this._requestPolicyOptions);return n.sendRequest(t)},e.prototype.sendOperationRequest=function(e,t,r){var o;return(0,n.mG)(this,void 0,void 0,(function(){var i,s,a,c,u,l,p,h,y,g,m,v,T,b,_,R,w,O,C,E,P,S,N,k,A,I,M,x,D,U,L;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:"function"==typeof e.options&&(r=e.options,e.options=void 0),i=null===(o=e.options)||void 0===o?void 0:o.serializerOptions,s=new Ae,n.label=1;case 1:if(n.trys.push([1,6,,7]),!(c=t.baseUrl||this.baseUri))throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a baseUri string property that contains the base URL to use.");if(s.method=t.httpMethod,s.operationSpec=t,u=f.parse(c),t.path&&u.appendPath(t.path),t.urlParameters&&t.urlParameters.length>0)for(l=0,p=t.urlParameters;l<p.length;l++)h=p[l],y=Qe(this,e,h,t.serializer),y=t.serializer.serialize(h.mapper,y,q(h),i),h.skipEncoding||(y=encodeURIComponent(y)),u.replaceAll("{"+(h.mapper.serializedName||q(h))+"}",y);if(t.queryParameters&&t.queryParameters.length>0)for(g=0,m=t.queryParameters;g<m.length;g++)if(v=m[g],null!=(T=Qe(this,e,v,t.serializer))){if(T=t.serializer.serialize(v.mapper,T,q(v),i),void 0!==v.collectionFormat&&null!==v.collectionFormat)if(v.collectionFormat===Se.Multi){if(0===T.length)continue;for(_ in T)b=T[_],T[_]=null==b?"":b.toString()}else v.collectionFormat!==Se.Ssv&&v.collectionFormat!==Se.Tsv||(T=T.join(v.collectionFormat));if(!v.skipEncoding)if(Array.isArray(T))for(_ in T)void 0!==T[_]&&null!==T[_]&&(T[_]=encodeURIComponent(T[_]));else T=encodeURIComponent(T);void 0!==v.collectionFormat&&null!==v.collectionFormat&&v.collectionFormat!==Se.Multi&&v.collectionFormat!==Se.Ssv&&v.collectionFormat!==Se.Tsv&&(T=T.join(v.collectionFormat)),u.setQueryParameter(v.mapper.serializedName||q(v),T)}if(s.url=u.toString(),(R=t.contentType||this.requestContentType)&&s.headers.set("Content-Type",R),t.headerParameters)for(w=0,O=t.headerParameters;w<O.length;w++)if(C=O[w],null!=(E=Qe(this,e,C,t.serializer)))if(E=t.serializer.serialize(C.mapper,E,q(C),i),P=C.mapper.headerCollectionPrefix)for(S=0,N=Object.keys(E);S<N.length;S++)k=N[S],s.headers.set(P+k,E[k]);else s.headers.set(C.mapper.serializedName||q(C),E);if(A=e.options){if(A.customHeaders)for(I in A.customHeaders)s.headers.set(I,A.customHeaders[I]);A.abortSignal&&(s.abortSignal=A.abortSignal),A.timeout&&(s.timeout=A.timeout),A.onUploadProgress&&(s.onUploadProgress=A.onUploadProgress),A.onDownloadProgress&&(s.onDownloadProgress=A.onDownloadProgress),A.spanOptions&&(s.spanOptions=A.spanOptions),void 0!==A.shouldDeserialize&&null!==A.shouldDeserialize&&(s.shouldDeserialize=A.shouldDeserialize)}s.withCredentials=this._withCredentials,function(e,t,r,n){var o,i,s,a,c,u,l=null!==(i=null===(o=r.options)||void 0===o?void 0:o.serializerOptions)&&void 0!==i?i:{},p={rootName:null!==(s=l.rootName)&&void 0!==s?s:"",includeRoot:null!==(a=l.includeRoot)&&void 0!==a&&a,xmlCharKey:null!==(c=l.xmlCharKey)&&void 0!==c?c:H.I},h=l.xmlCharKey;if(n.requestBody&&n.requestBody.mapper){t.body=Qe(e,r,n.requestBody,n.serializer);var f=n.requestBody.mapper,y=f.required,g=f.xmlName,m=f.xmlElementName,v=f.serializedName,T=f.xmlNamespace,b=f.xmlNamespacePrefix,_=f.type.name;try{if(void 0!==t.body&&null!==t.body||y){var R=q(n.requestBody);t.body=n.serializer.serialize(f,t.body,R,p);var w=_===j.lX.Stream;if(n.isXML){var O=b?"xmlns:"+b:"xmlns",C=function(e,t,r,n,o){var i;if(e&&!["Composite","Sequence","Dictionary"].includes(r)){var s={};return s[o.xmlCharKey]=n,s[H.c]=((i={})[t]=e,i),s}return n}(T,O,_,t.body,p);_===j.lX.Sequence?t.body=X(d.WQ(C,m||g||v,O,T),{rootName:g||v,xmlCharKey:h}):w||(t.body=X(C,{rootName:g||v,xmlCharKey:h}))}else{if(_===j.lX.String&&((null===(u=n.contentType)||void 0===u?void 0:u.match("text/plain"))||"text"===n.mediaType))return;w||(t.body=JSON.stringify(t.body))}}}catch(e){throw new Error('Error "'+e.message+'" occurred in serializing the payload - '+JSON.stringify(v,void 0,"  ")+".")}}else if(n.formDataParameters&&n.formDataParameters.length>0){t.formData={};for(var E=0,P=n.formDataParameters;E<P.length;E++){var S=P[E],N=Qe(e,r,S,n.serializer);if(null!=N){var k=S.mapper.serializedName||q(S);t.formData[k]=n.serializer.serialize(S.mapper,N,q(S),p)}}}}(this,s,e,t),void 0!==s.streamResponseBody&&null!==s.streamResponseBody||(s.streamResponseBody=B(t)),M=void 0,x=void 0,n.label=2;case 2:return n.trys.push([2,4,,5]),[4,this.sendRequest(s)];case 3:return M=n.sent(),[3,5];case 4:return D=n.sent(),x=D,[3,5];case 5:return x?(x.response&&(x.details=Ye(x.response,t.responses[x.statusCode]||t.responses.default)),a=Promise.reject(x)):a=Promise.resolve(Ye(M,t.responses[M.status])),[3,7];case 6:return U=n.sent(),a=Promise.reject(U),[3,7];case 7:return(L=r)&&a.then((function(e){return L(null,e._response.parsedBody,e._response.request,e._response)})).catch((function(e){return L(e)})),[2,a]}}))}))},e}();function Ke(e,t){var r;return"string"==typeof e?r=e:(r=t(),"function"==typeof e&&(r=e(r))),r}function Xe(e,t){var r=[];e.sendStreamingJson&&r.push({create:function(e,t){return new Ve(e,t)}});var o=void 0;if(e.userAgentOptions&&e.userAgentOptions.userAgentPrefix){var i=[];i.push(e.userAgentOptions.userAgentPrefix);var s=(0,fe.IM)();-1===i.indexOf(s)&&i.push(s),o=i.join(" ")}var a=(0,n.pi)((0,n.pi)({},Le),e.keepAliveOptions),c=(0,n.pi)((0,n.pi)({},ue),e.retryOptions),u=(0,n.pi)((0,n.pi)({},ge),e.redirectOptions);d.UG&&r.push(Me(e.proxyOptions));var l,p=(0,n.pi)((0,n.pi)({},te),e.deserializationOptions),h=(0,n.pi)({},e.loggingOptions);return r.push((void 0===(l={userAgent:o})&&(l={}),{create:function(e,t){return new ze(e,t,l)}}),function(e){return{create:function(t,r){return new je(t,r,e||Le)}}}(a),(0,fe.oO)({value:o}),de(),J(p.expectedContentTypes),De(),Pe(),ce(c.maxRetries,c.retryDelayInMs,c.maxRetryDelayInMs)),u.handleRedirects&&r.push(me(u.maxRetries)),t&&r.push(t),r.push(D(h)),d.UG&&!1===e.decompressResponse&&r.push({create:function(e,t){throw Fe}}),{httpClient:e.httpClient,requestPolicyFactories:r}}function Qe(e,t,r,n){return We(e,t,r.parameterPath,r.mapper,n)}function We(e,t,r,n,o){var i,s;"string"==typeof r&&(r=[r]);var a=null===(i=t.options)||void 0===i?void 0:i.serializerOptions;if(Array.isArray(r)){if(r.length>0){if(n.isConstant)s=n.defaultValue;else{var c=Je(t,r);c.propertyFound||(c=Je(e,r));var u=!1;c.propertyFound||(u=n.required||"options"===r[0]&&2===r.length),s=u?n.defaultValue:c.propertyValue}var l=L(r,n);o.serialize(n,s,l,a)}}else for(var p in n.required&&(s={}),r){var d=n.type.modelProperties[p],h=r[p],f=We(e,t,h,d,o),y=L(h,d);o.serialize(d,f,y,a),null!=f&&(s||(s={}),s[p]=f)}return s}function Je(e,t){for(var r={propertyFound:!1},n=0;n<t.length;++n){var o=t[n];if(null==e||!(o in e))break;e=e[o]}return n===t.length&&(r.propertyValue=e,r.propertyFound=!0),r}function Ye(e,t){var r=e.parsedHeaders,o=t&&t.bodyMapper,i=function(t){return Object.defineProperty(t,"_response",{value:e})};if(o){var s=o.type.name;if("Stream"===s)return i((0,n.pi)((0,n.pi)({},r),{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody}));var a="Composite"===s&&o.type.modelProperties||{},c=Object.keys(a).some((function(e){return""===a[e].serializedName}));if("Sequence"===s||c){for(var u=(0,n.pr)(e.parsedBody||[]),l=0,p=Object.keys(a);l<p.length;l++){var h=p[l];a[h].serializedName&&(u[h]=e.parsedBody[h])}if(r)for(var f=0,y=Object.keys(r);f<y.length;f++)u[h=y[f]]=r[h];return i(u),u}if("Composite"===s||"Dictionary"===s)return i((0,n.pi)((0,n.pi)({},r),e.parsedBody))}return o||"HEAD"===e.request.method||d.ty(e.parsedBody)?i((0,n.pi)((0,n.pi)({},r),{body:e.parsedBody})):i((0,n.pi)((0,n.pi)({},r),e.parsedBody))}},4809:(e,t,r)=>{"use strict";r.d(t,{g:()=>n});var n={coreHttpVersion:"1.2.1",HTTP:"http:",HTTPS:"https:",HTTP_PROXY:"HTTP_PROXY",HTTPS_PROXY:"HTTPS_PROXY",NO_PROXY:"NO_PROXY",ALL_PROXY:"ALL_PROXY",HttpConstants:{HttpVerbs:{PUT:"PUT",GET:"GET",DELETE:"DELETE",POST:"POST",MERGE:"MERGE",HEAD:"HEAD",PATCH:"PATCH"},StatusCodes:{TooManyRequests:429}},HeaderConstants:{AUTHORIZATION:"authorization",AUTHORIZATION_SCHEME:"Bearer",RETRY_AFTER:"Retry-After",USER_AGENT:"User-Agent"}}},1035:(e,t,r)=>{"use strict";r.d(t,{c:()=>n,I:()=>o});var n="$",o="_"},7564:(e,t,r)=>{"use strict";var n;r.d(t,{gw:()=>g,Rl:()=>y,_9:()=>T,UG:()=>h,ty:()=>_,TP:()=>f,WQ:()=>m,ko:()=>b});var o=new Uint8Array(16);function i(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)}const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,a=function(e){return"string"==typeof e&&s.test(e)};for(var c=[],u=0;u<256;++u)c.push((u+256).toString(16).substr(1));const l=function(e,t,r){var n=(e=e||{}).random||(e.rng||i)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var o=0;o<16;++o)t[r+o]=n[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!a(r))throw TypeError("Stringified UUID is invalid");return r}(n)};var p=r(1035),d=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i,h="undefined"!=typeof process&&!!process.version&&!!process.versions&&!!process.versions.node;function f(e){return d.test(e)}function y(){return l()}function g(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))}function m(e,t,r,n){var o,i,s;if(Array.isArray(e)||(e=[e]),!r||!n)return(o={})[t]=e,o;var a=((i={})[t]=e,i);return a[p.c]=((s={})[r]=n,s),a}var v=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function T(e){return v.test(e)}function b(e,t,r){return e&&t?e.split(t).join(r||""):e}function _(e){return"object"!=typeof e&&"function"!=typeof e||null===e}},7176:(e,t,r)=>{"use strict";r.d(t,{Y:()=>l});var n,o,i=r(6563),s=function(){function e(){}return e.prototype.context=function(){return{spanId:"",traceId:"",traceFlags:i.TraceFlags.NONE}},e.prototype.end=function(e){},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.isRecording=function(){return!1},e}(),a=function(){function e(){}return e.prototype.startSpan=function(e,t){return new s},e.prototype.getCurrentSpan=function(){return new s},e.prototype.withSpan=function(e,t){return t()},e.prototype.bind=function(e,t){return e},e}(),c=Symbol.for("@azure/core-tracing.tracerCache2");function u(){return n||function(){var e=self,t=e[c],r=!0;if(t)if(3===t.version)n=t;else if(r=!1,t.tracer)throw new Error("Two incompatible versions of @azure/core-tracing have been loaded.\n          This library is 3, existing is "+t.version+".");n||(n={tracer:void 0,version:3}),r&&(e[c]=n)}(),n}function l(){var e=u();return e.tracer?e.tracer:(o||(o=new a),o)}},860:(e,t,r)=>{"use strict";function n(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function i(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e}r.d(t,{YR:()=>C});var s,a=console.debug||console.log,c="undefined"!=typeof process&&process.env&&process.env.DEBUG||void 0,u=[],l=[],p=[];function d(e){var t,r,o,i;s=e,u=[],l=[];var a=/\*/g,c=e.split(",").map((function(e){return e.trim().replace(a,".*?")}));try{for(var d=n(c),f=d.next();!f.done;f=d.next()){var y=f.value;y.startsWith("-")?l.push(new RegExp("^"+y.substr(1)+"$")):u.push(new RegExp("^"+y+"$"))}}catch(e){t={error:e}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(t)throw t.error}}try{for(var g=n(p),m=g.next();!m.done;m=g.next()){var v=m.value;v.enabled=h(v.namespace)}}catch(e){o={error:e}}finally{try{m&&!m.done&&(i=g.return)&&i.call(g)}finally{if(o)throw o.error}}}function h(e){var t,r,o,i;if(e.endsWith("*"))return!0;try{for(var s=n(l),a=s.next();!a.done;a=s.next())if(a.value.test(e))return!1}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}try{for(var c=n(u),p=c.next();!p.done;p=c.next())if(p.value.test(e))return!0}catch(e){o={error:e}}finally{try{p&&!p.done&&(i=c.return)&&i.call(c)}finally{if(o)throw o.error}}return!1}function f(e){var t=Object.assign((function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];t.enabled&&(r.length>0&&(r[0]=e+" "+r[0]),t.log.apply(t,i(r)))}),{enabled:h(e),destroy:y,log:m.log,namespace:e,extend:g});return p.push(t),t}function y(){var e=p.indexOf(this);return e>=0&&(p.splice(e,1),!0)}function g(e){var t=f(this.namespace+":"+e);return t.log=this.log,t}c&&d(c);var m=Object.assign((function(e){return f(e)}),{enable:d,enabled:h,disable:function(){var e=s||"";return d(""),e},log:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a.apply(void 0,i(e))}});const v=m;var T,b=new Set,_="undefined"!=typeof process&&process.env&&process.env.AZURE_LOG_LEVEL||void 0,R=v("azure");R.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];v.log.apply(v,i(e))};var w=["verbose","info","warning","error"];_&&(N(_)?function(e){var t,r;if(e&&!N(e))throw new Error("Unknown log level '"+e+"'. Acceptable values: "+w.join(","));T=e;var o=[];try{for(var i=n(b),s=i.next();!s.done;s=i.next()){var a=s.value;S(a)&&o.push(a.namespace)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}v.enable(o.join(","))}(_):console.error("AZURE_LOG_LEVEL set to unknown log level '"+_+"'; logging is not enabled. Acceptable values: "+w.join(", ")+"."));var O={verbose:400,info:300,warning:200,error:100};function C(e){var t=R.extend(e);return E(R,t),{error:P(t,"error"),warning:P(t,"warning"),info:P(t,"info"),verbose:P(t,"verbose")}}function E(e,t){t.log=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e.log.apply(e,i(t))}}function P(e,t){var r=Object.assign(e.extend(t),{level:t});if(E(e,r),S(r)){var n=v.disable();v.enable(n+","+r.namespace)}return b.add(r),r}function S(e){return!!(T&&O[e.level]<=O[T])}function N(e){return w.includes(e)}},2121:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextAPI=void 0;var n=r(183),o=r(725),i=new n.NoopContextManager,s=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return o._global[o.GLOBAL_CONTEXT_MANAGER_API_KEY]?this._getContextManager():(o._global[o.GLOBAL_CONTEXT_MANAGER_API_KEY]=o.makeGetter(o.API_BACKWARDS_COMPATIBILITY_VERSION,e,i),e)},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t){return this._getContextManager().with(e,t)},e.prototype.bind=function(e,t){return void 0===t&&(t=this.active()),this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){var e,t;return null!==(t=null===(e=o._global[o.GLOBAL_CONTEXT_MANAGER_API_KEY])||void 0===e?void 0:e.call(o._global,o.API_BACKWARDS_COMPATIBILITY_VERSION))&&void 0!==t?t:i},e.prototype.disable=function(){this._getContextManager().disable(),delete o._global[o.GLOBAL_CONTEXT_MANAGER_API_KEY]},e}();t.ContextAPI=s},725:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.API_BACKWARDS_COMPATIBILITY_VERSION=t.makeGetter=t._global=t.GLOBAL_TRACE_API_KEY=t.GLOBAL_PROPAGATION_API_KEY=t.GLOBAL_METRICS_API_KEY=t.GLOBAL_CONTEXT_MANAGER_API_KEY=void 0;var n=r(7994);t.GLOBAL_CONTEXT_MANAGER_API_KEY=Symbol.for("io.opentelemetry.js.api.context"),t.GLOBAL_METRICS_API_KEY=Symbol.for("io.opentelemetry.js.api.metrics"),t.GLOBAL_PROPAGATION_API_KEY=Symbol.for("io.opentelemetry.js.api.propagation"),t.GLOBAL_TRACE_API_KEY=Symbol.for("io.opentelemetry.js.api.trace"),t._global=n._globalThis,t.makeGetter=function(e,t,r){return function(n){return n===e?t:r}},t.API_BACKWARDS_COMPATIBILITY_VERSION=0},2496:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsAPI=void 0;var n=r(3111),o=r(725),i=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalMeterProvider=function(e){return o._global[o.GLOBAL_METRICS_API_KEY]?this.getMeterProvider():(o._global[o.GLOBAL_METRICS_API_KEY]=o.makeGetter(o.API_BACKWARDS_COMPATIBILITY_VERSION,e,n.NOOP_METER_PROVIDER),e)},e.prototype.getMeterProvider=function(){var e,t;return null!==(t=null===(e=o._global[o.GLOBAL_METRICS_API_KEY])||void 0===e?void 0:e.call(o._global,o.API_BACKWARDS_COMPATIBILITY_VERSION))&&void 0!==t?t:n.NOOP_METER_PROVIDER},e.prototype.getMeter=function(e,t){return this.getMeterProvider().getMeter(e,t)},e.prototype.disable=function(){delete o._global[o.GLOBAL_METRICS_API_KEY]},e}();t.MetricsAPI=i},655:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PropagationAPI=void 0;var n=r(9869),o=r(9782),i=r(7196),s=r(2121),a=r(725),c=s.ContextAPI.getInstance(),u=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(e){return a._global[a.GLOBAL_PROPAGATION_API_KEY]?this._getGlobalPropagator():(a._global[a.GLOBAL_PROPAGATION_API_KEY]=a.makeGetter(a.API_BACKWARDS_COMPATIBILITY_VERSION,e,o.NOOP_HTTP_TEXT_PROPAGATOR),e)},e.prototype.inject=function(e,t,r){return void 0===t&&(t=i.defaultSetter),void 0===r&&(r=c.active()),this._getGlobalPropagator().inject(r,e,t)},e.prototype.extract=function(e,t,r){return void 0===t&&(t=n.defaultGetter),void 0===r&&(r=c.active()),this._getGlobalPropagator().extract(r,e,t)},e.prototype.disable=function(){delete a._global[a.GLOBAL_PROPAGATION_API_KEY]},e.prototype._getGlobalPropagator=function(){var e,t;return null!==(t=null===(e=a._global[a.GLOBAL_PROPAGATION_API_KEY])||void 0===e?void 0:e.call(a._global,a.API_BACKWARDS_COMPATIBILITY_VERSION))&&void 0!==t?t:o.NOOP_HTTP_TEXT_PROPAGATOR},e}();t.PropagationAPI=u},7428:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TraceAPI=void 0;var n=r(2830),o=r(725),i=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){return o._global[o.GLOBAL_TRACE_API_KEY]||(o._global[o.GLOBAL_TRACE_API_KEY]=o.makeGetter(o.API_BACKWARDS_COMPATIBILITY_VERSION,e,n.NOOP_TRACER_PROVIDER)),this.getTracerProvider()},e.prototype.getTracerProvider=function(){var e,t;return null!==(t=null===(e=o._global[o.GLOBAL_TRACE_API_KEY])||void 0===e?void 0:e.call(o._global,o.API_BACKWARDS_COMPATIBILITY_VERSION))&&void 0!==t?t:n.NOOP_TRACER_PROVIDER},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){delete o._global[o.GLOBAL_TRACE_API_KEY]},e}();t.TraceAPI=i},5540:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3212:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4144:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9782:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_HTTP_TEXT_PROPAGATOR=t.NoopHttpTextPropagator=void 0;var r=function(){function e(){}return e.prototype.inject=function(e,t,r){},e.prototype.extract=function(e,t,r){return e},e}();t.NoopHttpTextPropagator=r,t.NOOP_HTTP_TEXT_PROPAGATOR=new r},9869:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultGetter=void 0,t.defaultGetter=function(e,t){return e[t]}},7196:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetter=void 0,t.defaultSetter=function(e,t,r){e[t]=r}},5119:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2349:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EntryTtl=void 0,(r=t.EntryTtl||(t.EntryTtl={}))[r.NO_PROPAGATION=0]="NO_PROPAGATION",r[r.UNLIMITED_PROPAGATION=-1]="UNLIMITED_PROPAGATION"},6563:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.propagation=t.metrics=t.trace=t.context=void 0,o(r(5540),t),o(r(3212),t),o(r(9869),t),o(r(4144),t),o(r(9782),t),o(r(7196),t),o(r(5119),t),o(r(2349),t),o(r(3823),t),o(r(5320),t),o(r(520),t),o(r(7315),t),o(r(8137),t),o(r(5136),t),o(r(3111),t),o(r(1654),t),o(r(1222),t),o(r(642),t),o(r(3609),t),o(r(7386),t),o(r(2442),t),o(r(7401),t),o(r(776),t),o(r(8777),t),o(r(2830),t),o(r(375),t),o(r(5698),t),o(r(7628),t),o(r(3519),t),o(r(6774),t),o(r(633),t),o(r(9393),t),o(r(5510),t),o(r(1066),t),o(r(4615),t),o(r(2679),t),o(r(1221),t);var i=r(183);Object.defineProperty(t,"Context",{enumerable:!0,get:function(){return i.Context}});var s=r(2121);t.context=s.ContextAPI.getInstance();var a=r(7428);t.trace=a.TraceAPI.getInstance();var c=r(2496);t.metrics=c.MetricsAPI.getInstance();var u=r(655);t.propagation=u.PropagationAPI.getInstance(),t.default={trace:t.trace,metrics:t.metrics,context:t.context,propagation:t.propagation}},3823:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5320:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},520:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7315:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8137:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ValueType=void 0,(r=t.ValueType||(t.ValueType={}))[r.INT=0]="INT",r[r.DOUBLE=1]="DOUBLE"},5136:function(e,t){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_BATCH_OBSERVER_METRIC=t.NOOP_SUM_OBSERVER_METRIC=t.NOOP_UP_DOWN_SUM_OBSERVER_METRIC=t.NOOP_VALUE_OBSERVER_METRIC=t.NOOP_BOUND_BASE_OBSERVER=t.NOOP_VALUE_RECORDER_METRIC=t.NOOP_BOUND_VALUE_RECORDER=t.NOOP_COUNTER_METRIC=t.NOOP_BOUND_COUNTER=t.NOOP_METER=t.NoopBoundBaseObserver=t.NoopBoundValueRecorder=t.NoopBoundCounter=t.NoopBatchObserverMetric=t.NoopBaseObserverMetric=t.NoopValueRecorderMetric=t.NoopCounterMetric=t.NoopMetric=t.NoopMeter=void 0;var o=function(){function e(){}return e.prototype.createValueRecorder=function(e,r){return t.NOOP_VALUE_RECORDER_METRIC},e.prototype.createCounter=function(e,r){return t.NOOP_COUNTER_METRIC},e.prototype.createUpDownCounter=function(e,r){return t.NOOP_COUNTER_METRIC},e.prototype.createValueObserver=function(e,r,n){return t.NOOP_VALUE_OBSERVER_METRIC},e.prototype.createBatchObserver=function(e,r){return t.NOOP_BATCH_OBSERVER_METRIC},e}();t.NoopMeter=o;var i=function(){function e(e){this._instrument=e}return e.prototype.bind=function(e){return this._instrument},e.prototype.unbind=function(e){},e.prototype.clear=function(){},e}();t.NoopMetric=i;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.add=function(e,t){this.bind(t).add(e)},t}(i);t.NoopCounterMetric=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.record=function(e,t,r,n){void 0===r?this.bind(t).record(e):void 0===n?this.bind(t).record(e,r):this.bind(t).record(e,r,n)},t}(i);t.NoopValueRecorderMetric=a;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.observation=function(){return{observer:this,value:0}},t}(i);t.NoopBaseObserverMetric=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(i);t.NoopBatchObserverMetric=u;var l=function(){function e(){}return e.prototype.add=function(e){},e}();t.NoopBoundCounter=l;var p=function(){function e(){}return e.prototype.record=function(e,t,r){},e}();t.NoopBoundValueRecorder=p;var d=function(){function e(){}return e.prototype.update=function(e){},e}();t.NoopBoundBaseObserver=d,t.NOOP_METER=new o,t.NOOP_BOUND_COUNTER=new l,t.NOOP_COUNTER_METRIC=new s(t.NOOP_BOUND_COUNTER),t.NOOP_BOUND_VALUE_RECORDER=new p,t.NOOP_VALUE_RECORDER_METRIC=new a(t.NOOP_BOUND_VALUE_RECORDER),t.NOOP_BOUND_BASE_OBSERVER=new d,t.NOOP_VALUE_OBSERVER_METRIC=new c(t.NOOP_BOUND_BASE_OBSERVER),t.NOOP_UP_DOWN_SUM_OBSERVER_METRIC=new c(t.NOOP_BOUND_BASE_OBSERVER),t.NOOP_SUM_OBSERVER_METRIC=new c(t.NOOP_BOUND_BASE_OBSERVER),t.NOOP_BATCH_OBSERVER_METRIC=new u},3111:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_METER_PROVIDER=t.NoopMeterProvider=void 0;var n=r(5136),o=function(){function e(){}return e.prototype.getMeter=function(e,t){return n.NOOP_METER},e}();t.NoopMeterProvider=o,t.NOOP_METER_PROVIDER=new o},1654:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1222:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2540:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._globalThis=void 0,t._globalThis="object"==typeof globalThis?globalThis:window},7994:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(2540),t)},3609:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},776:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_SPAN=t.NoopSpan=t.INVALID_SPAN_ID=t.INVALID_TRACE_ID=void 0;var n=r(1066);t.INVALID_TRACE_ID="0",t.INVALID_SPAN_ID="0";var o={traceId:t.INVALID_TRACE_ID,spanId:t.INVALID_SPAN_ID,traceFlags:n.TraceFlags.NONE},i=function(){function e(e){void 0===e&&(e=o),this._spanContext=e}return e.prototype.context=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e}();t.NoopSpan=i,t.NOOP_SPAN=new i},8777:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_TRACER=t.NoopTracer=void 0;var n=r(776),o=function(){function e(){}return e.prototype.getCurrentSpan=function(){return n.NOOP_SPAN},e.prototype.startSpan=function(e,t){return n.NOOP_SPAN},e.prototype.withSpan=function(e,t){return t()},e.prototype.bind=function(e,t){return e},e}();t.NoopTracer=o,t.NOOP_TRACER=new o},2830:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_TRACER_PROVIDER=t.NoopTracerProvider=void 0;var n=r(8777),o=function(){function e(){}return e.prototype.getTracer=function(e,t){return n.NOOP_TRACER},e}();t.NoopTracerProvider=o,t.NOOP_TRACER_PROVIDER=new o},375:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5698:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.SamplingDecision=void 0,(r=t.SamplingDecision||(t.SamplingDecision={}))[r.NOT_RECORD=0]="NOT_RECORD",r[r.RECORD=1]="RECORD",r[r.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"},633:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5510:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},642:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7386:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7401:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2442:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6774:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7628:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3519:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.SpanKind=void 0,(r=t.SpanKind||(t.SpanKind={}))[r.INTERNAL=0]="INTERNAL",r[r.SERVER=1]="SERVER",r[r.CLIENT=2]="CLIENT",r[r.PRODUCER=3]="PRODUCER",r[r.CONSUMER=4]="CONSUMER"},9393:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.CanonicalCode=void 0,(r=t.CanonicalCode||(t.CanonicalCode={}))[r.OK=0]="OK",r[r.CANCELLED=1]="CANCELLED",r[r.UNKNOWN=2]="UNKNOWN",r[r.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",r[r.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",r[r.NOT_FOUND=5]="NOT_FOUND",r[r.ALREADY_EXISTS=6]="ALREADY_EXISTS",r[r.PERMISSION_DENIED=7]="PERMISSION_DENIED",r[r.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",r[r.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",r[r.ABORTED=10]="ABORTED",r[r.OUT_OF_RANGE=11]="OUT_OF_RANGE",r[r.UNIMPLEMENTED=12]="UNIMPLEMENTED",r[r.INTERNAL=13]="INTERNAL",r[r.UNAVAILABLE=14]="UNAVAILABLE",r[r.DATA_LOSS=15]="DATA_LOSS",r[r.UNAUTHENTICATED=16]="UNAUTHENTICATED"},1066:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TraceFlags=void 0,(r=t.TraceFlags||(t.TraceFlags={}))[r.NONE=0]="NONE",r[r.SAMPLED=1]="SAMPLED"},4615:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1221:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2679:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5031:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoopContextManager=void 0;var n=r(1029),o=function(){function e(){}return e.prototype.active=function(){return n.Context.ROOT_CONTEXT},e.prototype.with=function(e,t){return t()},e.prototype.bind=function(e,t){return e},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}();t.NoopContextManager=o},1029:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;var r=function(){function e(e){this._currentContext=e?new Map(e):new Map}return e.createKey=function(e){return Symbol(e)},e.prototype.getValue=function(e){return this._currentContext.get(e)},e.prototype.setValue=function(t,r){var n=new e(this._currentContext);return n._currentContext.set(t,r),n},e.prototype.deleteValue=function(t){var r=new e(this._currentContext);return r._currentContext.delete(t),r},e.ROOT_CONTEXT=new e,e.TODO=e.ROOT_CONTEXT,e}();t.Context=r},183:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(190),t),o(r(1029),t),o(r(5031),t)},190:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7187:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(r,n){function o(){void 0!==i&&e.removeListener("error",i),r([].slice.call(arguments))}var i;"error"!==t&&(i=function(r){e.removeListener(t,o),n(r)},e.once("error",i)),e.once(t,o)}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var o,i,s,u;if(a(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]),void 0===s)s=i[t]=r,++e._eventsCount;else if("function"==typeof s?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(o=c(e))>0&&s.length>o&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,u=l,console&&console.warn&&console.warn(u)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=l.bind(n);return o.listener=r,n.wrapFn=o,o}function d(e,t,r){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"==typeof o?r?[o.listener||o]:[o]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(o):f(o,o.length)}function h(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function f(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var o="error"===e,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var u=c.length,l=f(c,u);for(r=0;r<u;++r)n(l[r],this,t)}return!0},i.prototype.addListener=function(e,t){return u(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return u(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,p(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,p(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,n,o,i,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(o=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){s=r[i].listener,o=i;break}if(o<0)return this;0===o?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,o),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return d(this,e,!0)},i.prototype.rawListeners=function(e){return d(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},i.prototype.listenerCount=h,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},1230:(e,t,r)=>{"use strict";r.d(t,{ZT:()=>o,pi:()=>i,_T:()=>s,mG:()=>a,Jh:()=>c,pr:()=>u,qq:()=>l,FC:()=>p,V2:()=>d,KL:()=>h});var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function s(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function a(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function c(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function u(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}function l(e){return this instanceof l?(this.v=e,this):new l(e)}function p(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=o[e](t)).value instanceof l?Promise.resolve(r.value.v).then(c,u):p(i[0][2],r)}catch(e){p(i[0][3],e)}var r}function c(e){a("next",e)}function u(e){a("throw",e)}function p(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function d(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:l(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function h(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,o,(t=e[r](t)).done,t.value)}))}}}Object.create,Object.create},4933:(e,t,r)=>{"use strict";r.r(t);var n=r(2780);window.hasOwnProperty("communications")?window.communications.chat=n:window.communications={chat:n}}},__webpack_module_cache__={};function __webpack_require__(e){if(__webpack_module_cache__[e])return __webpack_module_cache__[e].exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(t.exports,t,t.exports,__webpack_require__),t.exports}return __webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__(4933)})();