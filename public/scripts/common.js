var common;common=(()=>{var t={168:t=>{function e(t){this.message=t}e.prototype=new Error,e.prototype.name="InvalidCharacterError",t.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(t){var r=String(t).replace(/=+$/,"");if(r.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,i,o=0,s=0,u="";i=r.charAt(s++);~i&&(n=o%4?64*n+i:i,o++%4)?u+=String.fromCharCode(255&n>>(-2*o&6)):0)i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(i);return u}},491:(t,e,r)=>{var n=r(168);t.exports=function(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(t){return decodeURIComponent(n(t).replace(/(.)/g,(function(t,e){var r=e.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(e)}catch(t){return n(e)}}},489:(t,e,r)=>{"use strict";var n=r(491);function i(t){this.message=t}i.prototype=new Error,i.prototype.name="InvalidTokenError",t.exports=function(t,e){if("string"!=typeof t)throw new i("Invalid token specified");var r=!0===(e=e||{}).header?0:1;try{return JSON.parse(n(t.split(".")[r]))}catch(t){throw new i("Invalid token specified: "+t.message)}},t.exports.InvalidTokenError=i},39:(t,e,r)=>{"use strict";r.r(e);var n={};function i(t,e,r,n){return new(r||(r=Promise))((function(i,o){function s(t){try{a(n.next(t))}catch(t){o(t)}}function u(t){try{a(n.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,u)}a((n=n.apply(t,e||[])).next())}))}r.r(n),r.d(n,{AzureCommunicationUserCredential:()=>p,createCommunicationAccessKeyCredentialPolicy:()=>C,getIdentifierKind:()=>F,isCallingApplication:()=>M,isCommunicationUser:()=>N,isKeyCredential:()=>Q,isPhoneNumber:()=>q,isUnknownIdentifier:()=>L,parseClientArguments:()=>j}),Object.create,Object.create;var o=r(489),s=r.n(o);const u=t=>{const{exp:e}=s()(t);return{token:t,expiresOnTimestamp:1e3*e}};class a{constructor(t){this.token=t}getToken(){return i(this,void 0,void 0,(function*(){return this.token}))}dispose(){}}const c={token:"",expiresOnTimestamp:-10};var h;class d{constructor(t){this.refreshingIntervalInMs=6e5,this.activeTokenFetching=null,this.activeTokenUpdating=null,this.disposed=!1;const{tokenRefresher:e,initialToken:r,refreshProactively:n}=t;this.refresh=e,this.currentToken=r?u(r):c,this.refreshProactively=null!=n&&n,this.refreshProactively&&this.scheduleRefresh()}getToken(t){return i(this,void 0,void 0,(function*(){if(!this.isCurrentTokenExpiringSoon)return this.currentToken;const e=this.updateTokenAndReschedule(t);return this.isCurrentTokenValid||(yield e),this.currentToken}))}dispose(){this.disposed=!0,this.activeTokenFetching=null,this.activeTokenUpdating=null,this.currentToken=c,this.activeTimeout&&clearTimeout(this.activeTimeout)}updateTokenAndReschedule(t){return i(this,void 0,void 0,(function*(){if(this.activeTokenUpdating)return this.activeTokenUpdating;this.activeTokenUpdating=this.refreshTokenAndReschedule(t);try{yield this.activeTokenUpdating}finally{this.activeTokenUpdating=null}}))}refreshTokenAndReschedule(t){return i(this,void 0,void 0,(function*(){this.currentToken=yield this.refreshToken(t),this.refreshProactively&&this.scheduleRefresh()}))}refreshToken(t){return i(this,void 0,void 0,(function*(){try{return this.activeTokenFetching||(this.activeTokenFetching=this.refresh(t)),u(yield this.activeTokenFetching)}finally{this.activeTokenFetching=null}}))}scheduleRefresh(){if(this.disposed)return;this.activeTimeout&&clearTimeout(this.activeTimeout);const t=this.currentToken.expiresOnTimestamp-Date.now()-this.refreshingIntervalInMs;this.activeTimeout=setTimeout((()=>this.updateTokenAndReschedule()),t)}get isCurrentTokenValid(){return this.currentToken&&Date.now()<this.currentToken.expiresOnTimestamp}get isCurrentTokenExpiringSoon(){return!this.currentToken||Date.now()>=this.currentToken.expiresOnTimestamp-this.refreshingIntervalInMs}}class p{constructor(t){this.disposed=!1,this.userCredential="string"==typeof t?new a(u(t)):new d(t)}getToken(t){return i(this,void 0,void 0,(function*(){this.throwIfDisposed();const e=yield this.userCredential.getToken(t);return this.throwIfDisposed(),e}))}dispose(){this.disposed=!0,this.userCredential.dispose()}throwIfDisposed(){if(this.disposed)throw new Error("User credential is disposed")}}!function(t){t[t.OFF=0]="OFF",t[t.ERROR=1]="ERROR",t[t.WARNING=2]="WARNING",t[t.INFO=3]="INFO"}(h||(h={}));var f=function(){function t(t,e){this._nextPolicy=t,this._options=e}return t.prototype.shouldLog=function(t){return this._options.shouldLog(t)},t.prototype.log=function(t,e){this._options.log(t,e)},t}(),l=(function(){function t(t){this._logger=t}t.prototype.shouldLog=function(t){return!!this._logger&&t!==h.OFF&&t<=this._logger.minimumLogLevel},t.prototype.log=function(t,e){this._logger&&this.shouldLog(t)&&this._logger.log(t,e)}}(),"undefined"!=typeof process&&!!process.version&&!!process.versions&&!!process.versions.node);function g(t,e,r){return t&&e?t.split(e).join(r||""):t}var y=function(){function t(){this._rawQuery={}}return t.prototype.any=function(){return Object.keys(this._rawQuery).length>0},t.prototype.keys=function(){return Object.keys(this._rawQuery)},t.prototype.set=function(t,e){if(t)if(null!=e){var r=Array.isArray(e)?e:e.toString();this._rawQuery[t]=r}else delete this._rawQuery[t]},t.prototype.get=function(t){return t?this._rawQuery[t]:void 0},t.prototype.toString=function(){var t="";for(var e in this._rawQuery){t&&(t+="&");var r=this._rawQuery[e];if(Array.isArray(r)){for(var n=[],i=0,o=r;i<o.length;i++){var s=o[i];n.push(e+"="+s)}t+=n.join("&")}else t+=e+"="+r}return t},t.parse=function(e){var r=new t;if(e){e.startsWith("?")&&(e=e.substring(1));for(var n="ParameterName",i="",o="",s=0;s<e.length;++s){var u=e[s];switch(n){case"ParameterName":switch(u){case"=":n="ParameterValue";break;case"&":i="",o="";break;default:i+=u}break;case"ParameterValue":switch(u){case"&":r.set(i,o),i="",o="",n="ParameterName";break;default:o+=u}break;default:throw new Error("Unrecognized URLQuery parse state: "+n)}}"ParameterValue"===n&&r.set(i,o)}return r},t}(),v=function(){function t(){}return t.prototype.setScheme=function(t){t?this.set(t,"SCHEME"):this._scheme=void 0},t.prototype.getScheme=function(){return this._scheme},t.prototype.setHost=function(t){t?this.set(t,"SCHEME_OR_HOST"):this._host=void 0},t.prototype.getHost=function(){return this._host},t.prototype.setPort=function(t){null==t||""===t?this._port=void 0:this.set(t.toString(),"PORT")},t.prototype.getPort=function(){return this._port},t.prototype.setPath=function(t){if(t){var e=t.indexOf("://");if(-1!==e){var r=t.lastIndexOf("/",e);this.set(-1===r?t:t.substr(r+1),"SCHEME")}else this.set(t,"PATH")}else this._path=void 0},t.prototype.appendPath=function(t){if(t){var e=this.getPath();e&&(e.endsWith("/")||(e+="/"),t.startsWith("/")&&(t=t.substring(1)),t=e+t),this.set(t,"PATH")}},t.prototype.getPath=function(){return this._path},t.prototype.setQuery=function(t){this._query=t?y.parse(t):void 0},t.prototype.setQueryParameter=function(t,e){t&&(this._query||(this._query=new y),this._query.set(t,e))},t.prototype.getQueryParameterValue=function(t){return this._query?this._query.get(t):void 0},t.prototype.getQuery=function(){return this._query?this._query.toString():void 0},t.prototype.set=function(t,e){for(var r=new m(t,e);r.next();){var n=r.current(),i=void 0;if(n)switch(n.type){case"SCHEME":this._scheme=n.text||void 0;break;case"HOST":this._host=n.text||void 0;break;case"PORT":this._port=n.text||void 0;break;case"PATH":i=n.text||void 0,this._path&&"/"!==this._path&&"/"===i||(this._path=i);break;case"QUERY":this._query=y.parse(n.text);break;default:throw new Error("Unrecognized URLTokenType: "+n.type)}}},t.prototype.toString=function(){var t="";return this._scheme&&(t+=this._scheme+"://"),this._host&&(t+=this._host),this._port&&(t+=":"+this._port),this._path&&(this._path.startsWith("/")||(t+="/"),t+=this._path),this._query&&this._query.any()&&(t+="?"+this._query.toString()),t},t.prototype.replaceAll=function(t,e){t&&(this.setScheme(g(this.getScheme(),t,e)),this.setHost(g(this.getHost(),t,e)),this.setPort(g(this.getPort(),t,e)),this.setPath(g(this.getPath(),t,e)),this.setQuery(g(this.getQuery(),t,e)))},t.parse=function(e){var r=new t;return r.set(e,"SCHEME_OR_HOST"),r},t}(),_=function(){function t(t,e){this.text=t,this.type=e}return t.scheme=function(e){return new t(e,"SCHEME")},t.host=function(e){return new t(e,"HOST")},t.port=function(e){return new t(e,"PORT")},t.path=function(e){return new t(e,"PATH")},t.query=function(e){return new t(e,"QUERY")},t}(),m=function(){function t(t,e){this._text=t,this._textLength=t?t.length:0,this._currentState=null!=e?e:"SCHEME_OR_HOST",this._currentIndex=0}return t.prototype.current=function(){return this._currentToken},t.prototype.next=function(){if(k(this))switch(this._currentState){case"SCHEME":e=function(t){return S(t,(function(t){return function(t){var e=t.charCodeAt(0);return 48<=e&&e<=57||65<=e&&e<=90||97<=e&&e<=122}(t)}))}(t=this),t._currentToken=_.scheme(e),k(t)?t._currentState="HOST":t._currentState="DONE";break;case"SCHEME_OR_HOST":!function(t){var e=O(t,":","/","?");k(t)?":"===T(t)?"://"===b(t,3)?(t._currentToken=_.scheme(e),t._currentState="HOST"):(t._currentToken=_.host(e),t._currentState="PORT"):(t._currentToken=_.host(e),"/"===T(t)?t._currentState="PATH":t._currentState="QUERY"):(t._currentToken=_.host(e),t._currentState="DONE")}(this);break;case"HOST":!function(t){"://"===b(t,3)&&w(t,3);var e=O(t,":","/","?");t._currentToken=_.host(e),k(t)?":"===T(t)?t._currentState="PORT":"/"===T(t)?t._currentState="PATH":t._currentState="QUERY":t._currentState="DONE"}(this);break;case"PORT":!function(t){":"===T(t)&&w(t);var e=O(t,"/","?");t._currentToken=_.port(e),k(t)?"/"===T(t)?t._currentState="PATH":t._currentState="QUERY":t._currentState="DONE"}(this);break;case"PATH":!function(t){var e=O(t,"?");t._currentToken=_.path(e),k(t)?t._currentState="QUERY":t._currentState="DONE"}(this);break;case"QUERY":!function(t){"?"===T(t)&&w(t);var e=function(t){var e="";return t._currentIndex<t._textLength&&(e=t._text.substring(t._currentIndex),t._currentIndex=t._textLength),e}(t);t._currentToken=_.query(e),t._currentState="DONE"}(this);break;default:throw new Error("Unrecognized URLTokenizerState: "+this._currentState)}else this._currentToken=void 0;var t,e;return!!this._currentToken},t}();function k(t){return t._currentIndex<t._textLength}function T(t){return t._text[t._currentIndex]}function w(t,e){k(t)&&(e||(e=1),t._currentIndex+=e)}function b(t,e){var r=t._currentIndex+e;return t._textLength<r&&(r=t._textLength),t._text.substring(t._currentIndex,r)}function S(t,e){for(var r="";k(t);){var n=T(t);if(!e(n))break;r+=n,w(t)}return r}function O(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return S(t,(function(t){return-1===e.indexOf(t)}))}const x=t=>(new TextEncoder).encode(t);function P(t){if("function"!=typeof btoa)throw new Error("Your browser environment is missing the global `btoa` function");const e=new Uint8Array(t);let r="";for(const t of e)r+=String.fromCharCode(t);return btoa(r)}const E=globalThis,R=()=>{if(!E)throw new Error("Could not find global");if(!E.crypto||!E.crypto.subtle)throw new Error("Browser does not support cryptography functions");return E.crypto.subtle},C=t=>({create:(e,r)=>new H(t,e,r)});class H extends f{constructor(t,e,r){super(e,r),this.accessKey=t}signRequest(t){return i(this,void 0,void 0,(function*(){const e=t.method.toUpperCase(),r=(new Date).toUTCString(),n=yield(o=t.body||"",i(void 0,void 0,void 0,(function*(){const t=x(o);return P(yield R().digest("SHA-256",t))})));var o;const s=l?"date":"x-ms-date",u=`${s};host;x-ms-content-sha256`,a=v.parse(t.url),c=a.getQuery(),h=c?`${a.getPath()}?${c}`:a.getPath(),d=a.getPort(),p=d?`${a.getHost()}:${d}`:a.getHost(),f=`${e}\n${h}\n${r};${p};${n}`,g=yield((t,e)=>i(void 0,void 0,void 0,(function*(){const r={name:"HMAC",hash:{name:"SHA-256"}},n=x(e),i=function(t){if("function"!=typeof atob)throw new Error("Your browser environment is missing the global `atob` function");const e=atob(t),r=new Uint8Array(e.length);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r}(t),o=R(),s=yield o.importKey("raw",i,r,!1,["sign"]);return P(yield o.sign(r,s,n))})))(this.accessKey.key,f);return l&&t.headers.set("Host",p||""),t.headers.set(s,r),t.headers.set("x-ms-content-sha256",n),t.headers.set("Authorization",`HMAC-SHA256 SignedHeaders=${u}&Signature=${g}`),t}))}sendRequest(t){return i(this,void 0,void 0,(function*(){if(!t)throw new Error("webResource cannot be null or undefined");return this._nextPolicy.sendRequest(yield this.signRequest(t))}))}}var A=function(){function t(t){if(!t)throw new Error("key must be a non-empty string");this._key=t}return Object.defineProperty(t.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),t.prototype.update=function(t){this._key=t},t}();const I=/endpoint=(.*);accesskey=(.*)/i,U=t=>{if(!(t=>{var e;const r=v.parse(t);return!!(null===(e=r.getScheme())||void 0===e?void 0:e.match(/^http[s]?/))&&void 0!==r.getHost()&&""!==r.getHost()&&(void 0===r.getPath()||""===r.getPath()||"/"===r.getPath())})(t))throw new Error(`Invalid endpoint url ${t}`)},Q=t=>t&&"string"==typeof t.key&&void 0===t.getToken,j=(t,e)=>{if(Q(e))return U(t),{url:t,credential:e};{const{endpoint:e,credential:r}=(t=>{const e=(t=>{const e=t.match(I);if((null==e?void 0:e[1])&&e[2])return{endpoint:e[1],credential:new A(e[2])}})(t);if(e)return e;throw new Error(`Invalid connection string ${t}`)})(t);return U(e),{url:e,credential:r}}},N=t=>"string"==typeof t.communicationUserId,q=t=>"string"==typeof t.phoneNumber,M=t=>"string"==typeof t.callingApplicationId,L=t=>"string"==typeof t.id,F=t=>N(t)?Object.assign(Object.assign({},t),{kind:"CommunicationUser"}):q(t)?Object.assign(Object.assign({},t),{kind:"PhoneNumber"}):M(t)?Object.assign(Object.assign({},t),{kind:"CallingApplication"}):Object.assign(Object.assign({},t),{kind:"Unknown"});window.hasOwnProperty("communications")?window.communications.common=n:window.communications={common:n}}},e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}return r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(39)})();